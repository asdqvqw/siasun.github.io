import{_ as j,aV as m,aK as z,o as E,c as Z,a as i,m as h,b as f,f as D,bl as x,cw as F,co as R,E as Y,l as q,bc as A,cy as H,cB as J,at as K,F as X,aY as G,bH as P,by as Q,e as W,p as ee,q as te}from"./index-e9d9a390.js";import{E as ae}from"./el-dialog-e6dcfdec.js";/* empty css                    */import{g as oe,i as ne}from"./index-c13506ae.js";import{E as le}from"./index-5caadbca.js";import"./isEqual-a6971c52.js";import"./8Array-aa2669e5.js";const p=y=>(ee("data-v-af533c75"),y=y(),te(),y),se={class:"page-container main-view"},ie={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},ce=p(()=>i("h2",{style:{"margin-top":"1%","margin-left":"1%"}},"分析",-1)),de=p(()=>i("div",{class:"hengxian"},null,-1)),ue={class:"box"},re={class:"box2"},me=p(()=>i("br",null,null,-1)),pe=p(()=>i("br",null,null,-1)),he=p(()=>i("br",null,null,-1)),fe={class:"box"},ve=p(()=>i("br",null,null,-1)),_e=p(()=>i("div",{class:"box2"},[i("div",{id:"chart-container"})],-1)),ge={__name:"index",setup(y){let v=m(""),d=null;const V=m(0),k=m(100);let _=m([]),u=m([]);const g=m(!1),L=()=>{g.value=!0},S=()=>{const c=oe(document.getElementById("chart-container")),o=Math.max(0,Math.min(V.value,100)),l=Math.max(0,Math.min(k.value,100)),s={dataZoom:[{show:!1,type:"slider",start:o,end:l}]};c.setOption(s)},b=m(!1),N=()=>{b.value=!b.value},O=()=>{d&&d.dispose();const c=document.getElementById("chart-container");d=ne(c);let o;o=_.value;const l=o.map(t=>t.logDateTime),s=[];for(let t=0;t<o.length;t++){const e=o[t].StatisticsData.map(n=>n.value);for(let n=0;n<e.length;n++)s[n]||(s[n]=[]),s[n].push(e[n])}const a={xAxis:{type:"category",data:l},yAxis:{type:"value"},series:u.value.filter(t=>t.checked).map(t=>{const e=u.value.findIndex(n=>n.name===t.name);return{type:"line",name:t.name,data:s[e]}}),legend:{show:!1},tooltip:{trigger:"axis",formatter:t=>{let e=`时间: ${t[0].name}<br/>`;for(let n=0;n<t.length;n++){const{seriesName:r,value:I}=t[n];e+=`${r}: ${I}<br/>`}return e}},dataZoom:[{show:!1,type:"slider"}]};d.on("dataZoom",({start:t,end:e})=>{const n=Math.round(t*(l.length-1)),r=Math.round(e*(l.length-1)),I=l.slice(n,r+1),$=s.map(M=>M.slice(n,r+1));d.setOption({xAxis:{data:I},series:s.map((M,T)=>({data:$[T]}))})}),d.setOption(a),d.setOption({toolbox:{show:!0,feature:{saveAsImage:{name:"chartInstance",title:"保存图表",pixelRatio:2}}}})},U=()=>{let c;c=_.value;const o=c.map(a=>a.logDateTime),l=[];for(let a=0;a<c.length;a++){const t=c[a].StatisticsData.map(e=>e.value);for(let e=0;e<t.length;e++)l[e]||(l[e]=[]),l[e].push(t[e])}const s={xAxis:{type:"category",data:o},yAxis:{type:"value"},series:u.value.filter(a=>a.checked).map(a=>{const t=u.value.findIndex(e=>e.name===a.name);return{type:"line",name:a.name,data:l[t],smooth:!0}}),legend:{show:!0},tooltip:{trigger:"axis",formatter:a=>{let t=`时间: ${a[0].name}<br/>`;for(let e=0;e<a.length;e++){const{seriesName:n,value:r}=a[e];t+=`${n}: ${r}<br/>`}return t}},dataZoom:[{show:!1,type:"slider"}]};d.setOption(s)};let B=0;const w=m(null),C=()=>{F({method:"post",url:"/api/data/analysis",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(o=>{w.value=o.data;const s={logDateTime:new Date().toLocaleString(),StatisticsData:w.value};if(_.value.length===0)_.value.push(s),u.value=w.value.map(a=>({name:a.name,checked:!1}));else{const a=u.value;_.value.push(s),u.value=w.value.map((t,e)=>({name:t.name,checked:e<a.length?a[e].checked:!0}))}B===0?(O(),B=1):b.value||U()}).catch(o=>{}).finally(()=>{}),R.value=setTimeout(C,500)};return z(()=>{C()}),(c,o)=>{const l=Y,s=q,a=le,t=ae;return E(),Z("div",se,[i("div",ie,[ce,de,i("div",ue,[h(" 范围(100%):    "),f(l,{type:"number",modelValue:V.value,"onUpdate:modelValue":o[0]||(o[0]=e=>V.value=e),onInput:S,min:0,style:{width:"10%"}},null,8,["modelValue"]),h("    一   "),f(l,{type:"number",modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=e=>k.value=e),onInput:S,max:100,style:{width:"10%"}},null,8,["modelValue"]),h("     "),f(s,{onClick:N,type:"info",style:{width:"15%"},icon:x(H)},{default:D(()=>[h(A(b.value?"继续":"暂停"),1)]),_:1},8,["icon"]),f(s,{type:"info",onClick:L,style:{width:"15%"},icon:x(J)},{default:D(()=>[h(" 筛选 ")]),_:1},8,["icon"]),f(t,{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=e=>g.value=e),title:"筛选",visible:g.value,onClose:o[4]||(o[4]=e=>g.value=!1)},{default:D(()=>[i("div",re,[f(l,{modelValue:x(v),"onUpdate:modelValue":o[2]||(o[2]=e=>K(v)?v.value=e:v=e),placeholder:"请输入关键字",clearable:""},null,8,["modelValue"]),me,pe,he,i("div",fe,[(E(!0),Z(X,null,G(x(u),(e,n)=>P((E(),W(a,{key:n,modelValue:e.checked,"onUpdate:modelValue":r=>e.checked=r},{default:D(()=>[h(A(e.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])),[[Q,e.name.includes(x(v))]])),128))])])]),_:1},8,["modelValue","visible"])]),ve,_e])])}}},Ie=j(ge,[["__scopeId","data-v-af533c75"]]);export{Ie as default};

import{o as y,c as $,bH as C,by as S,bl as e,a as l,aC as Je,F as L,aV as I,b as d,f as w,m as t,bc as n,l as j,n as ol,g as U,aK as Te,_ as Le,p as Ne,q as De,aY as sl,at as al,bx as il,cv as H}from"./index-e3c3ccff.js";import{D as Q,b as ul,S as rl,P as cl,W as _l,G as dl,A as we,V as P,M as z,L as Ee,B as Fe,a as qe,E as ne,Q as oe,c as R,d as ml}from"./three.module-b20bde78.js";import{G as fl,O as vl}from"./GLTFLoader-710f8df6.js";import{D as pl}from"./DRACOLoader-36a830fc.js";import{i as V,s as F,b as q,c as Y,e as s,p as o,a as Pe,f as xe,N as gl,g as bl,h as hl,j as Re,k as wl,l as xl,m as kl,n as yl,o as $l,q as Il,r as Cl,t as Sl,u as Vl,v as Jl,w as se,x as El,y as Ae,z as Oe,A as Fl,B as ql,C as Ml,D as Tl,E as Ll,F as Nl,G as Dl,H as Pl,I as Rl,J as Al,K as Ol,L as Bl,M as Be,O as Xl,P as Gl,Q as jl,R as Me,S as zl,T as Yl,U as Ul,V as Zl,W as Hl,X as Ql,Y as Wl,Z as Kl,_ as W,$ as et,a0 as ee,a1 as le,a2 as ae,d as lt}from"./sharedata-a356727b.js";import{E as A}from"./el-dialog-e69e6c9f.js";import{i as Xe}from"./index-c13506ae.js";import tt from"./bbb_Aqw-08391549.js";const nt=["disabled","title"],ot=["disabled","title"],st=["disabled"],at={__name:"contorl",setup(k){const c=()=>{Y.value=!Y.value,Y.value?controls.enabled=!1:controls.enabled=!0},r=()=>{s.value=0,o.value=[],o.value=Pe.concat()},v=()=>{q.value=!q.value},g=()=>{if(F.value){const p=o.value[s.value].logJson.event.name;for(;o.value[s.value].logJson.event.name===p&&!(s.value===o.value.length-1||s.value===0);)s.value++;xe.value=1,F.value=!1}};return(p,a)=>(y(),$(L,null,[C(l("div",null,[l("button",{disabled:e(F),onClick:v,class:Je({playbuttonstyle:e(q),stopbuttonstyle:!e(q)}),title:e(q)?"播放":e(F)?"请处理事件":"暂停"},null,10,nt)],512),[[S,!e(V)]]),C(l("div",null,[l("button",{disabled:!e(F),onClick:g,class:"eventbuttonstyle",title:e(F)?"事件跳过":"无事件"},null,8,ot)],512),[[S,!e(V)]]),C(l("div",null,[l("button",{disabled:e(F),onClick:r,class:"replaybuttonstyle",title:"重播"},null,8,st)],512),[[S,!e(V)]]),C(l("div",null,[l("button",{onClick:c,class:Je({genbuttonstyle:e(Y),bugenbuttonstyle:!e(Y)}),title:"镜头跟随"},null,2)],512),[[S,!e(V)]])],64))}};const it=l("br",null,null,-1),ut=l("br",null,null,-1),rt=l("br",null,null,-1),ct=l("br",null,null,-1),_t=l("br",null,null,-1),dt=l("br",null,null,-1),mt=l("br",null,null,-1),ft=l("br",null,null,-1),vt=l("br",null,null,-1),pt=l("br",null,null,-1),gt=l("br",null,null,-1),bt=l("br",null,null,-1),ht=l("br",null,null,-1),wt=l("br",null,null,-1),xt=l("br",null,null,-1),kt=l("br",null,null,-1),yt=l("br",null,null,-1),$t=l("br",null,null,-1),It={__name:"Contral_Net",setup(k){const c=I(!1),r=()=>{c.value=!0};return(v,g)=>{const p=j,a=A;return y(),$(L,null,[C(d(p,{class:"EXButton",onClick:r},{default:w(()=>[t("控制台")]),_:1},512),[[S,!e(V)]]),d(a,{modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=m=>c.value=m),title:"控制台","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[t(" 开始节点："+n(e(gl)),1),it,t(" 目标节点："+n(e(bl)),1),ut,rt,t(" 当前进度量："+n(e(hl)),1),ct,t(" 控制台设置速度："+n(e(Re)),1),_t,dt,t(" 货物状态："+n(e(wl)),1),mt,t(" 工作状态："+n(e(xl)),1),ft,vt,t(" 1级故障码:"+n(e(kl)),1),pt,t(" 2级故障码:"+n(e(yl)),1),gt,bt,t(" 电池状态："+n(e($l)),1),ht,t(" 任务状态："+n(e(Il)),1),wt,t(" 任务号："+n(e(Cl)),1),xt,t(" 动作key："+n(e(Sl)),1),kt,t(" heading:"+n(e(Vl)),1),yt,t(" 动作码:"+n(e(Jl)),1),$t]),_:1},8,["modelValue"])],64)}}};const Ct=l("br",null,null,-1),St=l("br",null,null,-1),Vt=l("br",null,null,-1),Jt=l("br",null,null,-1),Et=l("br",null,null,-1),Ft={__name:"Info_box",setup(k){let c="AGV状态";return(r,v)=>e(se)?(y(),$("div",{key:0,class:"info-text",style:ol({left:e(Ae)+"px",top:e(Oe)+"px"})},[t(n(e(c)),1),Ct,t(" 时间："+n(e(o)[e(s)].logDateTime),1),St,t(" 车体软件版本："+n(e(o)[0].logJson.nAgvVersion),1),Vt,t(" 车号："+n(e(o)[0].logJson.nAgvNum),1),Jt,t(" 模式："+n(e(El)),1),Et],4)):U("",!0)}};const qt={key:0},Mt=l("br",null,null,-1),Tt=l("br",null,null,-1),Lt=l("br",null,null,-1),Nt=l("br",null,null,-1),Dt=l("br",null,null,-1),Pt=l("br",null,null,-1),Rt=l("br",null,null,-1),At={key:1},Ot=l("br",null,null,-1),Bt=l("br",null,null,-1),Xt=l("br",null,null,-1),Gt=l("br",null,null,-1),jt=l("br",null,null,-1),zt=l("br",null,null,-1),Yt=l("br",null,null,-1),Ut=l("br",null,null,-1),Zt=l("br",null,null,-1),Ht=l("br",null,null,-1),Qt=l("br",null,null,-1),Wt=l("br",null,null,-1),Kt=l("br",null,null,-1),en=l("br",null,null,-1),ln=l("br",null,null,-1),tn=l("br",null,null,-1),nn=l("br",null,null,-1),on=l("br",null,null,-1),sn=l("br",null,null,-1),an=l("br",null,null,-1),un=l("br",null,null,-1),rn=l("br",null,null,-1),cn=l("br",null,null,-1),_n=l("br",null,null,-1),dn=l("br",null,null,-1),mn=l("br",null,null,-1),fn=l("br",null,null,-1),vn=l("br",null,null,-1),pn=l("br",null,null,-1),gn=l("br",null,null,-1),bn=l("br",null,null,-1),hn=l("br",null,null,-1),wn=l("br",null,null,-1),xn=l("br",null,null,-1),kn=l("br",null,null,-1),yn=l("br",null,null,-1),$n=l("br",null,null,-1),In=l("br",null,null,-1),Cn=l("br",null,null,-1),Sn=l("br",null,null,-1),Vn=l("br",null,null,-1),Jn=l("br",null,null,-1),En=l("br",null,null,-1),Fn=l("br",null,null,-1),qn={__name:"AGV_device",setup(k){const c=I(!1),r=()=>{c.value=!0};return(v,g)=>{const p=j,a=A;return y(),$(L,null,[C(d(p,{class:"EXButtonDEV",onClick:r},{default:w(()=>[t("车体设备")]),_:1},512),[[S,!e(V)]]),d(a,{modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=m=>c.value=m),title:"车体设备","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[e(o)[0].agvType===0?(y(),$("div",qt,[t(" 转盘纵向开关："+n(e(o)[e(s)].logJson.equipmentInfo.rack.turn_axis.bZero?"🔴":"🟢"),1),Mt,t(" 转盘横向开关："+n(e(o)[e(s)].logJson.equipmentInfo.rack.turn_axis.bLevel?"🔴":"🟢"),1),Tt,t(" 转盘位置:"+n(e(o)[e(s)].trunpan.toFixed(3)),1),Lt,Nt,t(" 举升高位开关："+n(e(o)[e(s)].logJson.equipmentInfo.rack.lifter_axis.bTop?"🔴":"🟢"),1),Dt,t(" 举升零位开关："+n(e(o)[e(s)].logJson.equipmentInfo.rack.lifter_axis.bBottom?"🔴":"🟢"),1),Pt,t(" 举升位置："+n(e(o)[e(s)].lifter.toFixed(3)),1),Rt])):U("",!0),e(o)[0].agvType===1&&e(o)[e(s)].logJson.equipmentInfo.rack.push!==void 0?(y(),$("div",At,[t(" 前举升上限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.turn_axis.bLevel?"🔴":"🟢"),1),Ot,t(" 前举升下限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.turn_axis.fAxisSpeed?"🔴":"🟢"),1),Bt,t(" 前举升零位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.turn_axis.bZero?"🔴":"🟢"),1),Xt,t(" 前举升位置:"+n(e(o)[e(s)].trunpan.toFixed(3)),1),Gt,jt,t(" 后举升上限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.lifter_axis.bTop?"🔴":"🟢"),1),zt,t(" 后举升下限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.lifter_axis.bBottom?"🔴":"🟢"),1),Yt,t(" 后举升零位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.lifter_axis.fAxisSpeed?"🔴":"🟢"),1),Ut,t(" 后举升位置："+n(e(o)[e(s)].lifter.toFixed(3)),1),Zt,Ht,t(" 前推拉上限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.FPullerSwtPos?"🔴":"🟢"),1),Qt,t(" 前推拉下限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.FPullerSwtNag?"🔴":"🟢"),1),Wt,t(" 前推拉零位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.FPullerSwtZero?"🔴":"🟢"),1),Kt,t(" 前推拉位置："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.FPullerSwtposition.toFixed(3)),1),en,ln,t(" 后推拉上限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.RPullerSwtPos?"🔴":"🟢"),1),tn,t(" 后推拉下限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.RPullerSwtNag?"🔴":"🟢"),1),nn,t(" 后推拉零位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.RPullerSwtZero?"🔴":"🟢"),1),on,t(" 后推拉位置："+n(e(o)[e(s)].logJson.equipmentInfo.rack.push.RPullerSwtposition.toFixed(3)),1),sn,an,t(" 整体上限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.all.CarrierSwtPos?"🔴":"🟢"),1),un,t(" 整体下限位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.all.CarrierSwtNag?"🔴":"🟢"),1),rn,t(" 整体零位："+n(e(o)[e(s)].logJson.equipmentInfo.rack.all.CarrierSwtZero?"🔴":"🟢"),1),cn,t(" 整体位置："+n(e(o)[e(s)].logJson.equipmentInfo.rack.all.CarrierSwtposition.toFixed(3)),1),_n,dn,t(" 前满卷货物检测："+n(e(o)[e(s)].logJson.equipmentInfo.rack.FLifterSwtCargoFull?"🔴":"🟢"),1),mn,t(" 前空卷货物检测："+n(e(o)[e(s)].logJson.equipmentInfo.rack.FLifterSwtCargoEmpty?"🔴":"🟢"),1),fn,t(" 后满卷货物检测："+n(e(o)[e(s)].logJson.equipmentInfo.rack.RLifterSwtCargoFull?"🔴":"🟢"),1),vn,t(" 后空卷货物检测："+n(e(o)[e(s)].logJson.equipmentInfo.rack.RLifterSwtCargoEmpty?"🔴":"🟢"),1),pn,gn,t(" 前满卷偏载："+n(e(o)[e(s)].logJson.equipmentInfo.rack.FLifterSwtPianzaiFull?"🔴":"🟢"),1),bn,t(" 前空卷偏载："+n(e(o)[e(s)].logJson.equipmentInfo.rack.FLifterSwtPianzaiEmpty?"🔴":"🟢"),1),hn,t(" 后满卷偏载："+n(e(o)[e(s)].logJson.equipmentInfo.rack.RLifterSwtPianzaiFull?"🔴":"🟢"),1),wn,t(" 后空卷偏载："+n(e(o)[e(s)].logJson.equipmentInfo.rack.RLifterSwtPianzaiEmpty?"🔴":"🟢"),1),xn,t(" 同步开关："+n(e(o)[e(s)].logJson.equipmentInfo.rack.LifterCentrePosition?"🔴":"🟢"),1),kn])):U("",!0),yn,t(" 当前设备状态："+n(e(Fl)),1),$n,t(" 当前设备任务号："+n(e(ql)),1),In,t(" 当前设备任务状态："+n(e(Ml)),1),Cn,t(" 当前设备故障码:  "+n(e(Tl)),1),Sn,t(" 当前设备动作步骤: "+n(e(Ll)),1),Vn,t(" 当前动作轴id: "+n(),1),Jn,t(" 当前动作轴位置: "+n(),1),En,t(" 当前动作轴开关状态: "+n(),1),Fn]),_:1},8,["modelValue"])],64)}}};const Mn=l("br",null,null,-1),Tn=l("br",null,null,-1),Ln=l("br",null,null,-1),Nn=l("br",null,null,-1),Dn=l("br",null,null,-1),Pn=l("br",null,null,-1),Rn=l("br",null,null,-1),An=l("br",null,null,-1),On=l("br",null,null,-1),Bn=l("br",null,null,-1),Xn=l("br",null,null,-1),Gn=l("br",null,null,-1),jn=l("br",null,null,-1),zn={__name:"AGV_Nav",setup(k){const c=I(!1),r=()=>{c.value=!0},v=()=>{const g=document.getElementById("main1"),p=Xe(g),a=[{value:Math.round(Math.random()*1e3),name:"占用一"},{value:Math.round(Math.random()*1e3),name:"占用二"},{value:Math.round(Math.random()*1e3),name:"占用三"},{value:Math.round(Math.random()*1e3),name:"占用四"},{value:Math.round(Math.random()*1e3),name:"占用五"}],m={title:{text:"占用",textStyle:{color:"black"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,data:a.map(h=>h.name)},series:[{name:"测试数据",type:"pie",radius:"50%",center:["50%","50%"],data:a,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};setInterval(()=>{a.forEach(h=>{h.value=Math.round(Math.random()*1e3)}),p.setOption({series:[{data:a}]})},1e3),p.setOption(m)};return(g,p)=>{const a=j,m=A;return y(),$(L,null,[C(d(a,{class:"EXButtonNAV",onClick:r},{default:w(()=>[t("导航")]),_:1},512),[[S,!e(V)]]),d(m,{modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=h=>c.value=h),title:"导航","custom-class":"custom-dialog",onOpened:v,modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[t(" 导航软件版本："+n(e(Nl)),1),Mn,t(" 导航环境模型版本："+n(e(Dl)),1),Tn,Ln,t(" 目标位置:"+n(e(Pl))+" ",1),Nn,t(" 当前位置："+n(e(Rl)),1),Dn,t(" 理论位置："+n(e(Al)),1),Pn,Rn,t(" 左右偏差："+n(e(Ol)),1),An,t(" 角度偏差："+n((e(Bl)*180/Math.PI).toFixed(3)),1),On,Bn,t(" 发送速度："+n(),1),Xn,t(" 发送舵角："+n(),1),Gn,jn]),_:1},8,["modelValue"])],64)}}},Ge={__name:"Ele_chart",setup(k){const c=I(null),r=(()=>{let a=new Date,m=[],h=5;for(;h--;)m.unshift(a.toLocaleTimeString().replace(/^\D*/,"")),a=new Date(+a-500);return m})(),v=(()=>{let a=[],m=5;for(;m--;)a.push(Math.round(Math.random()*1e3));return a})(),g=(()=>{let a=[],m=5;for(;m--;)a.push(Math.round(Math.random()*1e3));return a})();let p={title:{text:"车速",textStyle:{color:"white"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#283b56"}}},legend:{},toolbox:{show:!0,feature:{dataView:{readOnly:!1},magicType:{type:["bar","line","stack"]},restore:{},saveAsImage:{}},bottom:10},xAxis:{type:"category",data:r,boundaryGap:!0},yAxis:{type:"value"},series:[{data:v,type:"line",name:"实际",color:"green",markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]}},{data:g,name:"理论",type:"line",color:"yellow",markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]}}]};return Te(()=>{const a=Xe(c.value);setInterval(()=>{let m=(Be.value*1e3).toFixed(2),h=new Date().toLocaleTimeString().replace(/^\D*/,"");r.shift(),r.push(h),v.shift(),v.push(m),g.shift(),g.push(Re.value),a.setOption({xAxis:[{data:r}],series:[{data:v},{data:g}]})},400),a.setOption(p)}),(a,m)=>(y(),$("div",{class:"chart",id:"main2",style:{width:450+"px",height:200+"px"},ref_key:"main2",ref:c},null,512))}};const b=k=>(Ne("data-v-ddf5eefb"),k=k(),De(),k),Yn=b(()=>l("br",null,null,-1)),Un=b(()=>l("br",null,null,-1)),Zn=b(()=>l("br",null,null,-1)),Hn=b(()=>l("br",null,null,-1)),Qn=b(()=>l("br",null,null,-1)),Wn=b(()=>l("br",null,null,-1)),Kn=b(()=>l("br",null,null,-1)),eo=b(()=>l("br",null,null,-1)),lo=b(()=>l("br",null,null,-1)),to=b(()=>l("br",null,null,-1)),no=b(()=>l("br",null,null,-1)),oo=b(()=>l("br",null,null,-1)),so=b(()=>l("br",null,null,-1)),ao=b(()=>l("br",null,null,-1)),io=b(()=>l("br",null,null,-1)),uo=b(()=>l("br",null,null,-1)),ro=b(()=>l("br",null,null,-1)),co=b(()=>l("br",null,null,-1)),_o=b(()=>l("br",null,null,-1)),mo=b(()=>l("br",null,null,-1)),fo=b(()=>l("br",null,null,-1)),vo=b(()=>l("br",null,null,-1)),po=b(()=>l("br",null,null,-1)),go=b(()=>l("br",null,null,-1)),bo=b(()=>l("br",null,null,-1)),ho=b(()=>l("br",null,null,-1)),wo=b(()=>l("br",null,null,-1)),xo={__name:"AGV_ELE",setup(k){const c=I(!1),r=()=>{c.value=!0},v=()=>{W.value<et.value-1?W.value++:W.value=0,console.log(W.value),Me.value="驱动轴"+W.value.toString(),ee(),le()};return(g,p)=>{const a=j,m=A;return y(),$(L,null,[C(d(a,{class:"EXButtonELE",onClick:r},{default:w(()=>[t("电器模块")]),_:1},512),[[S,!e(V)]]),d(m,{modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=h=>c.value=h),title:"电器模块","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[t(" 保险杠状态："+n(e(Xl)),1),Yn,t(" 急停触发："+n(e(Gl)),1),Un,t(" pls状态："+n(e(jl)),1),Zn,Hn,t(" 二维码:"),Qn,t(" x:"+n(e(o)[e(s)].logJson.electricalModule.sensor.camera.fx.toFixed(4)),1),Wn,t(" y:"+n(e(o)[e(s)].logJson.electricalModule.sensor.camera.fy.toFixed(4)),1),Kn,t(" 角度:"+n(e(o)[e(s)].logJson.electricalModule.sensor.camera.fthita.toFixed(4)),1),eo,lo,t(" 电量百分比："+n(e(o)[e(s)].logJson.electricalModule.sensor.battmetr.fCapPercent.toFixed(2)),1),to,t(" 电池状态："+n(e(o)[e(s)].logJson.electricalModule.sensor.battmetr.sState),1),no,oo,t(" 磁导航偏差1:"+n(e(o)[e(s)].logJson.electricalModule.sensor.magnetic.fDev[0]),1),so,t(" 磁导航偏差2:"+n(e(o)[e(s)].logJson.electricalModule.sensor.magnetic.fDev[1]),1),ao,t(" 磁导航状态:"+n(e(o)[e(s)].logJson.electricalModule.sensor.magnetic.sGrade),1),io,uo,t(" 惯导："+n(),1),ro,t(" 切换驱动单元："),d(a,{class:"buttonstyle",onClick:v},{default:w(()=>[t(n(e(Me)),1)]),_:1}),co,t(" 轮伺服实际速度："+n(e(Be)),1),_o,t(" 轮伺服状态码："+n(e(zl)),1),mo,t(" 轮伺服错误码："+n(e(Yl)),1),fo,t(" 舵伺服实际位置："+n(e(Ul)),1),vo,t(" 舵伺服状态码："+n(e(Zl)),1),po,t(" 舵伺服错误码："+n(e(Hl)),1),go,t(" 舵限位开关："+n(e(Ql)),1),bo,t(" 舵限位开关："+n(e(Wl)),1),ho,t(" 舵零位开关："+n(e(Kl)),1),wo,d(Ge)]),_:1},8,["modelValue"])],64)}}},ko=Le(xo,[["__scopeId","data-v-ddf5eefb"]]);const yo=l("br",null,null,-1),$o=l("br",null,null,-1),Io=l("br",null,null,-1),Co=l("br",null,null,-1),So={__name:"event",setup(k){I(0);const c=I(!1),r=()=>{c.value=!0};return(v,g)=>{const p=j,a=A;return y(),$(L,null,[C(d(p,{class:"EVENTButton",onClick:r},{default:w(()=>[t("事件信息")]),_:1},512),[[S,!v.importflag]]),d(a,{modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=m=>c.value=m),title:"事件信息","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[t(" 发送时间："+n(e(o)[e(s)].logDateTime),1),yo,t(" 事件："+n(e(o)[e(s)].logJson.event.name),1),$o,t(" 原因："+n(e(o)[e(s)].logJson.event.detail),1),Io,t(" AGV建议:"+n(e(o)[e(s)].logJson.event.advise),1),Co]),_:1},8,["modelValue"])],64)}}};const Vo=l("br",null,null,-1),Jo={key:0,class:"parsedItemsdata"},Eo={key:0},Fo={__name:"statistics",setup(k){const c=I(!1);let r=I(0);const v=()=>{c.value=!0},g=I(!1),p=()=>{console.log("11111",o.value),g.value=!0},a=()=>{r.value>0&&r.value--},m=()=>{r.value<o.value[s.value].parsedItems.length-1&&r.value++};return(h,O)=>{const B=j,X=A;return y(),$(L,null,[C(d(B,{class:"EXButtonstatistics",onClick:v},{default:w(()=>[t("统计")]),_:1},512),[[S,!e(V)]]),d(X,{title:"统计",modelValue:c.value,"onUpdate:modelValue":O[0]||(O[0]=M=>c.value=M),"custom-class":"custom-dialog",style:{width:"80%",height:"70%"},modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[d(tt)]),_:1},8,["modelValue"]),C(d(B,{class:"EXButtonreseve",onClick:p},{default:w(()=>[t("预留")]),_:1},512),[[S,!e(V)]]),d(X,{title:"预留",modelValue:g.value,"onUpdate:modelValue":O[1]||(O[1]=M=>g.value=M),"custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:w(()=>[d(B,{onClick:a},{default:w(()=>[t("＜")]),_:1}),d(B,{onClick:m},{default:w(()=>[t("＞")]),_:1}),Vo,e(o)[e(s)].parsedItems?(y(),$("div",Jo,[e(o)[e(s)].parsedItems[e(r)]!==void 0?(y(),$("div",Eo,[l("h2",null,n(e(o)[e(s)].parsedItems[e(r)].itemName),1),(y(!0),$(L,null,sl(e(o)[e(s)].parsedItems[e(r)].itemObject,(M,f)=>(y(),$("div",{key:f},n(f)+": "+n(M),1))),128))])):U("",!0)])):U("",!0)]),_:1},8,["modelValue"])],64)}}},qo=l("br",null,null,-1),Mo=l("br",null,null,-1),To=l("br",null,null,-1),Lo={__name:"screen_info",setup(k,{expose:c}){const r=I(!1),v=I(!1);return c({handleMouseClick:p=>{const a=ae.intersectObjects([p]);a.length>0&&(console.log("modelname:",a[0].object.name),a[0].object.name==="screen"||a[0].object.name==="screen1"||a[0].object.name==="screen2"||a[0].object.name==="screen3"||a[0].object.name==="screen4"?(v.value=!0,r.value=!0):(r.value=!1,v.value=!1))}}),(p,a)=>{const m=A;return y(),$(L,null,[d(m,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=h=>v.value=h),title:"屏幕2","custom-class":"custom-dialog2",onOpened:p.openDialog,modal:!1},{default:w(()=>[d(Ge)]),_:1},8,["modelValue","onOpened"]),d(m,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=h=>r.value=h),title:"屏幕","custom-class":"custom-dialog3",modal:!1},{default:w(()=>[t(" 屏幕型号:迪文屏幕"),qo,t(" 通讯类型:串口通讯"),Mo,t(" 手控设备信息:无"),To]),_:1},8,["modelValue"])],64)}}},No=l("br",null,null,-1),Do=l("br",null,null,-1),Po=l("br",null,null,-1),Ro=l("br",null,null,-1),Ao=l("br",null,null,-1),Oo=l("br",null,null,-1),Bo=l("br",null,null,-1),Xo=l("br",null,null,-1),Go=l("br",null,null,-1),jo=l("br",null,null,-1),zo=l("br",null,null,-1),Yo=l("br",null,null,-1),Uo={__name:"wheel_info",setup(k,{expose:c}){const r=I(!1),v=I(!1);return c({handleMouseClickwheel:p=>{const a=ae.intersectObjects([p]);a.length>0&&(a[0].object.name==="rightwheel"||a[0].object.name==="rightwheel1"||a[0].object.name==="rightwheel2"?r.value=!0:r.value=!1,a[0].object.name==="leftwheel"||a[0].object.name==="leftwheel1"||a[0].object.name==="leftwheel2"?v.value=!0:v.value=!1)}}),(p,a)=>{const m=A;return y(),$(L,null,[d(m,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=h=>r.value=h),title:"右轮","custom-class":"custom-dialog3",modal:!1},{default:w(()=>[t(" 驱动内坐标X:"+n(),1),No,t(" 驱动内坐标Y:"+n(),1),Do,t(" 电机减速比:"+n(),1),Po,t(" 车轮直径:"+n(),1),Ro,t(" 码盘线束:"+n(),1),Ao,t(" 最大转速:"+n(),1),Oo]),_:1},8,["modelValue"]),d(m,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=h=>v.value=h),title:"左轮","custom-class":"custom-dialog2",modal:!1},{default:w(()=>[t(" 驱动内坐标X:"+n(),1),Bo,t(" 驱动内坐标Y:"+n(),1),Xo,t(" 电机减速比:"+n(),1),Go,t(" 车轮直径:"+n(),1),jo,t(" 码盘线束:"+n(),1),zo,t(" 最大转速:"+n(),1),Yo]),_:1},8,["modelValue"])],64)}}};const Zo=k=>(Ne("data-v-3c5cd802"),k=k(),De(),k),Ho={class:"home"},Qo={class:"choose"},Wo=Zo(()=>l("div",{class:"choose-title"},"控制：",-1)),Ko={class:"file-upload"},es={class:"logprocess"},ls=["disabled","max"],ts=["disabled","title"],ns=["disabled","title"],os={key:0},K=500,ss={__name:"index",setup(k){const c=I(null),r=I(null),v=new fl,g=new pl;g.setDecoderPath("https://asdqvqw.github.io/whwtest.github.io/draco/"),v.setDRACOLoader(g);const p=I(0),a=new Q(16777215,1);a.position.set(0,0,10);const m=new Q(16777215,1);m.position.set(0,0,-10);const h=new Q(16777215,1);h.position.set(10,0,0);const O=new Q(16777215,1);O.position.set(-10,0,0);const B=new Q(16777215,1);B.position.set(0,10,0);let X,M,f,ke=I(null),je=7;const ie=new ul,J=new rl,G=new cl(75,window.innerWidth/window.innerHeight,.1,1e3);G.position.set(0,2,6);const ze=i=>{const u=i.target.files[0],_=new FileReader;_.onload=E=>{const N=String(E.target.result);Ye(N)},_.readAsText(u)},Ye=i=>{H.success("开始导入数据...");const u=i.split("[INFO | ");for(let _=1;_<u.length;_++){const E=u[_],N=E.indexOf("]"),T=E.substring(0,N).trim(),Z=E.substring(N+3).trim(),x=JSON.parse(Z),D=x.navInfo.fRealX.toFixed(3),Ie=x.navInfo.fRealY.toFixed(3),Ce=0,Se=(x.navInfo.fRealThita*180/Math.PI).toFixed(3);let me="",fe="";x.equipmentInfo.rack!==void 0&&(me=x.equipmentInfo.rack.turn_axis.fAxisPosition/1e3,fe=x.equipmentInfo.rack.lifter_axis.fAxisPosition);let ve="";x.uAgvType!==void 0&&(ve=x.uAgvType);let pe=[];if(x.item!==void 0){const ll=x.item;for(const be of ll){const tl=be.name;let Ve={};for(const he in be)if(he!=="name"){const nl=be[he];Ve[he]=nl}pe.push({itemName:tl,itemObject:Ve})}}let ge="";x.statistics!==void 0&&(ge=x.statistics),o.value.push({logDateTime:T,logJson:x,realx:D,realy:Ie,realthita:Se,realz:Ce,agvType:ve,parsedItems:pe,trunpan:me,lifter:fe,StatisticsData:ge}),Pe.push({logDateTime:T,logJson:x,realx:D,realy:Ie,realthita:Se,realz:Ce,agvType:ve,parsedItems:pe,trunpan:me,lifter:fe,StatisticsData:ge})}H.success("开始导入模型..."),lt.parsedLogData_b=o.value,p.value=o.value.length-1,o.value[0].agvType===0?(v.load("./main/test.glb",_=>{f=_.scene,f.rotation.set(0,z.degToRad(90),0),J.add(f),$e(),ce(),de()},_=>{console.log(_.loaded/_.total*100+"% loaded")},_=>{console.error("Error loading model:",_)}),H.success("导入完成")):o.value[0].agvType===1?(v.load("./main/v.glb",_=>{f=_.scene,f.rotation.set(0,z.degToRad(90),0),J.add(f),ye(),ce(),de()},_=>{console.log(_.loaded/_.total*100+"% loaded")},_=>{console.error("Error loading model:",_)}),H.success("导入完成")):H.error("没有匹配模型"),V.value=!1,Ue()},Ue=()=>{const i=new Ee({color:255,linewidth:1}),u=o.value.map(D=>new P(D.realx,D.realz,-D.realy)),_=new Fe().setFromPoints(u);let E=new qe(_,i);const N=new Ee({color:16711680,linewidth:1}),T=o.value.map(D=>new P(D.logJson.tcInfo.iDevX/1e3,0,-D.logJson.tcInfo.iDevY/1e3)),Z=new Fe().setFromPoints(T);let x=new qe(Z,N);s.value=0,J.add(E),J.add(x),re()},Ze=()=>{if(f&&s.value>0){s.value--;const i=o.value[s.value];f.position.set(i.realx,0,-i.realy);const u=new ne(0,z.degToRad(o.value[s.value-1].realthita),0,"XYZ"),_=new oe().setFromEuler(u);f.setRotationFromQuaternion(_),ee(),le()}},He=()=>{if(f&&q.value&&s.value>0){s.value--;const i=o.value[s.value];f.position.set(i.realx,0,-i.realy);const u=new ne(0,z.degToRad(o.value[s.value-1].realthita),0,"XYZ"),_=new oe().setFromEuler(u);f.setRotationFromQuaternion(_),ee(),le()}},Qe=()=>{if(f&&q.value&&s.value<o.value.length-1){s.value++;const i=o.value[s.value];f.position.set(i.realx,0,-i.realy);const u=new ne(0,z.degToRad(o.value[s.value+1].realthita),0,"XYZ"),_=new oe().setFromEuler(u);f.setRotationFromQuaternion(_),ee(),le()}},We=i=>{ie.x=i.clientX/window.innerWidth*2-1,ie.y=-(i.clientY/window.innerHeight)*2+1,ae.setFromCamera(ie,G),f!==void 0&&(ae.intersectObjects([f]).length>0?(Ae.value=i.clientX+10,Oe.value=i.clientY+10,se.value=!0):se.value=!1)},Ke=()=>{se.value=!1},te=new _l({antialias:!0});te.setSize(window.innerWidth,window.innerHeight);const el=()=>{if(f&&!q.value&&!F.value&&o.value[s.value]&&o.value[s.value+1]){s.value++;const i=o.value[s.value];f.position.set(i.realx,0,-i.realy);const u=new ne(0,z.degToRad(o.value[s.value].realthita),0,"XYZ"),_=new oe().setFromEuler(u);f.setRotationFromQuaternion(_),ee(),le(),o.value[s.value].logJson.nAgvState===3&&o.value[s.value].logJson.event.name!==""&&(xe.value=2,F.value=!0)}};let ue=0;const re=()=>{ue++,ue>=je&&(el(),ue=0),Y.value&&f&&(G.position.copy(f.position),G.position.y+=6,G.lookAt(f.position)),te.render(J,G),X&&X.update(),requestAnimationFrame(re)},ye=()=>{f.traverse(i=>{i.name==="upDown"&&(i.position.y=o.value[s.value].lifter*1e3),i.name==="leftwheel"&&(i.rotation.z+=o.value[s.value].logJson.electricalModule.kinematic.drive[0].wheel.fServoSpeed.toFixed(5)*.5),i.name==="rightwheel"&&(i.rotation.z+=o.value[s.value].logJson.electricalModule.kinematic.drive[1].wheel.fServoSpeed.toFixed(5)*.5)}),requestAnimationFrame(ye)},$e=()=>{f.traverse(i=>{if(i.name==="upDown"&&(i.rotation.y=o.value[s.value].trunpan.toFixed(2),i.position.y=o.value[s.value].lifter+1e3),i.name==="leftwheel"&&(i.rotation.z+=o.value[s.value].logJson.electricalModule.kinematic.drive[0].wheel.fServoSpeed.toFixed(5)*.5),i.name==="rightwheel"&&(i.rotation.z+=o.value[s.value].logJson.electricalModule.kinematic.drive[1].wheel.fServoSpeed.toFixed(5)*.5),i.name==="turnnei")if(o.value[s.value].logJson.equipmentInfo.rack.turn_axis.bLevel){const u=new R({color:16711680});i.material=u}else{const u=new R({color:65280});i.material=u}if(i.name==="turnwai")if(o.value[s.value].logJson.equipmentInfo.rack.turn_axis.bZero){const u=new R({color:16711680});i.material=u}else{const u=new R({color:65280});i.material=u}if(i.name==="liftertop")if(o.value[s.value].logJson.equipmentInfo.rack.lifter_axis.bTop){const u=new R({color:16711680});i.material=u}else{const u=new R({color:65280});i.material=u}if(i.name==="lifterbuttom")if(o.value[s.value].logJson.equipmentInfo.rack.lifter_axis.bBottom){const u=new R({color:16711680});i.material=u}else{const u=new R({color:65280});i.material=u}}),requestAnimationFrame($e)},ce=()=>{f.traverse(i=>{if(i.name==="screen2"){const u=Math.random()*16777215;i.material.color.setHex(u)}}),setTimeout(ce,200)};let _e=1;const de=()=>{const u={1:{on:65280,off:16777215},2:{on:16711680,off:16777215}}[xe.value],_=u.on,E=u.off,N=(T,Z)=>{T.traverse(x=>{x instanceof ml&&(x.material.color.clone(),x.material.color.set(Z))})};f.traverse(T=>{T.name==="light"&&(_e===1?N(T,_):N(T,E))}),_e=1-_e,setTimeout(de,500)};return Te(()=>{window.addEventListener("mousemove",We),window.addEventListener("mouseout",Ke),window.addEventListener("click",()=>{c.value.handleMouseClick(f)}),window.addEventListener("click",()=>{r.value.handleMouseClickwheel(f)}),ke.value.appendChild(te.domElement),M=new dl(K,K),M.material.opacity=.3,M.material.transparent=!0,J.add(M);const i=new we(new P(1,0,0),new P(0,0,0),K/2,16711680),u=new we(new P(0,0,0),new P(0,0,0),K/2,65280),_=new we(new P(0,0,-1),new P(0,0,0),K/2,255);J.add(i,u,_),X=new vl(G,te.domElement),X.update(),J.add(a),J.add(m),J.add(h),J.add(O),J.add(B),re()}),(i,u)=>{const _=j;return y(),$("div",Ho,[l("div",{class:"canvas-container",ref_key:"canvasDom",ref:ke},null,512),l("div",Qo,[Wo,C(l("div",Ko,[l("input",{ref:"importInput",type:"file",accept:".log",style:{display:"none"},onChange:ze},null,544),d(_,{onClick:u[0]||(u[0]=E=>i.$refs.importInput.click()),class:"buttonstyle"},{default:w(()=>[t(" 导入 ")]),_:1})],512),[[S,e(V)]]),C(l("div",es,[t(" 回放进度:"+n(e(F)?"请处理事件":e(o)[e(s)]===void 0?"":e(o)[e(s)].logDateTime)+" ",1),C(l("input",{disabled:e(F),type:"range",style:{width:"100%"},"onUpdate:modelValue":u[1]||(u[1]=E=>al(s)?s.value=E:null),min:"0",max:p.value,step:"1",onChange:Ze},null,40,ls),[[il,e(s)]])],512),[[S,!e(V)]]),d(at),C(l("div",null,[l("button",{disabled:!e(q)||e(s)===e(o).length+1,onClick:He,class:"next2playbuttonstyle",title:e(q)?"上一步":"请暂停"},null,8,ts),l("button",{disabled:!e(q)||e(s)===e(o).length-1,onClick:Qe,class:"nextplaybuttonstyle",title:e(q)?"下一步":"请暂停"},null,8,ns)],512),[[S,!e(V)]]),d(Ft)]),d(qn),d(ko),e(F)?(y(),$("div",os,[d(So)])):U("",!0),d(Fo),d(zn),d(Lo,{ref_key:"screenRef",ref:c},null,512),d(Uo,{ref_key:"wheelRef",ref:r},null,512),d(It)])}}},fs=Le(ss,[["__scopeId","data-v-3c5cd802"]]);export{fs as default};

import{_ as P,aV as p,aK as U,o as q,c as J,a as m,b as g,bl as x,m as f,bc as E,f as K,cw as R,cn as X,l as Y,E as F,cD as G,b$ as H,cy as Q,p as W,q as tt}from"./index-550ea9bd.js";import{g as et,i as at}from"./index-c13506ae.js";const D=_=>(W("data-v-90336498"),_=_(),tt(),_),ot={class:"page-container main-view"},nt={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},st=D(()=>m("h2",{style:{"margin-top":"1%","margin-left":"1%"}},"统计",-1)),it=D(()=>m("div",{class:"hengxian"},null,-1)),lt={class:"box"},ct=D(()=>m("br",null,null,-1)),rt=D(()=>m("div",{class:"box2"},[m("div",{id:"chart-container"})],-1)),dt={__name:"index",setup(_){let V=p(""),d=0,u=null;const M=p(""),Z=p("");let h=p([]);const b=p(0),w=p(100),$=()=>{d>0&&(d--,I())},A=()=>{d<h.value[0].StatisticsData.length-1&&(d++,I())},N=()=>{const c=et(document.getElementById("chart-container")),n=Math.max(0,Math.min(b.value,100)),e=Math.max(0,Math.min(w.value,100)),l={dataZoom:[{show:!1,type:"slider",start:n,end:e}]};c.setOption(l)},I=()=>{u&&u.dispose();const c=document.getElementById("chart-container");u=at(c);const n=new Date(M.value),e=new Date(Z.value);V.value=h.value[0].StatisticsData[d].name,n&&e&&!isNaN(n.getTime())&&isNaN(e.getTime());let l;l=h.value;const t=l.map(a=>a.logDateTime),s=[];for(let a=0;a<l.length;a++){const r=l[a].StatisticsData[d].value.map(o=>o.value);for(let o=0;o<r.length;o++)s[o]||(s[o]=[]),s[o].push(r[o])}const i={xAxis:{type:"category",data:t},yAxis:{type:"value"},series:s.map((a,r)=>({type:"line",name:l[0].StatisticsData[d].value[r].name,data:a})),tooltip:{trigger:"axis",formatter:a=>{let r=`时间: ${a[0].name}<br/>`;for(let o=0;o<a.length;o++){const{seriesName:y,value:S}=a[o];r+=`${y}: ${S}<br/>`}return r}},dataZoom:[{show:!1,type:"slider"}]};u.on("dataZoom",({start:a,end:r})=>{const o=Math.round(a*(t.length-1)),y=Math.round(r*(t.length-1)),S=t.slice(o,y+1),L=s.map(B=>B.slice(o,y+1));u.setOption({xAxis:{data:S},series:s.map((B,z)=>({data:L[z]}))})}),u.setOption(i),u.setOption({toolbox:{show:!0,feature:{saveAsImage:{name:"chartInstance",title:"保存图表",pixelRatio:2},magicType:{type:["bar","line","stack","tiled"]}}}})},v=p(!1),O=()=>{v.value=!v.value},j=()=>{let c;c=h.value;const n=c.map(t=>t.logDateTime),e=[];for(let t=0;t<c.length;t++){const s=c[t].StatisticsData[d].value.map(i=>i.value);for(let i=0;i<s.length;i++)e[i]||(e[i]=[]),e[i].push(s[i])}const l={xAxis:{type:"category",data:n},yAxis:{type:"value"},series:e.map((t,s)=>({type:"line",name:c[0].StatisticsData[d].value[s].name,data:t})),tooltip:{trigger:"axis",formatter:t=>{let s=`时间: ${t[0].name}<br/>`;for(let i=0;i<t.length;i++){const{seriesName:a,value:r}=t[i];s+=`${a}: ${r}<br/>`}return s}},legend:{show:!0},dataZoom:[{show:!1,type:"slider"}]};u.setOption(l)};let T=0;const k=p(null),C=()=>{R({method:"post",url:"/api/data/statistics",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(n=>{k.value=n.data;const e=new Date;h.value.push({logDateTime:e.toLocaleString(),StatisticsData:k.value}),T===0?(I(),T=1):v.value||j()}).catch(n=>{}).finally(()=>{}),X.value=setTimeout(C,500)};return U(()=>{C()}),(c,n)=>{const e=Y,l=F;return q(),J("div",ot,[m("div",nt,[st,it,m("div",lt,[g(e,{onClick:$,type:"info",style:{width:"10%","margin-left":"1%"},icon:x(G)},null,8,["icon"]),f("  "+E("🎈"+x(V))+" ",1),g(e,{onClick:A,type:"info",style:{width:"10%","margin-left":"1%"},icon:x(H)},null,8,["icon"]),f("     范围：    "),g(l,{type:"number",modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=t=>b.value=t),onInput:N,min:0,style:{width:"10%"}},null,8,["modelValue"]),f("    一   "),g(l,{type:"number",modelValue:w.value,"onUpdate:modelValue":n[1]||(n[1]=t=>w.value=t),onInput:N,max:100,style:{width:"10%"}},null,8,["modelValue"]),f("     "),g(e,{onClick:O,type:"info",style:{width:"15%"},icon:x(Q)},{default:K(()=>[f(E(v.value?"继续":"暂停"),1)]),_:1},8,["icon"])]),ct,rt])])}}},mt=P(dt,[["__scopeId","data-v-90336498"]]);export{mt as default};

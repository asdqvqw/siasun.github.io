import{aV as h,o as c,c as u,m as p,a as e,b as g,f as b,cN as v,cw as x,cv as r,l as F,bJ as E,F as C,aY as N,g as D,bc as I}from"./index-9f797bf0.js";const V=e("h2",null,"✅更新网页:",-1),B=e("br",null,null,-1),T={__name:"web",setup(k){const i=h(null),o=()=>{},f=()=>{v.confirm("是否更新网页？","提示").then(()=>{_()}).catch(()=>{})},_=async()=>{const s=i.value.files[0];s&&x({method:"post",url:"/api/upload",data:s,headers:{"Content-Type":s.type,"X-File-Name":s.name}}).then(a=>{r.success("更新成功"),r.success("刷新网页后生效"),console.log("File uploaded successfully:",a.data)}).catch(a=>{r.error("Error uploading file:",a),console.error("Error uploading file:",a)}).finally(()=>{})};return(s,a)=>{const m=F;return c(),u("div",null,[V,B,p(" ❗注意压缩包中携带web_root文件夹: "),e("input",{style:{"margin-left":"30px"},type:"file",ref_key:"fileInput",ref:i,accept:".tar.gz",onChange:o},null,544),g(m,{type:"primary",onClick:f,style:{"margin-top":"30px",width:"80%","margin-left":"8%"}},{default:b(()=>[p("更新")]),_:1})])}}},A={class:"page-container main-view"},M={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},U=e("br",null,null,-1),$=e("h2",null,"✅上传文件到AGV:",-1),G=e("br",null,null,-1),X=e("p",null,[e("h4",null,"将文件拖放到此处上传或点击选择文件"),e("br"),p(" ❗注意无法上传文件夹和文件名带中文的文件。"),e("br")],-1),z={key:0},J=e("br",null,null,-1),S={__name:"index",setup(k){const i=h(null),o=h([]),f=()=>{v.confirm("是否提交文件","提示").then(()=>{m()}).catch(()=>{})},_=n=>{n.preventDefault();const t=n.dataTransfer.items;if(t){for(const l of t)if(l.kind==="file")if(l.webkitGetAsEntry().isDirectory)console.error("Error: 无法上传文件夹。"),r.error("无法上传文件夹。");else{const d=l.getAsFile();if(/[\u4e00-\u9fa5]/.test(d.name)){console.error("Error: 无法上传包含中文字符的文件。"),r.error("无法上传包含中文字符的文件。");continue}o.value.push(d)}}},s=()=>{i.value.value=null,i.value.click()},a=n=>{o.value=[];const t=n.target.files;if(t.length>0)for(const l of t){if(/[\u4e00-\u9fa5]/.test(l.name)){console.error("Error: 无法上传包含中文字符的文件。"),r.error("无法上传包含中文字符的文件。");continue}o.value.push(l)}},m=async()=>{for(const n of o.value)await w(n);o.value=[]},w=async n=>{if(n)try{const t=await x({method:"post",url:"/api/upload",data:n,headers:{"Content-Type":n.type,"X-File-Name":n.name}});r.success("上传成功"),console.log("File uploaded successfully:",t.data)}catch(t){r.error("Error uploading file:",t),console.error("Error uploading file:",t)}};return(n,t)=>{const l=F;return c(),u("div",A,[e("div",M,[U,$,G,e("div",{onDragover:t[0]||(t[0]=E(()=>{},["prevent"])),onDrop:_,onClick:s,style:{border:"4px dashed #ccc",padding:"20px","text-align":"center",cursor:"pointer",width:"70%","margin-left":"10%"}},[e("input",{type:"file",ref_key:"fileInput",ref:i,style:{display:"none"},onChange:a,multiple:""},null,544),X,o.value.length>0?(c(),u("ul",z,[(c(!0),u(C,null,N(o.value,(y,d)=>(c(),u("li",{key:d},I(y.name),1))),128))])):D("",!0)],32),J,g(l,{type:"primary",onClick:f,style:{"margin-top":"10px",width:"80%","margin-left":"8%"}},{default:b(()=>[p("上传文件")]),_:1}),e("div",null,[g(T)])])])}}};export{S as default};

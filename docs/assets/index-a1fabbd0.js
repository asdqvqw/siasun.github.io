import{_ as j,aV as m,aK as z,o as E,c as Z,a as i,m as h,b as f,f as V,bl as x,ck as F,E as R,l as Y,bc as A,cm as q,cp as H,at as J,F as K,aY as X,bH as G,by as P,e as Q,p as W,q as ee}from"./index-02639357.js";import{E as te}from"./el-dialog-4d9a1aad.js";/* empty css                    */import{g as ae,i as oe}from"./index-c13506ae.js";import{d as ne}from"./timer-486d2b06.js";import{E as le}from"./index-954f2623.js";import"./isEqual-801b63cc.js";import"./8Array-95410dc0.js";const p=y=>(W("data-v-b4301192"),y=y(),ee(),y),se={class:"page-container main-view"},ie={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},de=p(()=>i("h2",{style:{"margin-top":"1%","margin-left":"1%"}},"变量分析",-1)),ce=p(()=>i("div",{class:"hengxian"},null,-1)),re={class:"box"},ue={class:"box2"},me=p(()=>i("br",null,null,-1)),pe=p(()=>i("br",null,null,-1)),he=p(()=>i("br",null,null,-1)),fe={class:"box"},ve=p(()=>i("br",null,null,-1)),_e=p(()=>i("div",{class:"box2"},[i("div",{id:"chart-container"})],-1)),ge={__name:"index",setup(y){let v=m(""),r=null;const w=m(0),k=m(100);let _=m([]),c=m([]);const g=m(!1),L=()=>{g.value=!0},S=()=>{const d=ae(document.getElementById("chart-container")),o=Math.max(0,Math.min(w.value,100)),l=Math.max(0,Math.min(k.value,100)),s={dataZoom:[{show:!1,type:"slider",start:o,end:l}]};d.setOption(s)},b=m(!1),N=()=>{b.value=!b.value},O=()=>{r&&r.dispose();const d=document.getElementById("chart-container");r=oe(d);let o;o=_.value;const l=o.map(t=>t.logDateTime),s=[];for(let t=0;t<o.length;t++){const e=o[t].StatisticsData.map(n=>n.value);for(let n=0;n<e.length;n++)s[n]||(s[n]=[]),s[n].push(e[n])}const a={xAxis:{type:"category",data:l},yAxis:{type:"value"},series:c.value.filter(t=>t.checked).map(t=>{const e=c.value.findIndex(n=>n.name===t.name);return{type:"line",name:t.name,data:s[e]}}),legend:{show:!1},tooltip:{trigger:"axis",formatter:t=>{let e=`时间: ${t[0].name}<br/>`;for(let n=0;n<t.length;n++){const{seriesName:u,value:I}=t[n];e+=`${u}: ${I}<br/>`}return e}},dataZoom:[{show:!1,type:"slider"}]};r.on("dataZoom",({start:t,end:e})=>{const n=Math.round(t*(l.length-1)),u=Math.round(e*(l.length-1)),I=l.slice(n,u+1),$=s.map(M=>M.slice(n,u+1));r.setOption({xAxis:{data:I},series:s.map((M,T)=>({data:$[T]}))})}),r.setOption(a),r.setOption({toolbox:{show:!0,feature:{saveAsImage:{name:"chartInstance",title:"保存图表",pixelRatio:2}}}})},U=()=>{let d;d=_.value;const o=d.map(a=>a.logDateTime),l=[];for(let a=0;a<d.length;a++){const t=d[a].StatisticsData.map(e=>e.value);for(let e=0;e<t.length;e++)l[e]||(l[e]=[]),l[e].push(t[e])}const s={xAxis:{type:"category",data:o},yAxis:{type:"value"},series:c.value.filter(a=>a.checked).map(a=>{const t=c.value.findIndex(e=>e.name===a.name);return{type:"line",name:a.name,data:l[t]}}),legend:{show:!1},tooltip:{trigger:"axis",formatter:a=>{let t=`时间: ${a[0].name}<br/>`;for(let e=0;e<a.length;e++){const{seriesName:n,value:u}=a[e];t+=`${n}: ${u}<br/>`}return t}},dataZoom:[{show:!1,type:"slider"}]};console.log("2333333",c.value.filter(a=>a.checked).map((a,t)=>({type:"line",name:a.name,data:l[t]}))),r.setOption(s)};let C=0;const D=m(null),B=()=>{F({method:"post",url:"/api/data/analysis",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(o=>{D.value=o.data;const s={logDateTime:new Date().toLocaleString(),StatisticsData:D};if(_.value.length===0)_.value.push(s),c.value=D.value.map(a=>({name:a.name,checked:!1}));else{const a=c.value;_.value.push(s),c.value=D.value.map((t,e)=>({name:t.name,checked:e<a.length?a[e].checked:!0}))}C===0?(O(),C=1):b.value||U()}).catch(o=>{}).finally(()=>{}),ne.value=setTimeout(B,500)};return z(()=>{B()}),(d,o)=>{const l=R,s=Y,a=le,t=te;return E(),Z("div",se,[i("div",ie,[de,ce,i("div",re,[h(" 范围：    "),f(l,{type:"number",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=e=>w.value=e),onInput:S,min:0,style:{width:"10%"}},null,8,["modelValue"]),h("    一   "),f(l,{type:"number",modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=e=>k.value=e),onInput:S,max:100,style:{width:"10%"}},null,8,["modelValue"]),h("     "),f(s,{onClick:N,type:"info",style:{width:"15%"},icon:x(q)},{default:V(()=>[h(A(b.value?"继续":"暂停"),1)]),_:1},8,["icon"]),f(s,{type:"info",onClick:L,style:{width:"15%"},icon:x(H)},{default:V(()=>[h(" 筛选 ")]),_:1},8,["icon"]),f(t,{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=e=>g.value=e),title:"筛选",visible:g.value,onClose:o[4]||(o[4]=e=>g.value=!1)},{default:V(()=>[i("div",ue,[f(l,{modelValue:x(v),"onUpdate:modelValue":o[2]||(o[2]=e=>J(v)?v.value=e:v=e),placeholder:"请输入关键字",clearable:""},null,8,["modelValue"]),me,pe,he,i("div",fe,[(E(!0),Z(K,null,X(x(c),(e,n)=>G((E(),Q(a,{key:n,modelValue:e.checked,"onUpdate:modelValue":u=>e.checked=u},{default:V(()=>[h(A(e.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])),[[P,e.name.includes(x(v))]])),128))])])]),_:1},8,["modelValue","visible"])]),ve,_e])])}}},Ee=j(ge,[["__scopeId","data-v-b4301192"]]);export{Ee as default};

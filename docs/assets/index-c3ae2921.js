import{aV as w,bB as $e,o as h,c as C,F as G,aY as X,b as e,f as l,a as d,bc as S,m as r,g as Z,E as te,_ as re,bl as t,cv as ne,l as H,p as me,q as pe,bC as Ne,Q as he,aK as Te,aC as oe,e as ve,cw as ye,cq as Re,cE as Ee}from"./index-927e7ec9.js";import{E as z,a as ie}from"./el-table-column-a210331c.js";/* empty css                    */import"./el-tag-468a4bf1.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-03facfeb.js";import"./el-scrollbar-1b1a2b97.js";import{E as Ve}from"./el-dialog-24f43e28.js";import{_ as ke}from"./DefinScrollbar-ba42e5cf.js";import{I as K,j as U,a as Q,s as k,f as be,c as Ae,E as Me}from"./common-b7c049a8.js";/* empty css                */import{E as Ie,a as xe}from"./el-form-item-666e6936.js";import{E as Ce,a as we}from"./el-select-64e6f3e8.js";/* empty css                 */import{E as Ue}from"./index-3e97453a.js";import{E as Be}from"./el-switch-33aba248.js";import"./8Array-2bfcf422.js";import"./CloneObject-a613c4b0.js";import"./index-8025977d.js";import"./isEqual-a71e5c8d.js";import"./debounce-094e6d11.js";/* empty css                                                                       */import"./index-cb90097e.js";const fe=w(!1),ge=w(!1),_=w({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1}),b=w({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1});w(!1);w({name:"",value:[1,1,1,1,1,1],editingIndex:-1});const a=w({name:"",key:"",config:{portID:0,unitID:0,canID:0,axisID:0,ratio:0,encoder:0,unitDist:0,maxRPM:0,normalvel:0,slowvel:0,neartarget:0,ontarget:0,motorDir:0,encoderDir:0,originmode:0,maxHeight:0,radius:0,isturn:0,syncFineVel:0,syncDir:0,syncVelRatioUp:0,steadyHeight:0},editingIndex:-1});w({id:-1,note:"",taskList:[],editingIndex:-1});const Je={key:0},Le=d("br",null,null,-1),je=d("br",null,null,-1),Pe=d("br",null,null,-1),He={key:1},Fe=d("br",null,null,-1),qe=d("br",null,null,-1),ze=d("br",null,null,-1),Ge={key:2},Ye=d("br",null,null,-1),Ke=d("br",null,null,-1),Qe={key:3},We=d("br",null,null,-1),Xe=d("br",null,null,-1),Ze=d("br",null,null,-1),el={key:4},ll=d("br",null,null,-1),al={__name:"IO",setup(E){const c=w("1"),L=w(!0),N=w(!1),A=w(!1),j=w(!1),s=w(!1),n=w("1"),o=w("1"),p=w("1"),I=w("1"),y=w(""),V=w(""),m=()=>{if(c.value==="2"||c.value==="3"||c.value==="5")_.value.config=[parseInt(c.value),parseInt(n.value),parseInt(o.value),parseInt(p.value),parseInt(I.value)];else if(c.value==="1")_.value.config=[parseInt(c.value),0,parseInt(n.value),parseInt(o.value),parseInt(p.value)];else if(c.value==="4"){const M=parseInt(n.value,16);y.value=isNaN(M)?"":M.toString(),_.value.config=[parseInt(c.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",_.value.config)},D=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],i=()=>{if(_.value.config.value!==void 0){if(_.value.config.value[0]===2||_.value.config.value[0]===3||_.value.config.value[0]===5)c.value=_.value.config.value[0].toString(),n.value=_.value.config.value[1].toString(),o.value=_.value.config.value[2].toString(),p.value=_.value.config.value[3].toString(),I.value=_.value.config.value[4].toString(),$();else if(_.value.config.value[0]===1)c.value=_.value.config.value[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),p.value=_.value.config.value[4].toString(),$();else if(_.value.config.value[0]===4){c.value=_.value.config.value[0].toString();const M=parseInt(_.value.config.value[3],10);V.value=isNaN(M)?"":M.toString(16),n.value=V.value.toString(),o.value=_.value.config.value[4].toString(),$()}}else if(_.value.config!==void 0){if(_.value.config[0]===2||_.value.config[0]===3||_.value.config[0]===5)c.value=_.value.config[0].toString(),n.value=_.value.config[1].toString(),o.value=_.value.config[2].toString(),p.value=_.value.config[3].toString(),I.value=_.value.config[4].toString(),$();else if(_.value.config[0]===1)c.value=_.value.config[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),p.value=_.value.config.value[4].toString(),$();else if(_.value.config[0]===4){c.value=_.value.config[0].toString();const M=parseInt(_.value.config[3],10);V.value=isNaN(M)?"":M.toString(16),n.value=V.value.toString(),o.value=_.value.config.value[4].toString(),$()}}else c.value="1",n.value="1",o.value="1",p.value="1",I.value="1",$(),console.log("putJSONelse")},$=()=>{switch(console.log("handleChange",c.value),c.value){case"1":L.value=!0,N.value=!1,A.value=!1,j.value=!1,s.value=!1,m();return;case"2":L.value=!1,N.value=!0,A.value=!1,j.value=!1,s.value=!1,m();return;case"3":L.value=!1,N.value=!1,A.value=!0,j.value=!1,s.value=!1,m();return;case"4":L.value=!1,N.value=!1,A.value=!1,j.value=!0,s.value=!1,m();return;case"5":L.value=!1,N.value=!1,A.value=!1,j.value=!1,s.value=!0,m();return}};i();let ue=0;return $e(fe,()=>{const M=Date.now();M-ue>=700&&(i(),ue=M)}),(M,f)=>{const le=Ue,g=Ce,B=we,de=te;return h(),C("div",null,[(h(),C(G,null,X(D,(v,F)=>e(le,{key:F,modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=P=>c.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),N.value?(h(),C("div",Je,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Le,r(" CAN-POS模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),je,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[3]||(f[3]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Pe,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[4]||(f[4]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),A.value?(h(),C("div",He,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[5]||(f[5]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Fe,r(" CAN-OPEN模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[6]||(f[6]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),qe,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[7]||(f[7]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),ze,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[8]||(f[8]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),L.value?(h(),C("div",Ge,[r(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":f[9]||(f[9]=v=>n.value=v),type:"number",onChange:m},null,8,["modelValue"]),Ye,r(" 输出点对应位: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[10]||(f[10]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"BIT1",value:"0"}),e(g,{label:"BIT2",value:"1"}),e(g,{label:"BIT3",value:"2"}),e(g,{label:"BIT4",value:"3"}),e(g,{label:"BIT5",value:"4"}),e(g,{label:"BIT6",value:"5"}),e(g,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),Ke,r(" 信号极性: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[11]||(f[11]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),s.value?(h(),C("div",Qe,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[12]||(f[12]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),We,r(" CAN-IO模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[13]||(f[13]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Xe,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[14]||(f[14]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Ze,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[15]||(f[15]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),j.value?(h(),C("div",el,[r(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":f[16]||(f[16]=v=>n.value=v),onChange:m},null,8,["modelValue"]),ll,r(" 信号极性: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[17]||(f[17]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const nl=E=>(me("data-v-2f6a8c35"),E=E(),pe(),E),tl=nl(()=>d("br",null,null,-1)),ul={slot:"footer",class:"dialog-footer"},ol={__name:"index",setup(E){const c=w(!1),L=()=>{_.value.name="",_.value.key="",_.value.config.value=[1,1,1,1,1,1],_.value.editingIndex=-1,console.log("addNewRow",_.value.config.value),c.value=!0,fe.value=!fe.value},N=s=>{_.value.name=K.value[s].name,_.value.key=K.value[s].key,_.value.config.value=K.value[s].config,_.value.editingIndex=s,console.log("reedit",_.value.editingIndex),c.value=!0,fe.value=!fe.value},A=()=>{if(_.value.name){if(_.value.editingIndex!==-1)K.value[_.value.editingIndex].name=_.value.name,K.value[_.value.editingIndex].key=_.value.key,_.value.config!=null&&(K.value[_.value.editingIndex].config=_.value.config),U.value.IO.input=K,console.log("handleAddRowb",_.value.config),console.log("handleAddRow",K.value[_.value.editingIndex].config);else{const{editingIndex:s,...n}=_.value,o={...n};K.value.push(JSON.parse(JSON.stringify(o))),U.value.IO.input=K,console.log("handleAddRowa",o)}c.value=!1}else ne.error("请填写完整数据")},j=s=>{K.value.splice(s,1)};return(s,n)=>{const o=H,p=z,I=ie,y=te,V=Ie,m=xe,D=Ve;return h(),C(G,null,[e(I,{data:t(K),style:{width:"100%"},class:"IOinputdata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 输入点IO"},{default:l(x=>[e(o,{type:"text",onClick:i=>N(x.$index)},{default:l(()=>[r(S(t(K)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:i=>N(x.$index)},{default:l(()=>[r(S(t(K)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"config",label:"输入点"},{default:l(x=>[d("h4",null,S(x.row.config),1)]),_:1}),e(p,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:i=>j(x.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(D,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[3]||(n[3]=x=>c.value=x),visible:c.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[tl,e(m,{ref:"form",model:t(_),"label-width":"80px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(_).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(_).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{modelValue:t(_).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(_).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"IO"},{default:l(()=>[e(al)]),_:1})]),_:1},8,["model"]),d("div",ul,[e(o,{onClick:n[2]||(n[2]=x=>c.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:A},{default:l(()=>[r("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},il=re(ol,[["__scopeId","data-v-2f6a8c35"]]),dl={key:0},sl=d("br",null,null,-1),vl=d("br",null,null,-1),rl=d("br",null,null,-1),cl={key:1},fl=d("br",null,null,-1),gl=d("br",null,null,-1),ml=d("br",null,null,-1),pl={key:2},_l=d("br",null,null,-1),bl=d("br",null,null,-1),yl={key:3},Vl=d("br",null,null,-1),hl=d("br",null,null,-1),kl=d("br",null,null,-1),Il={key:4},xl=d("br",null,null,-1),Cl={__name:"IO",setup(E){const c=w("1"),L=w(!0),N=w(!1),A=w(!1),j=w(!1),s=w(!1),n=w("1"),o=w("1"),p=w("1"),I=w("1"),y=w(""),V=w(""),m=()=>{if(c.value==="2"||c.value==="3"||c.value==="5")b.value.config=[parseInt(c.value),parseInt(n.value),parseInt(o.value),parseInt(p.value),parseInt(I.value)];else if(c.value==="1")b.value.config=[parseInt(c.value),0,parseInt(n.value),parseInt(o.value),parseInt(p.value)];else if(c.value==="4"){const M=parseInt(n.value,16);y.value=isNaN(M)?"":M.toString(),b.value.config=[parseInt(c.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",b.value.config)},D=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],i=()=>{if(b.value.config.value!==void 0){if(b.value.config.value[0]===2||b.value.config.value[0]===3||b.value.config.value[0]===5)c.value=b.value.config.value[0].toString(),n.value=b.value.config.value[1].toString(),o.value=b.value.config.value[2].toString(),p.value=b.value.config.value[3].toString(),I.value=b.value.config.value[4].toString(),$();else if(b.value.config.value[0]===1)c.value=b.value.config.value[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),p.value=b.value.config.value[4].toString(),$();else if(b.value.config.value[0]===4){c.value=b.value.config.value[0].toString();const M=parseInt(b.value.config.value[3],10);V.value=isNaN(M)?"":M.toString(16),n.value=V.value.toString(),o.value=b.value.config.value[4].toString(),$()}}else if(b.value.config!==void 0){if(b.value.config[0]===2||b.value.config[0]===3||b.value.config[0]===5)c.value=b.value.config[0].toString(),n.value=b.value.config[1].toString(),o.value=b.value.config[2].toString(),p.value=b.value.config[3].toString(),I.value=b.value.config[4].toString(),$();else if(b.value.config[0]===1)c.value=b.value.config[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),p.value=b.value.config.value[4].toString(),$();else if(b.value.config[0]===4){c.value=b.value.config[0].toString();const M=parseInt(b.value.config[3],10);V.value=isNaN(M)?"":M.toString(16),n.value=V.value.toString(),o.value=b.value.config.value[4].toString(),$()}}else c.value="1",n.value="1",o.value="1",p.value="1",I.value="1",$(),console.log("putJSONelse")},$=()=>{switch(console.log("handleChange",c.value),c.value){case"1":L.value=!0,N.value=!1,A.value=!1,j.value=!1,s.value=!1,m();return;case"2":L.value=!1,N.value=!0,A.value=!1,j.value=!1,s.value=!1,m();return;case"3":L.value=!1,N.value=!1,A.value=!0,j.value=!1,s.value=!1,m();return;case"4":L.value=!1,N.value=!1,A.value=!1,j.value=!0,s.value=!1,m();return;case"5":L.value=!1,N.value=!1,A.value=!1,j.value=!1,s.value=!0,m();return}};i();let ue=0;return $e(ge,()=>{const M=Date.now();M-ue>=700&&(i(),ue=M)}),(M,f)=>{const le=Ue,g=Ce,B=we,de=te;return h(),C("div",null,[(h(),C(G,null,X(D,(v,F)=>e(le,{key:F,modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=P=>c.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),N.value?(h(),C("div",dl,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),sl,r(" CAN-POS模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),vl,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[3]||(f[3]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),rl,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[4]||(f[4]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),A.value?(h(),C("div",cl,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[5]||(f[5]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),fl,r(" CAN-OPEN模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[6]||(f[6]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),gl,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[7]||(f[7]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),ml,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[8]||(f[8]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),L.value?(h(),C("div",pl,[r(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":f[9]||(f[9]=v=>n.value=v),type:"number",onChange:m},null,8,["modelValue"]),_l,r(" 输出点对应位: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[10]||(f[10]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"BIT1",value:"0"}),e(g,{label:"BIT2",value:"1"}),e(g,{label:"BIT3",value:"2"}),e(g,{label:"BIT4",value:"3"}),e(g,{label:"BIT5",value:"4"}),e(g,{label:"BIT6",value:"5"}),e(g,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),bl,r(" 信号极性: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[11]||(f[11]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),s.value?(h(),C("div",yl,[r(" 远程模块连接到: "),(h(),C(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":f[12]||(f[12]=P=>n.value=P),label:v.value,onChange:$},{default:l(()=>[d("pre",null,S(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Vl,r(" CAN-IO模块编号: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[13]||(f[13]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),hl,r(" 模块内输出点编号: "),e(B,{modelValue:p.value,"onUpdate:modelValue":f[14]||(f[14]=v=>p.value=v),onChange:m},{default:l(()=>[e(g,{label:"0",value:"0"}),e(g,{label:"1",value:"1"}),e(g,{label:"2",value:"2"})]),_:1},8,["modelValue"]),kl,r(" 信号极性: "),e(B,{modelValue:I.value,"onUpdate:modelValue":f[15]||(f[15]=v=>I.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),j.value?(h(),C("div",Il,[r(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":f[16]||(f[16]=v=>n.value=v),onChange:m},null,8,["modelValue"]),xl,r(" 信号极性: "),e(B,{modelValue:o.value,"onUpdate:modelValue":f[17]||(f[17]=v=>o.value=v),onChange:m},{default:l(()=>[e(g,{label:"输出高电平有效",value:"0"}),e(g,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const wl=E=>(me("data-v-0806589d"),E=E(),pe(),E),Sl=wl(()=>d("br",null,null,-1)),$l={slot:"footer",class:"dialog-footer"},Ul={__name:"index",setup(E){const c=w(!1),L=()=>{b.value.name="",b.value.key="",b.value.config.value=[1,1,1,1,1,1],b.value.editingIndex=-1,console.log("addnewoutRow",b.value.config.value),c.value=!0,ge.value=!ge.value},N=s=>{b.value.name=Q.value[s].name,b.value.key=Q.value[s].key,b.value.config.value=Q.value[s].config,b.value.editingIndex=s,console.log("reedit",b.value.config.value),c.value=!0,ge.value=!ge.value},A=()=>{if(b.value.name){if(b.value.editingIndex!==-1)Q.value[b.value.editingIndex].name=b.value.name,Q.value[b.value.editingIndex].key=b.value.key,b.value.config!=null&&(Q.value[b.value.editingIndex].config=b.value.config),U.value.IO.output=Q,console.log("handleAddRow",b.value.config),console.log("handleAddRow",Q.value[b.value.editingIndex].config);else{const{editingIndex:s,...n}=b.value,p={...{...n}};Q.value.push(JSON.parse(JSON.stringify(p))),U.value.IO.output=Q,console.log("handleAddRow",p)}c.value=!1}else ne.error("请填写完整数据")},j=s=>{Q.value.splice(s,1)};return(s,n)=>{const o=H,p=z,I=ie,y=te,V=Ie,m=xe,D=Ve;return h(),C(G,null,[e(I,{data:t(Q),style:{width:"100%"},class:"IOoutputdata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 输出点IO"},{default:l(x=>[e(o,{type:"text",onClick:i=>N(x.$index)},{default:l(()=>[r(S(t(Q)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:i=>N(x.$index)},{default:l(()=>[r(S(t(Q)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"config",label:"输出点"},{default:l(x=>[d("h4",null,S(x.row.config),1)]),_:1}),e(p,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:i=>j(x.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(D,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[3]||(n[3]=x=>c.value=x),visible:c.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[Sl,e(m,{ref:"form",model:t(b),"label-width":"80px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(b).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(b).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{modelValue:t(b).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(b).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"IO"},{default:l(()=>[e(Cl)]),_:1})]),_:1},8,["model"]),d("div",$l,[e(o,{onClick:n[2]||(n[2]=x=>c.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:A},{default:l(()=>[r("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},Dl=re(Ul,[["__scopeId","data-v-0806589d"]]);const De=E=>(me("data-v-7cb2a2de"),E=E(),pe(),E),Ol=De(()=>d("br",null,null,-1)),Nl={style:{"margin-top":"2%","margin-left":"75%"}},Tl=De(()=>d("br",null,null,-1)),Rl={__name:"index",setup(E){const c=w(!1),L=()=>{a.value.name="",a.value.key="",a.value.config.portID=0,a.value.config.unitID=0,a.value.config.canID=0,a.value.config.axisID=0,a.value.config.ratio=0,a.value.config.encoder=0,a.value.config.unitDist=0,a.value.config.maxRPM=0,a.value.config.normalvel=0,a.value.config.slowvel=0,a.value.config.neartarget=0,a.value.config.ontarget=0,a.value.config.motorDir=0,a.value.config.encoderDir=0,a.value.config.originmode=0,a.value.config.maxHeight=0,a.value.config.isturn=0,a.value.config.syncFineVel=0,a.value.config.syncDir=0,a.value.config.syncVelRatioUp=0,a.value.config.steadyHeight=0,a.value.config.radius=0,a.value.editingIndex=-1,c.value=!0},N=s=>{a.value.name=k.value[s].name,a.value.key=k.value[s].key,a.value.config.portID=k.value[s].config.portID,a.value.config.unitID=k.value[s].config.unitID,a.value.config.canID=k.value[s].config.canID,a.value.config.axisID=k.value[s].config.axisID,a.value.config.ratio=k.value[s].config.ratio,a.value.config.encoder=k.value[s].config.encoder,a.value.config.unitDist=k.value[s].config.unitDist,a.value.config.maxRPM=k.value[s].config.maxRPM,a.value.config.normalvel=k.value[s].config.normalvel,a.value.config.slowvel=k.value[s].config.slowvel,a.value.config.neartarget=k.value[s].config.neartarget,a.value.config.ontarget=k.value[s].config.ontarget,a.value.config.motorDir=k.value[s].config.motorDir,a.value.config.encoderDir=k.value[s].config.encoderDir,a.value.config.originmode=k.value[s].config.originmode,a.value.config.maxHeight=k.value[s].config.maxHeight,a.value.config.isturn=k.value[s].config.isturn,a.value.config.syncFineVel=k.value[s].config.syncFineVel,a.value.config.syncDir=k.value[s].config.syncDir,a.value.config.syncVelRatioUp=k.value[s].config.syncVelRatioUp,a.value.config.steadyHeight=k.value[s].config.steadyHeight,a.value.config.radius=k.value[s].config.radius,a.value.editingIndex=s,c.value=!0},A=()=>{if(a.value.name){if(a.value.editingIndex!==-1)k.value[a.value.editingIndex].name=a.value.name,k.value[a.value.editingIndex].key=a.value.key,k.value[a.value.editingIndex].config.portID=a.value.config.portID,k.value[a.value.editingIndex].config.unitID=a.value.config.unitID,k.value[a.value.editingIndex].config.canID=a.value.config.canID,k.value[a.value.editingIndex].config.axisID=a.value.config.axisID,k.value[a.value.editingIndex].config.ratio=a.value.config.ratio,k.value[a.value.editingIndex].config.encoder=a.value.config.encoder,k.value[a.value.editingIndex].config.unitDist=a.value.config.unitDist,k.value[a.value.editingIndex].config.maxRPM=a.value.config.maxRPM,k.value[a.value.editingIndex].config.normalvel=a.value.config.normalvel,k.value[a.value.editingIndex].config.slowvel=a.value.config.slowvel,k.value[a.value.editingIndex].config.neartarget=a.value.config.neartarget,k.value[a.value.editingIndex].config.ontarget=a.value.config.ontarget,k.value[a.value.editingIndex].config.motorDir=a.value.config.motorDir,k.value[a.value.editingIndex].config.encoderDir=a.value.config.encoderDir,k.value[a.value.editingIndex].config.originmode=a.value.config.originmode,k.value[a.value.editingIndex].config.maxHeight=a.value.config.maxHeight,k.value[a.value.editingIndex].config.isturn=a.value.config.isturn,k.value[a.value.editingIndex].config.syncFineVel=a.value.config.syncFineVel,k.value[a.value.editingIndex].config.syncDir=a.value.config.syncDir,k.value[a.value.editingIndex].config.syncVelRatioUp=a.value.config.syncVelRatioUp,k.value[a.value.editingIndex].config.steadyHeight=a.value.config.steadyHeight,k.value[a.value.editingIndex].config.radius=a.value.config.radius,U.value.servo.kinco=k;else{const{editingIndex:s,...n}=a.value,p={...{...n}};k.value.push(JSON.parse(JSON.stringify(p))),U.value.servo.kinco=k,console.log("handleAddRow",p)}c.value=!1}else ne.error("请填写完整数据")},j=s=>{k.value.splice(s,1)};return(s,n)=>{const o=H,p=z,I=ie,y=te,V=Ie,m=Be,D=xe,x=Ve;return h(),C(G,null,[e(I,{data:t(k),style:{width:"100%"},class:"servodata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 上装伺服"},{default:l(i=>[e(o,{type:"text",onClick:$=>N(i.$index)},{default:l(()=>[r(S(t(k)[i.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(i=>[e(o,{type:"text",onClick:$=>N(i.$index)},{default:l(()=>[r(S(t(k)[i.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{label:"CAN口号"},{default:l(i=>[r(S(i.row.config.portID),1)]),_:1}),e(p,{label:"单元号"},{default:l(i=>[r(S(i.row.config.unitID),1)]),_:1}),e(p,{label:"模块内对应编号"},{default:l(i=>[r(S(i.row.config.canID),1)]),_:1}),e(p,{label:"原点模式"},{default:l(i=>[d("h4",null,S(i.row.config.originmode===1?"是":"否"),1)]),_:1}),e(p,{label:"是否有转盘"},{default:l(i=>[d("h4",null,S(i.row.config.isturn===1?"是":"否"),1)]),_:1}),e(p,{label:"操作"},{default:l(i=>[e(o,{type:"danger",onClick:$=>j(i.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(x,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[25]||(n[25]=i=>c.value=i),visible:c.value,width:"900px","close-on-click-modal":!1,"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[Ol,e(D,{ref:"form",model:t(a),"label-width":"180px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).key,"onUpdate:modelValue":n[0]||(n[0]=i=>t(a).key=i),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).name,"onUpdate:modelValue":n[1]||(n[1]=i=>t(a).name=i),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"CAN-ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.portID,"onUpdate:modelValue":n[2]||(n[2]=i=>t(a).config.portID=i),modelModifiers:{number:!0},placeholder:"can口号"},null,8,["modelValue"])]),_:1}),e(V,{label:"CAN单元号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitID,"onUpdate:modelValue":n[3]||(n[3]=i=>t(a).config.unitID=i),modelModifiers:{number:!0},placeholder:"单元号"},null,8,["modelValue"])]),_:1}),e(V,{label:"模块内对应点编号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.canID,"onUpdate:modelValue":n[4]||(n[4]=i=>t(a).config.canID=i),modelModifiers:{number:!0},placeholder:"模块内对应点编号"},null,8,["modelValue"])]),_:1}),e(V,{label:"轴ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.axisID,"onUpdate:modelValue":n[5]||(n[5]=i=>t(a).config.axisID=i),modelModifiers:{number:!0},placeholder:"轴ID"},null,8,["modelValue"])]),_:1}),e(V,{label:"减速比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ratio,"onUpdate:modelValue":n[6]||(n[6]=i=>t(a).config.ratio=i),modelModifiers:{number:!0},placeholder:"减速比"},null,8,["modelValue"])]),_:1}),e(V,{label:"编码器绝对值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoder,"onUpdate:modelValue":n[7]||(n[7]=i=>t(a).config.encoder=i),modelModifiers:{number:!0},placeholder:"编码器绝对值"},null,8,["modelValue"])]),_:1}),e(V,{label:"伺服行程转换比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitDist,"onUpdate:modelValue":n[8]||(n[8]=i=>t(a).config.unitDist=i),modelModifiers:{number:!0},placeholder:"伺服行程转换比"},null,8,["modelValue"])]),_:1}),e(V,{label:"最大转速"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxRPM,"onUpdate:modelValue":n[9]||(n[9]=i=>t(a).config.maxRPM=i),modelModifiers:{number:!0},placeholder:"最大转速"},null,8,["modelValue"])]),_:1}),e(V,{label:"正常速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.normalvel,"onUpdate:modelValue":n[10]||(n[10]=i=>t(a).config.normalvel=i),modelModifiers:{number:!0},placeholder:"正常速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"减速速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.slowvel,"onUpdate:modelValue":n[11]||(n[11]=i=>t(a).config.slowvel=i),modelModifiers:{number:!0},placeholder:"减速速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"切换速度的临界距离"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.neartarget,"onUpdate:modelValue":n[12]||(n[12]=i=>t(a).config.neartarget=i),modelModifiers:{number:!0},placeholder:"切换速度的临界距离"},null,8,["modelValue"])]),_:1}),e(V,{label:"允许误差"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ontarget,"onUpdate:modelValue":n[13]||(n[13]=i=>t(a).config.ontarget=i),modelModifiers:{number:!0},placeholder:"允许误差"},null,8,["modelValue"])]),_:1}),e(V,{label:"电机方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.motorDir,"onUpdate:modelValue":n[14]||(n[14]=i=>t(a).config.motorDir=i),modelModifiers:{number:!0},placeholder:"电机方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"码盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoderDir,"onUpdate:modelValue":n[15]||(n[15]=i=>t(a).config.encoderDir=i),modelModifiers:{number:!0},placeholder:"码盘方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"原点模式"},{default:l(()=>[e(m,{style:{width:"80%"},modelValue:t(a).config.originmode,"onUpdate:modelValue":n[16]||(n[16]=i=>t(a).config.originmode=i),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(V,{label:"最大行程"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxHeight,"onUpdate:modelValue":n[17]||(n[17]=i=>t(a).config.maxHeight=i),modelModifiers:{number:!0},placeholder:"最大行程"},null,8,["modelValue"])]),_:1}),e(V,{label:"凸轮半径"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.radius,"onUpdate:modelValue":n[18]||(n[18]=i=>t(a).config.radius=i),modelModifiers:{number:!0},placeholder:"凸轮半径"},null,8,["modelValue"])]),_:1}),e(V,{label:"是否是转盘"},{default:l(()=>[e(m,{style:{width:"80%"},modelValue:t(a).config.isturn,"onUpdate:modelValue":n[19]||(n[19]=i=>t(a).config.isturn=i),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(V,{label:"转盘速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncFineVel,"onUpdate:modelValue":n[20]||(n[20]=i=>t(a).config.syncFineVel=i),modelModifiers:{number:!0},placeholder:"转盘速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"转盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncDir,"onUpdate:modelValue":n[21]||(n[21]=i=>t(a).config.syncDir=i),modelModifiers:{number:!0},placeholder:"转盘方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"syncVelRatioUp"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncVelRatioUp,"onUpdate:modelValue":n[22]||(n[22]=i=>t(a).config.syncVelRatioUp=i),modelModifiers:{number:!0},placeholder:"syncVelRatioUp"},null,8,["modelValue"])]),_:1}),e(V,{label:"复位初始值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.steadyHeight,"onUpdate:modelValue":n[23]||(n[23]=i=>t(a).config.steadyHeight=i),modelModifiers:{number:!0},placeholder:"复位初始值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),d("div",Nl,[e(o,{onClick:n[24]||(n[24]=i=>c.value=!1)},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:A},{default:l(()=>[r("确定")]),_:1})]),Tl]),_:1})]),_:1},8,["modelValue","visible"])],64)}}},El=re(Rl,[["__scopeId","data-v-7cb2a2de"]]);const ae=E=>(me("data-v-778eca25"),E=E(),pe(),E),Al={key:0,class:"error-details"},Ml={class:"error-item"},Bl=ae(()=>d("strong",null,"异常名称:",-1)),Jl={key:0},Ll={key:1},jl={class:"error-item"},Pl=ae(()=>d("strong",null,"异常结果:",-1)),Hl={key:0},Fl={key:1},ql={class:"error-item"},zl=ae(()=>d("strong",null,"需要执行的接口名称:",-1)),Gl={key:0},Yl={key:1},Kl={class:"error-item"},Ql=ae(()=>d("strong",null,"类型:",-1)),Wl={key:0},Xl={key:1},Zl={class:"error-item"},ea=ae(()=>d("strong",null,"值:",-1)),la={key:0},aa={key:1},na={class:"error-item"},ta=ae(()=>d("strong",null,"输入的字符串参数:",-1)),ua={key:0},oa={key:1},ia={class:"error-item"},da=ae(()=>d("strong",null,"错误码:",-1)),sa={key:0},va={key:1},ra={class:"error-item"},ca=ae(()=>d("strong",null,"错误信息:",-1)),fa={key:0},ga={key:1},ma={style:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},pa=ae(()=>d("span",null,"任务步骤",-1)),_a={key:0},ba={style:{"font-size":"16px","font-style":"oblique","margin-right":"10px"}},ya={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},Va=ae(()=>d("br",null,null,-1)),ha={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},ka=ae(()=>d("br",null,null,-1)),Ia={__name:"task",setup(E){const c=w([{label:"重复执行",value:0},{label:"正常",value:1},{label:"异常",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}]);Ne(()=>{let u="";be.value=Ae.value.split(`
`).reduce((J,Y)=>{if(Y.trim().startsWith("function")){const ee=Y.split("(")[0].split(" ")[1];u||(u=ee),J.push({name:u,key:ee}),u=Y}else u=Y;return J},[])});const L=u=>{const J=be.value.find(Y=>Y.key===u);return J?J.name:u},N=w("");function A(){U.value.Task.push({note:"",id:0,taskList:[]})}const j=()=>{U.value.Task.forEach(u=>{const J=u.id;clearInterval(s.green[J]),delete s.green[J],n.value.green[J]=!1,clearInterval(s.red[J]),delete s.red[J],n.value.red[J]=!1,o.value[J]=null})};w(0);let s={green:{},red:{}};const n=w({green:{},red:{}}),o=w({}),p=he(()=>U.value.Task.find(u=>u.id===O.value.curTaskID)),I=()=>{if(p.value){const u=p.value;if(o.value[u.id]==="green")return;clearInterval(s.red[u.id]),delete s.red[u.id],n.value.red[u.id]=!1,n.value.green[u.id]=!0,o.value[u.id]="green",s.green[u.id]||(s.green[u.id]=setInterval(()=>{n.value.green[u.id]=!n.value.green[u.id]},500))}},y=()=>{if(p.value){const u=p.value;if(o.value[u.id]==="red")return;clearInterval(s.green[u.id]),delete s.green[u.id],n.value.green[u.id]=!1,n.value.red[u.id]=!0,o.value[u.id]="red",s.red[u.id]||(s.red[u.id]=setInterval(()=>{n.value.red[u.id]=!n.value.red[u.id]},500))}},V=()=>{if(p.value){const u=p.value;clearInterval(s.green[u.id]),delete s.green[u.id],n.value.green[u.id]=!1,clearInterval(s.red[u.id]),delete s.red[u.id],n.value.red[u.id]=!1,o.value[u.id]=null}};w("");let m={green:{},red:{}};const D=w({green:{},red:{}}),x=w({}),i=he(()=>U.value.Task.flatMap(u=>u.taskList).find(u=>u.main===O.value.subTaskStatus.main_name)),$=()=>{if(i.value){const u=i.value;if(console.log("2222",x.value[u.main]),x.value[u.main]==="green")return;clearInterval(m.red[u.main]),delete m.red[u.main],D.value.red[u.main]=!1,D.value.green[u.main]=!0,x.value[u.main]="green",m.green[u.main]||(m.green[u.main]=setInterval(()=>{D.value.green[u.main]=!D.value.green[u.main]},500))}},ue=()=>{if(i.value){const u=i.value;if(x.value[u.main]==="red")return;clearInterval(m.green[u.main]),delete m.green[u.main],D.value.green[u.main]=!1,D.value.red[u.main]=!0,x.value[u.main]="red",m.red[u.main]||(m.red[u.main]=setInterval(()=>{D.value.red[u.main]=!D.value.red[u.main]},500))}},M=()=>{if(i.value){const u=i.value;clearInterval(m.green[u.main]),delete m.green[u.main],D.value.green[u.main]=!1,clearInterval(m.red[u.main]),delete m.red[u.main],D.value.red[u.main]=!1,x.value[u.main]=null}};function f(u){const J=U.value.Task.indexOf(u);J>-1&&U.value.Task.splice(J,1)}function le(u){u.taskList.push({main:"",exceptions:[""],jump:[{}]})}function g(u,J){const Y=u.taskList.indexOf(J);Y>-1&&u.taskList.splice(Y,1)}function B(u){u.exceptions||(u.exceptions=[]),u.exceptions.push(N.value),N.value=""}function de(u,J){u.exceptions.splice(J,1)}function v(u){u.jump||(u.jump=[]),u.jump.push({})}function F(u,J){u.jump.splice(J,1)}const P=w(new Set);function ce(u){return P.value.has(u)}function Oe(u){P.value.has(u)?P.value.delete(u):P.value.add(u)}const O=w(null),Se=()=>{ye({method:"post",url:"/api/data/analysis",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(J=>{O.value=J.data,console.log("111111",O.value);const Y=O.value.curTaskID,ee=O.value.taskStatus;ee===0?V():ee===1?I():(ee===2||ee===3)&&y(),Y===0&&j();const T=O.value.subTaskStatus.main_result;O.value.subTaskStatus.exception_result===1?ue():T===0?$():M()}).catch(J=>{}).finally(()=>{}),Re.value=setTimeout(Se,500)};return Te(()=>{Se()}),(u,J)=>{const Y=Ce,ee=we;return h(),C("div",null,[e(t(ie),{data:t(U).Task,style:{width:"100%"},class:"jsondatatask"},{default:l(()=>[e(t(z),{label:"⚠️ 任务列表",width:"200"},{default:l(({row:T})=>[d("div",{class:oe(ce(T)?"zhedie":"zhankai")},[d("div",{class:oe([{"highlight-green":n.value.green[T.id],"highlight-red":n.value.red[T.id]},"data-item"])},[e(t(H),{onClick:R=>Oe(T),type:"info"},{default:l(()=>[r(S(ce(T)?"折叠":"展开"),1)]),_:2},1032,["onClick"]),e(t(H),{type:"danger",onClick:R=>f(T)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"]),e(t(te),{style:{"margin-top":"3%"},modelValue:T.note,"onUpdate:modelValue":R=>T.note=R,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"]),ce(T)&&O.value&&O.value.curTaskID===T.id?(h(),C("div",Al,[d("div",Ml,[Bl,O.value.subTaskStatus.exception_name!==void 0?(h(),C("span",Jl,S(L(O.value.subTaskStatus.exception_name)),1)):(h(),C("span",Ll,"null"))]),d("div",jl,[Pl,O.value.subTaskStatus.exception_result!==void 0?(h(),C("span",Hl,S(O.value.subTaskStatus.exception_result===0?"无异常":"有异常"),1)):(h(),C("span",Fl,"null"))]),d("div",ql,[zl,O.value.subTaskStatus.sentence.name!==void 0?(h(),C("span",Gl,S(O.value.subTaskStatus.sentence.name),1)):(h(),C("span",Yl,"null"))]),d("div",Kl,[Ql,O.value.subTaskStatus.sentence.data.type!==void 0?(h(),C("span",Wl,S(O.value.subTaskStatus.sentence.data.type===0?"布尔值":O.value.subTaskStatus.sentence.data.type===1?"整数":O.value.subTaskStatus.sentence.data.type===2?"双精度":"未知类型"),1)):(h(),C("span",Xl,"null"))]),d("div",Zl,[ea,O.value.subTaskStatus.sentence.data.value!==void 0?(h(),C("span",la,S(O.value.subTaskStatus.sentence.data.value),1)):(h(),C("span",aa,"null"))]),d("div",na,[ta,O.value.subTaskStatus.sentence.param.value!==void 0?(h(),C("span",ua,S(O.value.subTaskStatus.sentence.param.value),1)):(h(),C("span",oa,"null"))]),d("div",ia,[da,O.value.curTaskError.errorCode!==void 0?(h(),C("span",sa,S(O.value.curTaskError.errorCode===0?"无故障":O.value.curTaskError.errorCode===1?"超时故障":O.value.curTaskError.errorCode===2?"异常故障":O.value.curTaskError.errorCode===3?"内部故障":"未知错误"),1)):(h(),C("span",va,"null"))]),d("div",ra,[ca,O.value.curTaskError.errorMessage!==void 0?(h(),C("span",fa,S(O.value.curTaskError.errorMessage),1)):(h(),C("span",ga,"null"))])])):Z("",!0)],2)],2)]),_:1}),e(t(z),{label:"任务 ID",width:"100"},{default:l(({row:T})=>[d("div",{class:oe(ce(T)?"zhedie":"zhankai")},[d("div",{class:oe([{"highlight-green":n.value.green[T.id],"highlight-red":n.value.red[T.id]},"data-item"])},[e(t(te),{modelValue:T.id,"onUpdate:modelValue":R=>T.id=R,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])],2)],2)]),_:1}),e(t(z),{label:"任务步骤"},{header:l(()=>[d("div",ma,[pa,e(t(H),{type:"primary",onClick:A},{default:l(()=>[r("添加任务")]),_:1})])]),default:l(({row:T})=>[d("div",{class:oe([{"highlight-green":n.value.green[T.id],"highlight-red":n.value.red[T.id]},"data-item"])},[ce(T)?(h(),C("div",_a,[d("div",null,[e(t(H),{type:"primary",onClick:R=>le(T)},{default:l(()=>[r("添加动作")]),_:2},1032,["onClick"])]),e(t(ie),{data:T.taskList,style:{width:"100%"}},{default:l(()=>[e(t(z),{label:"动作"},{default:l(({row:R})=>[d("div",{class:oe([{"highlight-green":D.value.green[R.main],"highlight-red":D.value.red[R.main]},"data-item"])},[d("span",ba,"第"+S(T.taskList.indexOf(R)+1)+"步",1),e(t(H),{type:"danger",onClick:W=>g(T,R)},{default:l(()=>[r("删除动作")]),_:2},1032,["onClick"]),e(ee,{modelValue:R.main,"onUpdate:modelValue":W=>R.main=W,placeholder:"选择动作"},{default:l(()=>[(h(!0),C(G,null,X(t(be),W=>(h(),ve(Y,{key:W,label:W.name,value:W.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2)]),_:2},1024),e(t(z),{label:"动作异常"},{default:l(({row:R})=>[d("div",{class:oe([{"highlight-green":D.value.green[R.main],"highlight-red":D.value.red[R.main]},"data-item"])},[d("ul",null,[(h(!0),C(G,null,X(R.exceptions,(W,se)=>(h(),C("li",{key:`exception-${se}`},[d("div",ya,[e(ee,{modelValue:R.exceptions[se],"onUpdate:modelValue":q=>R.exceptions[se]=q,placeholder:"动作中检测异常"},{default:l(()=>[(h(!0),C(G,null,X(t(be),q=>(h(),ve(Y,{key:q,label:q.name,value:q.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),r("   "),e(t(H),{type:"danger",onClick:q=>de(R,se)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])])]))),128)),Va,e(t(H),{type:"primary",onClick:W=>B(R)},{default:l(()=>[r("添加异常")]),_:2},1032,["onClick"])])],2)]),_:1}),e(t(z),{label:"执行结果和跳转"},{default:l(({row:R})=>[d("div",{class:oe([{"highlight-green":D.value.green[R.main],"highlight-red":D.value.red[R.main]},"data-item"])},[(h(!0),C(G,null,X(R.jump,(W,se)=>(h(),C("div",{key:`jump-${se}`},[d("div",ha,[e(ee,{modelValue:W.condition,"onUpdate:modelValue":q=>W.condition=q,placeholder:"执行结果"},{default:l(()=>[(h(!0),C(G,null,X(c.value,q=>(h(),ve(Y,{label:q.label,value:q.value},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(ee,{modelValue:W.index,"onUpdate:modelValue":q=>W.index=q,placeholder:"跳转索引"},{default:l(()=>[(h(!0),C(G,null,X(T.taskList,q=>(h(),ve(Y,{label:"第 "+(T.taskList.indexOf(q)+1)+" 步",value:T.taskList.indexOf(q)+1},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),r("   "),e(t(H),{type:"danger",onClick:q=>F(R,se)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])])]))),128)),ka,e(t(H),{type:"primary",onClick:W=>v(R)},{default:l(()=>[r("添加跳转")]),_:2},1032,["onClick"])],2)]),_:2},1024)]),_:2},1032,["data"])])):Z("",!0)],2)]),_:1})]),_:1},8,["data"])])}}},xa=re(Ia,[["__scopeId","data-v-778eca25"]]);const Ca={__name:"index",setup(E){const c=w(new Set),L=()=>{Ee.prompt("请输入设备名","添加设备",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[^\u4e00-\u9fa5]+$/,inputErrorMessage:"不能包含中文"}).then(({value:o})=>{U.value.device||(U.value.device={}),U.value.device[o]=[]}).catch(()=>{ne({message:"已取消添加设备",type:"info"})})},N=o=>{c.value.has(o)?c.value.delete(o):c.value.add(o)},A=o=>c.value.has(o),j=o=>{delete U.value.device[o]},s=o=>{o.push({key:"",value:""})},n=(o,p)=>{const I=o.indexOf(p);I!==-1&&o.splice(I,1)};return(o,p)=>(h(),ve(t(ie),{data:Object.entries(t(U).device),style:{width:"100%"}},{default:l(()=>[e(t(z),{label:"⚠️ 设备",width:"200"},{default:l(I=>[e(t(H),{onClick:y=>N(I.row[0]),type:"info"},{default:l(()=>[r(S(A(I.row[0])?"展开":"折叠"),1)]),_:2},1032,["onClick"]),e(t(H),{onClick:y=>j(I.row[0]),type:"danger",style:{"margin-left":"10px"}},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1}),e(t(z),{label:"设备名",width:"200"},{default:l(I=>[d("span",null,S(I.row[0]),1)]),_:1}),e(t(z),{label:"对象",width:"500"},{default:l(I=>[A(I.row[0])?Z("",!0):(h(),ve(t(ie),{key:0,data:I.row[1],style:{width:"100%"}},{default:l(()=>[e(t(z),{prop:"key",label:"名称",width:"200"},{default:l(y=>[e(t(te),{modelValue:y.row.key,"onUpdate:modelValue":V=>y.row.key=V,placeholder:"输入名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(z),{prop:"value",label:"值",width:"200"},{default:l(y=>[e(t(te),{modelValue:y.row.value,"onUpdate:modelValue":V=>y.row.value=V,placeholder:"输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(z),{label:"",width:"100"},{header:l(()=>[A(I.row[0])?Z("",!0):(h(),ve(t(H),{key:0,onClick:y=>s(I.row[1]),type:"text",style:{"margin-top":"10px"}},{default:l(()=>[r("添加数据")]),_:2},1032,["onClick"]))]),default:l(y=>[e(t(H),{onClick:V=>n(I.row[1],y.row),type:"danger"},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"]))]),_:1}),e(t(z),{width:"200"},{header:l(()=>[e(t(H),{onClick:L,type:"primary",style:{"margin-top":"20px"}},{default:l(()=>[r("添加设备")]),_:1})]),_:1})]),_:1},8,["data"]))}},wa=re(Ca,[["__scopeId","data-v-a82b39d4"]]);const _e=E=>(me("data-v-0c4c326a"),E=E(),pe(),E),Sa={class:"page-container main-view"},$a={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},Ua={class:"left"},Da=_e(()=>d("hr",{class:"hengxian"},null,-1)),Oa=_e(()=>d("hr",{class:"hengxian3"},null,-1)),Na=_e(()=>d("hr",{class:"hengxian3"},null,-1)),Ta=_e(()=>d("hr",{class:"hengxian3"},null,-1)),Ra=_e(()=>d("hr",{class:"hengxian3"},null,-1)),Ea={__name:"index",setup(E){const c=w(!1),L=he(()=>JSON.stringify(U.value,null,2)),N=()=>{c.value=!0},A=()=>{let I={data:{file:"equipment.json",value:U.value},group:"siasun",account:"test",password:"123456"};console.log(I),ye({method:"post",url:"/api/ctrl/jsoneditor",data:JSON.stringify(I)}).then(y=>{ne.success("请求成功");var V={type:"syncParm",data:!0};console.log(JSON.stringify(V)),ye({method:"post",url:"/api/ctrl/manualdata",data:JSON.stringify(V)}).then(m=>{ne.success("同步参数")}).catch(m=>{}).finally(()=>{})}).catch(y=>{ne.error("请求失败")}).finally(()=>{})},j=w(null),s=()=>{ye({method:"post",url:"/api/data/jsoneditor",data:JSON.stringify({data:"equipment.json",group:"siasun",account:"test",password:"123456"})}).then(y=>{ne.success("请求成功"),j.value=y.data,U.value=y.data,p()}).catch(y=>{ne.error("请求失败")}).finally(()=>{})},n=()=>{const I=JSON.stringify(U.value),y=new Blob([I],{type:"application/json"}),V=window.URL.createObjectURL(y),m=document.createElement("a");m.href=V,m.download="equipment.json",document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(V),document.body.removeChild(m)},o=I=>{const y=I.target.files[0],V=new FileReader;V.onload=m=>{const D=JSON.parse(m.target.result);U.value=D,p()},V.readAsText(y),ne.success("导入成功")},p=()=>{U.value.IO!==void 0&&(U.value.IO.input!==void 0&&(K.value=U.value.IO.input),U.value.IO.output!==void 0&&(Q.value=U.value.IO.output)),U.value.servo.kinco!==void 0&&U.value.servo!==void 0&&(k.value=U.value.servo.kinco)};return(I,y)=>{const V=H,m=Ve,D=z,x=te,i=ie;return h(),C("div",null,[d("div",Sa,[d("div",$a,[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[d("div",Ua,[e(V,{type:"info",onClick:N},{default:l(()=>[r(" 查看 ")]),_:1}),e(m,{modelValue:c.value,"onUpdate:modelValue":y[0]||(y[0]=$=>c.value=$),title:"数据",visible:c.value,onClose:y[1]||(y[1]=$=>c.value=!1),"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[d("pre",null,S(L.value),1)]),_:1})]),_:1},8,["modelValue","visible"]),r("   "),e(V,{type:"primary",onClick:s},{default:l(()=>[r(" 从AGV同步参数 ")]),_:1}),e(V,{type:"primary",onClick:A},{default:l(()=>[r("同步到AGV")]),_:1}),r("   "),d("input",{ref:"importInput",type:"file",accept:".json",style:{display:"none"},onChange:o},null,544),e(V,{onClick:y[2]||(y[2]=$=>I.$refs.importInput.click()),type:"success"},{default:l(()=>[r(" 本地导入 ")]),_:1}),e(V,{type:"success",onClick:n},{default:l(()=>[r("导出到本地")]),_:1})]),Da,e(i,{data:t(Me),style:{width:"100%"},class:"EQUversion"},{default:l(()=>[e(D,{prop:"name",label:"⚠️ 版本"}),e(D,{prop:"value"},{default:l($=>[e(x,{modelValue:t(U).version,"onUpdate:modelValue":y[3]||(y[3]=ue=>t(U).version=ue),placeholder:"请选择",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"]),Oa,e(il),e(Dl),Na,e(El),Ta,e(xa),Ra,e(wa)]),_:1})])])])}}},un=re(Ea,[["__scopeId","data-v-0c4c326a"]]);export{un as default};

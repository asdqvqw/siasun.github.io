import{_ as z,aV as m,aK as P,o as U,c as J,a as p,b as h,bl as x,m as g,bc as E,f as K,ck as R,l as X,E as Y,cq as F,b$ as G,cm as H,p as Q,q as W}from"./index-02639357.js";import{g as tt,i as et}from"./index-c13506ae.js";import{c as at}from"./timer-486d2b06.js";const D=_=>(Q("data-v-caf4340b"),_=_(),W(),_),ot={class:"page-container main-view"},nt={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},st=D(()=>p("h2",{style:{"margin-top":"1%","margin-left":"1%"}},"统计分析",-1)),it=D(()=>p("div",{class:"hengxian"},null,-1)),lt={class:"box"},ct=D(()=>p("br",null,null,-1)),rt=D(()=>p("div",{class:"box2"},[p("div",{id:"chart-container"})],-1)),dt={__name:"index",setup(_){let V=m(""),d=0,u=null;const M=m(""),Z=m("");let f=m([]);const b=m(0),w=m(100),$=()=>{d>0&&(d--,I())},A=()=>{d<f.value[0].StatisticsData.length-1&&(d++,I())},N=()=>{const c=tt(document.getElementById("chart-container")),n=Math.max(0,Math.min(b.value,100)),e=Math.max(0,Math.min(w.value,100)),l={dataZoom:[{show:!1,type:"slider",start:n,end:e}]};c.setOption(l)},I=()=>{u&&u.dispose();const c=document.getElementById("chart-container");u=et(c);const n=new Date(M.value),e=new Date(Z.value);V.value=f.value[0].StatisticsData[d].name,n&&e&&!isNaN(n.getTime())&&isNaN(e.getTime());let l;l=f.value;const t=l.map(a=>a.logDateTime),s=[];for(let a=0;a<l.length;a++){const r=l[a].StatisticsData[d].value.map(o=>o.value);for(let o=0;o<r.length;o++)s[o]||(s[o]=[]),s[o].push(r[o])}const i={xAxis:{type:"category",data:t},yAxis:{type:"value"},series:s.map((a,r)=>({type:"line",name:l[0].StatisticsData[d].value[r].name,data:a})),tooltip:{trigger:"axis",formatter:a=>{let r=`时间: ${a[0].name}<br/>`;for(let o=0;o<a.length;o++){const{seriesName:y,value:S}=a[o];r+=`${y}: ${S}<br/>`}return r}},dataZoom:[{show:!1,type:"slider"}]};u.on("dataZoom",({start:a,end:r})=>{const o=Math.round(a*(t.length-1)),y=Math.round(r*(t.length-1)),S=t.slice(o,y+1),L=s.map(B=>B.slice(o,y+1));u.setOption({xAxis:{data:S},series:s.map((B,q)=>({data:L[q]}))})}),u.setOption(i),u.setOption({toolbox:{show:!0,feature:{saveAsImage:{name:"chartInstance",title:"保存图表",pixelRatio:2},magicType:{type:["bar","line","stack","tiled"]}}}})},v=m(!1),O=()=>{v.value=!v.value},j=()=>{let c;c=f.value;const n=c.map(t=>t.logDateTime),e=[];for(let t=0;t<c.length;t++){const s=c[t].StatisticsData[d].value.map(i=>i.value);for(let i=0;i<s.length;i++)e[i]||(e[i]=[]),e[i].push(s[i])}const l={xAxis:{type:"category",data:n},yAxis:{type:"value"},series:e.map((t,s)=>({type:"line",name:c[0].StatisticsData[d].value[s].name,data:t})),tooltip:{trigger:"axis",formatter:t=>{let s=`时间: ${t[0].name}<br/>`;for(let i=0;i<t.length;i++){const{seriesName:a,value:r}=t[i];s+=`${a}: ${r}<br/>`}return s}},dataZoom:[{show:!1,type:"slider"}]};u.setOption(l)};let T=0;const k=m(null),C=()=>{R({method:"post",url:"/api/data/statistics",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(n=>{k.value=n.data;const e=new Date;f.value.push({logDateTime:e.toLocaleString(),StatisticsData:k.value}),T===0?(I(),T=1):v.value||j()}).catch(n=>{}).finally(()=>{}),at.value=setTimeout(C,500)};return P(()=>{C()}),(c,n)=>{const e=X,l=Y;return U(),J("div",ot,[p("div",nt,[st,it,p("div",lt,[h(e,{onClick:$,type:"info",style:{width:"10%","margin-left":"1%"},icon:x(F)},null,8,["icon"]),g("  "+E("🎈"+x(V))+" ",1),h(e,{onClick:A,type:"info",style:{width:"10%","margin-left":"1%"},icon:x(G)},null,8,["icon"]),g("     范围：    "),h(l,{type:"number",modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=t=>b.value=t),onInput:N,min:0,style:{width:"10%"}},null,8,["modelValue"]),g("    一   "),h(l,{type:"number",modelValue:w.value,"onUpdate:modelValue":n[1]||(n[1]=t=>w.value=t),onInput:N,max:100,style:{width:"10%"}},null,8,["modelValue"]),g("     "),h(e,{onClick:O,type:"info",style:{width:"15%"},icon:x(H)},{default:K(()=>[g(E(v.value?"继续":"暂停"),1)]),_:1},8,["icon"])]),ct,rt])])}}},ft=z(dt,[["__scopeId","data-v-caf4340b"]]);export{ft as default};

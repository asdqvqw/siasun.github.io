import{aV as w,bB as Se,o as h,c as C,F as Y,aY as X,b as e,f as l,a as i,bc as $,m as r,g as Z,E as ne,_ as re,bl as t,cv as ae,l as q,p as ge,q as me,bC as Oe,Q as Ve,aK as Ne,aC as oe,e as ve,cw as be,cq as Te,cE as Re}from"./index-e3c3ccff.js";import{E as G,a as ie}from"./el-table-column-4df7f294.js";/* empty css                    */import"./el-tag-ec687b5d.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-91791709.js";import"./el-scrollbar-1616d62b.js";import{E as ye}from"./el-dialog-e69e6c9f.js";import{_ as he}from"./DefinScrollbar-94f662b6.js";import{I as K,j as D,a as Q,s as k,f as _e,c as Ee,E as Me}from"./common-3e77035d.js";/* empty css                */import{E as ke,a as Ie}from"./el-form-item-2b2274b8.js";import{E as xe,a as Ce}from"./el-select-4ca34f81.js";/* empty css                 */import{E as $e}from"./index-c6199d0c.js";import{E as Ae}from"./el-switch-6576365a.js";import"./8Array-c7fce432.js";import"./CloneObject-ccd2b450.js";import"./index-176a71e9.js";import"./isEqual-b5cff9cc.js";import"./debounce-a335400b.js";/* empty css                                                                       */import"./index-43876011.js";const ce=w(!1),fe=w(!1),_=w({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1}),b=w({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1});w(!1);w({name:"",value:[1,1,1,1,1,1],editingIndex:-1});const a=w({name:"",key:"",config:{portID:0,unitID:0,canID:0,axisID:0,ratio:0,encoder:0,unitDist:0,maxRPM:0,normalvel:0,slowvel:0,neartarget:0,ontarget:0,motorDir:0,encoderDir:0,originmode:0,maxHeight:0,radius:0,isturn:0,syncFineVel:0,syncDir:0,syncVelRatioUp:0,steadyHeight:0},editingIndex:-1});w({id:-1,note:"",taskList:[],editingIndex:-1});const Be={key:0},Je=i("br",null,null,-1),Le=i("br",null,null,-1),je=i("br",null,null,-1),Pe={key:1},He=i("br",null,null,-1),Fe=i("br",null,null,-1),qe=i("br",null,null,-1),ze={key:2},Ge=i("br",null,null,-1),Ye=i("br",null,null,-1),Ke={key:3},Qe=i("br",null,null,-1),We=i("br",null,null,-1),Xe=i("br",null,null,-1),Ze={key:4},el=i("br",null,null,-1),ll={__name:"IO",setup(R){const c=w("1"),J=w(!0),N=w(!1),E=w(!1),S=w(!1),s=w(!1),n=w("1"),o=w("1"),V=w("1"),I=w("1"),y=w(""),f=w(""),g=()=>{if(c.value==="2"||c.value==="3"||c.value==="5")_.value.config=[parseInt(c.value),parseInt(n.value),parseInt(o.value),parseInt(V.value),parseInt(I.value)];else if(c.value==="1")_.value.config=[parseInt(c.value),0,parseInt(n.value),parseInt(o.value),parseInt(V.value)];else if(c.value==="4"){const M=parseInt(n.value,16);y.value=isNaN(M)?"":M.toString(),_.value.config=[parseInt(c.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",_.value.config)},L=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],d=()=>{if(_.value.config.value!==void 0){if(_.value.config.value[0]===2||_.value.config.value[0]===3||_.value.config.value[0]===5)c.value=_.value.config.value[0].toString(),n.value=_.value.config.value[1].toString(),o.value=_.value.config.value[2].toString(),V.value=_.value.config.value[3].toString(),I.value=_.value.config.value[4].toString(),U();else if(_.value.config.value[0]===1)c.value=_.value.config.value[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),V.value=_.value.config.value[4].toString(),U();else if(_.value.config.value[0]===4){c.value=_.value.config.value[0].toString();const M=parseInt(_.value.config.value[3],10);f.value=isNaN(M)?"":M.toString(16),n.value=f.value.toString(),o.value=_.value.config.value[4].toString(),U()}}else if(_.value.config!==void 0){if(_.value.config[0]===2||_.value.config[0]===3||_.value.config[0]===5)c.value=_.value.config[0].toString(),n.value=_.value.config[1].toString(),o.value=_.value.config[2].toString(),V.value=_.value.config[3].toString(),I.value=_.value.config[4].toString(),U();else if(_.value.config[0]===1)c.value=_.value.config[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),V.value=_.value.config.value[4].toString(),U();else if(_.value.config[0]===4){c.value=_.value.config[0].toString();const M=parseInt(_.value.config[3],10);f.value=isNaN(M)?"":M.toString(16),n.value=f.value.toString(),o.value=_.value.config.value[4].toString(),U()}}else c.value="1",n.value="1",o.value="1",V.value="1",I.value="1",U(),console.log("putJSONelse")},U=()=>{switch(console.log("handleChange",c.value),c.value){case"1":J.value=!0,N.value=!1,E.value=!1,S.value=!1,s.value=!1,g();return;case"2":J.value=!1,N.value=!0,E.value=!1,S.value=!1,s.value=!1,g();return;case"3":J.value=!1,N.value=!1,E.value=!0,S.value=!1,s.value=!1,g();return;case"4":J.value=!1,N.value=!1,E.value=!1,S.value=!0,s.value=!1,g();return;case"5":J.value=!1,N.value=!1,E.value=!1,S.value=!1,s.value=!0,g();return}};d();let te=0;return Se(ce,()=>{const M=Date.now();M-te>=700&&(d(),te=M)}),(M,m)=>{const ee=$e,p=xe,A=Ce,de=ne;return h(),C("div",null,[(h(),C(Y,null,X(L,(v,P)=>e(ee,{key:P,modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=j=>c.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),N.value?(h(),C("div",Be,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Je,r(" CAN-POS模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[2]||(m[2]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Le,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[3]||(m[3]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),je,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[4]||(m[4]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),E.value?(h(),C("div",Pe,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[5]||(m[5]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),He,r(" CAN-OPEN模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[6]||(m[6]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Fe,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[7]||(m[7]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),qe,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[8]||(m[8]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),J.value?(h(),C("div",ze,[r(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":m[9]||(m[9]=v=>n.value=v),type:"number",onChange:g},null,8,["modelValue"]),Ge,r(" 输出点对应位: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[10]||(m[10]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"BIT1",value:"0"}),e(p,{label:"BIT2",value:"1"}),e(p,{label:"BIT3",value:"2"}),e(p,{label:"BIT4",value:"3"}),e(p,{label:"BIT5",value:"4"}),e(p,{label:"BIT6",value:"5"}),e(p,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),Ye,r(" 信号极性: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[11]||(m[11]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),s.value?(h(),C("div",Ke,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[12]||(m[12]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Qe,r(" CAN-IO模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[13]||(m[13]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),We,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[14]||(m[14]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Xe,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[15]||(m[15]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),S.value?(h(),C("div",Ze,[r(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":m[16]||(m[16]=v=>n.value=v),onChange:g},null,8,["modelValue"]),el,r(" 信号极性: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[17]||(m[17]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const al=R=>(ge("data-v-2f6a8c35"),R=R(),me(),R),nl=al(()=>i("br",null,null,-1)),tl={slot:"footer",class:"dialog-footer"},ul={__name:"index",setup(R){const c=w(!1),J=()=>{_.value.name="",_.value.key="",_.value.config.value=[1,1,1,1,1,1],_.value.editingIndex=-1,console.log("addNewRow",_.value.config.value),c.value=!0,ce.value=!ce.value},N=s=>{_.value.name=K.value[s].name,_.value.key=K.value[s].key,_.value.config.value=K.value[s].config,_.value.editingIndex=s,console.log("reedit",_.value.editingIndex),c.value=!0,ce.value=!ce.value},E=()=>{if(_.value.name){if(_.value.editingIndex!==-1)K.value[_.value.editingIndex].name=_.value.name,K.value[_.value.editingIndex].key=_.value.key,_.value.config!=null&&(K.value[_.value.editingIndex].config=_.value.config),D.value.IO.input=K,console.log("handleAddRowb",_.value.config),console.log("handleAddRow",K.value[_.value.editingIndex].config);else{const{editingIndex:s,...n}=_.value,o={...n};K.value.push(JSON.parse(JSON.stringify(o))),D.value.IO.input=K,console.log("handleAddRowa",o)}c.value=!1}else ae.error("请填写完整数据")},S=s=>{K.value.splice(s,1)};return(s,n)=>{const o=q,V=G,I=ie,y=ne,f=ke,g=Ie,L=ye;return h(),C(Y,null,[e(I,{data:t(K),style:{width:"100%"},class:"IOinputdata"},{default:l(()=>[e(V,{prop:"key",label:"⚠️ 输入点IO"},{default:l(x=>[e(o,{type:"text",onClick:d=>N(x.$index)},{default:l(()=>[r($(t(K)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:J},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:d=>N(x.$index)},{default:l(()=>[r($(t(K)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{prop:"config",label:"输入点"},{default:l(x=>[i("h4",null,$(x.row.config),1)]),_:1}),e(V,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:d=>S(x.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(L,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[3]||(n[3]=x=>c.value=x),visible:c.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[nl,e(g,{ref:"form",model:t(_),"label-width":"80px"},{default:l(()=>[e(f,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(_).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(_).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(f,{label:"key"},{default:l(()=>[e(y,{modelValue:t(_).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(_).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(f,{label:"IO"},{default:l(()=>[e(ll)]),_:1})]),_:1},8,["model"]),i("div",tl,[e(o,{onClick:n[2]||(n[2]=x=>c.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:E},{default:l(()=>[r("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},ol=re(ul,[["__scopeId","data-v-2f6a8c35"]]),il={key:0},dl=i("br",null,null,-1),sl=i("br",null,null,-1),vl=i("br",null,null,-1),rl={key:1},cl=i("br",null,null,-1),fl=i("br",null,null,-1),gl=i("br",null,null,-1),ml={key:2},pl=i("br",null,null,-1),_l=i("br",null,null,-1),bl={key:3},yl=i("br",null,null,-1),Vl=i("br",null,null,-1),hl=i("br",null,null,-1),kl={key:4},Il=i("br",null,null,-1),xl={__name:"IO",setup(R){const c=w("1"),J=w(!0),N=w(!1),E=w(!1),S=w(!1),s=w(!1),n=w("1"),o=w("1"),V=w("1"),I=w("1"),y=w(""),f=w(""),g=()=>{if(c.value==="2"||c.value==="3"||c.value==="5")b.value.config=[parseInt(c.value),parseInt(n.value),parseInt(o.value),parseInt(V.value),parseInt(I.value)];else if(c.value==="1")b.value.config=[parseInt(c.value),0,parseInt(n.value),parseInt(o.value),parseInt(V.value)];else if(c.value==="4"){const M=parseInt(n.value,16);y.value=isNaN(M)?"":M.toString(),b.value.config=[parseInt(c.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",b.value.config)},L=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],d=()=>{if(b.value.config.value!==void 0){if(b.value.config.value[0]===2||b.value.config.value[0]===3||b.value.config.value[0]===5)c.value=b.value.config.value[0].toString(),n.value=b.value.config.value[1].toString(),o.value=b.value.config.value[2].toString(),V.value=b.value.config.value[3].toString(),I.value=b.value.config.value[4].toString(),U();else if(b.value.config.value[0]===1)c.value=b.value.config.value[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),V.value=b.value.config.value[4].toString(),U();else if(b.value.config.value[0]===4){c.value=b.value.config.value[0].toString();const M=parseInt(b.value.config.value[3],10);f.value=isNaN(M)?"":M.toString(16),n.value=f.value.toString(),o.value=b.value.config.value[4].toString(),U()}}else if(b.value.config!==void 0){if(b.value.config[0]===2||b.value.config[0]===3||b.value.config[0]===5)c.value=b.value.config[0].toString(),n.value=b.value.config[1].toString(),o.value=b.value.config[2].toString(),V.value=b.value.config[3].toString(),I.value=b.value.config[4].toString(),U();else if(b.value.config[0]===1)c.value=b.value.config[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),V.value=b.value.config.value[4].toString(),U();else if(b.value.config[0]===4){c.value=b.value.config[0].toString();const M=parseInt(b.value.config[3],10);f.value=isNaN(M)?"":M.toString(16),n.value=f.value.toString(),o.value=b.value.config.value[4].toString(),U()}}else c.value="1",n.value="1",o.value="1",V.value="1",I.value="1",U(),console.log("putJSONelse")},U=()=>{switch(console.log("handleChange",c.value),c.value){case"1":J.value=!0,N.value=!1,E.value=!1,S.value=!1,s.value=!1,g();return;case"2":J.value=!1,N.value=!0,E.value=!1,S.value=!1,s.value=!1,g();return;case"3":J.value=!1,N.value=!1,E.value=!0,S.value=!1,s.value=!1,g();return;case"4":J.value=!1,N.value=!1,E.value=!1,S.value=!0,s.value=!1,g();return;case"5":J.value=!1,N.value=!1,E.value=!1,S.value=!1,s.value=!0,g();return}};d();let te=0;return Se(fe,()=>{const M=Date.now();M-te>=700&&(d(),te=M)}),(M,m)=>{const ee=$e,p=xe,A=Ce,de=ne;return h(),C("div",null,[(h(),C(Y,null,X(L,(v,P)=>e(ee,{key:P,modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=j=>c.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),N.value?(h(),C("div",il,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),dl,r(" CAN-POS模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[2]||(m[2]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),sl,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[3]||(m[3]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),vl,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[4]||(m[4]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),E.value?(h(),C("div",rl,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[5]||(m[5]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),cl,r(" CAN-OPEN模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[6]||(m[6]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),fl,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[7]||(m[7]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),gl,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[8]||(m[8]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),J.value?(h(),C("div",ml,[r(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":m[9]||(m[9]=v=>n.value=v),type:"number",onChange:g},null,8,["modelValue"]),pl,r(" 输出点对应位: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[10]||(m[10]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"BIT1",value:"0"}),e(p,{label:"BIT2",value:"1"}),e(p,{label:"BIT3",value:"2"}),e(p,{label:"BIT4",value:"3"}),e(p,{label:"BIT5",value:"4"}),e(p,{label:"BIT6",value:"5"}),e(p,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),_l,r(" 信号极性: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[11]||(m[11]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),s.value?(h(),C("div",bl,[r(" 远程模块连接到: "),(h(),C(Y,null,X(x,(v,P)=>e(ee,{key:P,modelValue:n.value,"onUpdate:modelValue":m[12]||(m[12]=j=>n.value=j),label:v.value,onChange:U},{default:l(()=>[i("pre",null,$(v.label),1)]),_:2},1032,["modelValue","label"])),64)),yl,r(" CAN-IO模块编号: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[13]||(m[13]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Vl,r(" 模块内输出点编号: "),e(A,{modelValue:V.value,"onUpdate:modelValue":m[14]||(m[14]=v=>V.value=v),onChange:g},{default:l(()=>[e(p,{label:"0",value:"0"}),e(p,{label:"1",value:"1"}),e(p,{label:"2",value:"2"})]),_:1},8,["modelValue"]),hl,r(" 信号极性: "),e(A,{modelValue:I.value,"onUpdate:modelValue":m[15]||(m[15]=v=>I.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),S.value?(h(),C("div",kl,[r(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":m[16]||(m[16]=v=>n.value=v),onChange:g},null,8,["modelValue"]),Il,r(" 信号极性: "),e(A,{modelValue:o.value,"onUpdate:modelValue":m[17]||(m[17]=v=>o.value=v),onChange:g},{default:l(()=>[e(p,{label:"输出高电平有效",value:"0"}),e(p,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const Cl=R=>(ge("data-v-0806589d"),R=R(),me(),R),wl=Cl(()=>i("br",null,null,-1)),Sl={slot:"footer",class:"dialog-footer"},$l={__name:"index",setup(R){const c=w(!1),J=()=>{b.value.name="",b.value.key="",b.value.config.value=[1,1,1,1,1,1],b.value.editingIndex=-1,console.log("addnewoutRow",b.value.config.value),c.value=!0,fe.value=!fe.value},N=s=>{b.value.name=Q.value[s].name,b.value.key=Q.value[s].key,b.value.config.value=Q.value[s].config,b.value.editingIndex=s,console.log("reedit",b.value.config.value),c.value=!0,fe.value=!fe.value},E=()=>{if(b.value.name){if(b.value.editingIndex!==-1)Q.value[b.value.editingIndex].name=b.value.name,Q.value[b.value.editingIndex].key=b.value.key,b.value.config!=null&&(Q.value[b.value.editingIndex].config=b.value.config),D.value.IO.output=Q,console.log("handleAddRow",b.value.config),console.log("handleAddRow",Q.value[b.value.editingIndex].config);else{const{editingIndex:s,...n}=b.value,V={...{...n}};Q.value.push(JSON.parse(JSON.stringify(V))),D.value.IO.output=Q,console.log("handleAddRow",V)}c.value=!1}else ae.error("请填写完整数据")},S=s=>{Q.value.splice(s,1)};return(s,n)=>{const o=q,V=G,I=ie,y=ne,f=ke,g=Ie,L=ye;return h(),C(Y,null,[e(I,{data:t(Q),style:{width:"100%"},class:"IOoutputdata"},{default:l(()=>[e(V,{prop:"key",label:"⚠️ 输出点IO"},{default:l(x=>[e(o,{type:"text",onClick:d=>N(x.$index)},{default:l(()=>[r($(t(Q)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:J},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:d=>N(x.$index)},{default:l(()=>[r($(t(Q)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{prop:"config",label:"输出点"},{default:l(x=>[i("h4",null,$(x.row.config),1)]),_:1}),e(V,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:d=>S(x.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(L,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[3]||(n[3]=x=>c.value=x),visible:c.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[wl,e(g,{ref:"form",model:t(b),"label-width":"80px"},{default:l(()=>[e(f,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(b).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(b).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(f,{label:"key"},{default:l(()=>[e(y,{modelValue:t(b).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(b).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(f,{label:"IO"},{default:l(()=>[e(xl)]),_:1})]),_:1},8,["model"]),i("div",Sl,[e(o,{onClick:n[2]||(n[2]=x=>c.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:E},{default:l(()=>[r("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},Ul=re($l,[["__scopeId","data-v-0806589d"]]);const Ue=R=>(ge("data-v-7cb2a2de"),R=R(),me(),R),Dl=Ue(()=>i("br",null,null,-1)),Ol={style:{"margin-top":"2%","margin-left":"75%"}},Nl=Ue(()=>i("br",null,null,-1)),Tl={__name:"index",setup(R){const c=w(!1),J=()=>{a.value.name="",a.value.key="",a.value.config.portID=0,a.value.config.unitID=0,a.value.config.canID=0,a.value.config.axisID=0,a.value.config.ratio=0,a.value.config.encoder=0,a.value.config.unitDist=0,a.value.config.maxRPM=0,a.value.config.normalvel=0,a.value.config.slowvel=0,a.value.config.neartarget=0,a.value.config.ontarget=0,a.value.config.motorDir=0,a.value.config.encoderDir=0,a.value.config.originmode=0,a.value.config.maxHeight=0,a.value.config.isturn=0,a.value.config.syncFineVel=0,a.value.config.syncDir=0,a.value.config.syncVelRatioUp=0,a.value.config.steadyHeight=0,a.value.config.radius=0,a.value.editingIndex=-1,c.value=!0},N=s=>{a.value.name=k.value[s].name,a.value.key=k.value[s].key,a.value.config.portID=k.value[s].config.portID,a.value.config.unitID=k.value[s].config.unitID,a.value.config.canID=k.value[s].config.canID,a.value.config.axisID=k.value[s].config.axisID,a.value.config.ratio=k.value[s].config.ratio,a.value.config.encoder=k.value[s].config.encoder,a.value.config.unitDist=k.value[s].config.unitDist,a.value.config.maxRPM=k.value[s].config.maxRPM,a.value.config.normalvel=k.value[s].config.normalvel,a.value.config.slowvel=k.value[s].config.slowvel,a.value.config.neartarget=k.value[s].config.neartarget,a.value.config.ontarget=k.value[s].config.ontarget,a.value.config.motorDir=k.value[s].config.motorDir,a.value.config.encoderDir=k.value[s].config.encoderDir,a.value.config.originmode=k.value[s].config.originmode,a.value.config.maxHeight=k.value[s].config.maxHeight,a.value.config.isturn=k.value[s].config.isturn,a.value.config.syncFineVel=k.value[s].config.syncFineVel,a.value.config.syncDir=k.value[s].config.syncDir,a.value.config.syncVelRatioUp=k.value[s].config.syncVelRatioUp,a.value.config.steadyHeight=k.value[s].config.steadyHeight,a.value.config.radius=k.value[s].config.radius,a.value.editingIndex=s,c.value=!0},E=()=>{if(a.value.name){if(a.value.editingIndex!==-1)k.value[a.value.editingIndex].name=a.value.name,k.value[a.value.editingIndex].key=a.value.key,k.value[a.value.editingIndex].config.portID=a.value.config.portID,k.value[a.value.editingIndex].config.unitID=a.value.config.unitID,k.value[a.value.editingIndex].config.canID=a.value.config.canID,k.value[a.value.editingIndex].config.axisID=a.value.config.axisID,k.value[a.value.editingIndex].config.ratio=a.value.config.ratio,k.value[a.value.editingIndex].config.encoder=a.value.config.encoder,k.value[a.value.editingIndex].config.unitDist=a.value.config.unitDist,k.value[a.value.editingIndex].config.maxRPM=a.value.config.maxRPM,k.value[a.value.editingIndex].config.normalvel=a.value.config.normalvel,k.value[a.value.editingIndex].config.slowvel=a.value.config.slowvel,k.value[a.value.editingIndex].config.neartarget=a.value.config.neartarget,k.value[a.value.editingIndex].config.ontarget=a.value.config.ontarget,k.value[a.value.editingIndex].config.motorDir=a.value.config.motorDir,k.value[a.value.editingIndex].config.encoderDir=a.value.config.encoderDir,k.value[a.value.editingIndex].config.originmode=a.value.config.originmode,k.value[a.value.editingIndex].config.maxHeight=a.value.config.maxHeight,k.value[a.value.editingIndex].config.isturn=a.value.config.isturn,k.value[a.value.editingIndex].config.syncFineVel=a.value.config.syncFineVel,k.value[a.value.editingIndex].config.syncDir=a.value.config.syncDir,k.value[a.value.editingIndex].config.syncVelRatioUp=a.value.config.syncVelRatioUp,k.value[a.value.editingIndex].config.steadyHeight=a.value.config.steadyHeight,k.value[a.value.editingIndex].config.radius=a.value.config.radius,D.value.servo.kinco=k;else{const{editingIndex:s,...n}=a.value,V={...{...n}};k.value.push(JSON.parse(JSON.stringify(V))),D.value.servo.kinco=k,console.log("handleAddRow",V)}c.value=!1}else ae.error("请填写完整数据")},S=s=>{k.value.splice(s,1)};return(s,n)=>{const o=q,V=G,I=ie,y=ne,f=ke,g=Ae,L=Ie,x=ye;return h(),C(Y,null,[e(I,{data:t(k),style:{width:"100%"},class:"servodata"},{default:l(()=>[e(V,{prop:"key",label:"⚠️ 上装伺服"},{default:l(d=>[e(o,{type:"text",onClick:U=>N(d.$index)},{default:l(()=>[r($(t(k)[d.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:J},{default:l(()=>[r("添加新数据")]),_:1})]),default:l(d=>[e(o,{type:"text",onClick:U=>N(d.$index)},{default:l(()=>[r($(t(k)[d.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(V,{label:"CAN口号"},{default:l(d=>[r($(d.row.config.portID),1)]),_:1}),e(V,{label:"单元号"},{default:l(d=>[r($(d.row.config.unitID),1)]),_:1}),e(V,{label:"模块内对应编号"},{default:l(d=>[r($(d.row.config.canID),1)]),_:1}),e(V,{label:"原点模式"},{default:l(d=>[i("h4",null,$(d.row.config.originmode===1?"是":"否"),1)]),_:1}),e(V,{label:"是否有转盘"},{default:l(d=>[i("h4",null,$(d.row.config.isturn===1?"是":"否"),1)]),_:1}),e(V,{label:"操作"},{default:l(d=>[e(o,{type:"danger",onClick:U=>S(d.$index)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(x,{title:"添加数据",modelValue:c.value,"onUpdate:modelValue":n[25]||(n[25]=d=>c.value=d),visible:c.value,width:"900px","close-on-click-modal":!1,"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(he,{height:"100%",showUpBt:!0},{default:l(()=>[Dl,e(L,{ref:"form",model:t(a),"label-width":"180px"},{default:l(()=>[e(f,{label:"名称"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).key,"onUpdate:modelValue":n[0]||(n[0]=d=>t(a).key=d),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(f,{label:"key"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).name,"onUpdate:modelValue":n[1]||(n[1]=d=>t(a).name=d),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(f,{label:"CAN-ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.portID,"onUpdate:modelValue":n[2]||(n[2]=d=>t(a).config.portID=d),modelModifiers:{number:!0},placeholder:"can口号"},null,8,["modelValue"])]),_:1}),e(f,{label:"CAN单元号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitID,"onUpdate:modelValue":n[3]||(n[3]=d=>t(a).config.unitID=d),modelModifiers:{number:!0},placeholder:"单元号"},null,8,["modelValue"])]),_:1}),e(f,{label:"模块内对应点编号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.canID,"onUpdate:modelValue":n[4]||(n[4]=d=>t(a).config.canID=d),modelModifiers:{number:!0},placeholder:"模块内对应点编号"},null,8,["modelValue"])]),_:1}),e(f,{label:"轴ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.axisID,"onUpdate:modelValue":n[5]||(n[5]=d=>t(a).config.axisID=d),modelModifiers:{number:!0},placeholder:"轴ID"},null,8,["modelValue"])]),_:1}),e(f,{label:"减速比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ratio,"onUpdate:modelValue":n[6]||(n[6]=d=>t(a).config.ratio=d),modelModifiers:{number:!0},placeholder:"减速比"},null,8,["modelValue"])]),_:1}),e(f,{label:"编码器绝对值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoder,"onUpdate:modelValue":n[7]||(n[7]=d=>t(a).config.encoder=d),modelModifiers:{number:!0},placeholder:"编码器绝对值"},null,8,["modelValue"])]),_:1}),e(f,{label:"伺服行程转换比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitDist,"onUpdate:modelValue":n[8]||(n[8]=d=>t(a).config.unitDist=d),modelModifiers:{number:!0},placeholder:"伺服行程转换比"},null,8,["modelValue"])]),_:1}),e(f,{label:"最大转速"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxRPM,"onUpdate:modelValue":n[9]||(n[9]=d=>t(a).config.maxRPM=d),modelModifiers:{number:!0},placeholder:"最大转速"},null,8,["modelValue"])]),_:1}),e(f,{label:"正常速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.normalvel,"onUpdate:modelValue":n[10]||(n[10]=d=>t(a).config.normalvel=d),modelModifiers:{number:!0},placeholder:"正常速度"},null,8,["modelValue"])]),_:1}),e(f,{label:"减速速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.slowvel,"onUpdate:modelValue":n[11]||(n[11]=d=>t(a).config.slowvel=d),modelModifiers:{number:!0},placeholder:"减速速度"},null,8,["modelValue"])]),_:1}),e(f,{label:"切换速度的临界距离"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.neartarget,"onUpdate:modelValue":n[12]||(n[12]=d=>t(a).config.neartarget=d),modelModifiers:{number:!0},placeholder:"切换速度的临界距离"},null,8,["modelValue"])]),_:1}),e(f,{label:"允许误差"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ontarget,"onUpdate:modelValue":n[13]||(n[13]=d=>t(a).config.ontarget=d),modelModifiers:{number:!0},placeholder:"允许误差"},null,8,["modelValue"])]),_:1}),e(f,{label:"电机方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.motorDir,"onUpdate:modelValue":n[14]||(n[14]=d=>t(a).config.motorDir=d),modelModifiers:{number:!0},placeholder:"电机方向"},null,8,["modelValue"])]),_:1}),e(f,{label:"码盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoderDir,"onUpdate:modelValue":n[15]||(n[15]=d=>t(a).config.encoderDir=d),modelModifiers:{number:!0},placeholder:"码盘方向"},null,8,["modelValue"])]),_:1}),e(f,{label:"原点模式"},{default:l(()=>[e(g,{style:{width:"80%"},modelValue:t(a).config.originmode,"onUpdate:modelValue":n[16]||(n[16]=d=>t(a).config.originmode=d),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(f,{label:"最大行程"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxHeight,"onUpdate:modelValue":n[17]||(n[17]=d=>t(a).config.maxHeight=d),modelModifiers:{number:!0},placeholder:"最大行程"},null,8,["modelValue"])]),_:1}),e(f,{label:"凸轮半径"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.radius,"onUpdate:modelValue":n[18]||(n[18]=d=>t(a).config.radius=d),modelModifiers:{number:!0},placeholder:"凸轮半径"},null,8,["modelValue"])]),_:1}),e(f,{label:"是否是转盘"},{default:l(()=>[e(g,{style:{width:"80%"},modelValue:t(a).config.isturn,"onUpdate:modelValue":n[19]||(n[19]=d=>t(a).config.isturn=d),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(f,{label:"转盘速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncFineVel,"onUpdate:modelValue":n[20]||(n[20]=d=>t(a).config.syncFineVel=d),modelModifiers:{number:!0},placeholder:"转盘速度"},null,8,["modelValue"])]),_:1}),e(f,{label:"转盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncDir,"onUpdate:modelValue":n[21]||(n[21]=d=>t(a).config.syncDir=d),modelModifiers:{number:!0},placeholder:"转盘方向"},null,8,["modelValue"])]),_:1}),e(f,{label:"syncVelRatioUp"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncVelRatioUp,"onUpdate:modelValue":n[22]||(n[22]=d=>t(a).config.syncVelRatioUp=d),modelModifiers:{number:!0},placeholder:"syncVelRatioUp"},null,8,["modelValue"])]),_:1}),e(f,{label:"复位初始值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.steadyHeight,"onUpdate:modelValue":n[23]||(n[23]=d=>t(a).config.steadyHeight=d),modelModifiers:{number:!0},placeholder:"复位初始值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),i("div",Ol,[e(o,{onClick:n[24]||(n[24]=d=>c.value=!1)},{default:l(()=>[r("取 消")]),_:1}),e(o,{type:"primary",onClick:E},{default:l(()=>[r("确定")]),_:1})]),Nl]),_:1})]),_:1},8,["modelValue","visible"])],64)}}},Rl=re(Tl,[["__scopeId","data-v-7cb2a2de"]]);const le=R=>(ge("data-v-0a88163c"),R=R(),me(),R),El={key:0,class:"error-details"},Ml={class:"error-item"},Al=le(()=>i("strong",null,"异常名称:",-1)),Bl={key:0},Jl={key:1},Ll={class:"error-item"},jl=le(()=>i("strong",null,"异常结果:",-1)),Pl={key:0},Hl={key:1},Fl={class:"error-item"},ql=le(()=>i("strong",null,"需要执行的接口名称:",-1)),zl={key:0},Gl={key:1},Yl={class:"error-item"},Kl=le(()=>i("strong",null,"类型:",-1)),Ql={key:0},Wl={key:1},Xl={class:"error-item"},Zl=le(()=>i("strong",null,"值:",-1)),ea={key:0},la={key:1},aa={class:"error-item"},na=le(()=>i("strong",null,"输入的字符串参数:",-1)),ta={key:0},ua={key:1},oa={class:"error-item"},ia=le(()=>i("strong",null,"错误码:",-1)),da={key:0},sa={key:1},va={class:"error-item"},ra=le(()=>i("strong",null,"错误信息:",-1)),ca={key:0},fa={key:1},ga={style:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},ma=le(()=>i("span",null,"任务步骤",-1)),pa={key:0},_a={style:{"font-size":"16px","font-style":"oblique","margin-right":"10px"}},ba={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},ya=le(()=>i("br",null,null,-1)),Va={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},ha=le(()=>i("br",null,null,-1)),ka={__name:"task",setup(R){const c=w([{label:"重复执行",value:0},{label:"正常",value:1},{label:"异常",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}]);Oe(()=>{let u="";_e.value=Ee.value.split(`
`).reduce((F,H)=>{if(H.trim().startsWith("function")){const ue=H.split("(")[0].split(" ")[1];u||(u=ue),F.push({name:u,key:ue}),u=H}else u=H;return F},[])});const J=u=>{const F=_e.value.find(H=>H.key===u);return F?F.name:u},N=w("");function E(){D.value.Task.push({note:"",id:0,taskList:[]})}w(0);let S={green:{},red:{}};const s=w({green:{},red:{}}),n=w({}),o=Ve(()=>D.value.Task.find(u=>u.id===O.value.curTaskID)),V=()=>{if(o.value){const u=o.value;if(n.value[u.id]==="green")return;clearInterval(S.red[u.id]),delete S.red[u.id],s.value.red[u.id]=!1,s.value.green[u.id]=!0,n.value[u.id]="green",S.green[u.id]||(S.green[u.id]=setInterval(()=>{s.value.green[u.id]=!s.value.green[u.id]},500))}},I=()=>{if(o.value){const u=o.value;if(n.value[u.id]==="red")return;clearInterval(S.green[u.id]),delete S.green[u.id],s.value.green[u.id]=!1,s.value.red[u.id]=!0,n.value[u.id]="red",S.red[u.id]||(S.red[u.id]=setInterval(()=>{s.value.red[u.id]=!s.value.red[u.id]},500))}},y=()=>{if(o.value){const u=o.value;clearInterval(S.green[u.id]),delete S.green[u.id],s.value.green[u.id]=!1,clearInterval(S.red[u.id]),delete S.red[u.id],s.value.red[u.id]=!1,n.value[u.id]=null}};w("");let f={green:{},red:{}};const g=w({green:{},red:{}}),L=w({}),x=Ve(()=>D.value.Task.flatMap(u=>u.taskList).find(u=>u.main===O.value.subTaskStatus.main_name)),d=()=>{if(x.value){const u=x.value;if(console.log("2222",L.value[u.main]),L.value[u.main]==="green")return;clearInterval(f.red[u.main]),delete f.red[u.main],g.value.red[u.main]=!1,g.value.green[u.main]=!0,L.value[u.main]="green",f.green[u.main]||(f.green[u.main]=setInterval(()=>{g.value.green[u.main]=!g.value.green[u.main]},500))}},U=()=>{if(x.value){const u=x.value;if(L.value[u.main]==="red")return;clearInterval(f.green[u.main]),delete f.green[u.main],g.value.green[u.main]=!1,g.value.red[u.main]=!0,L.value[u.main]="red",f.red[u.main]||(f.red[u.main]=setInterval(()=>{g.value.red[u.main]=!g.value.red[u.main]},500))}},te=()=>{if(x.value){const u=x.value;clearInterval(f.green[u.main]),delete f.green[u.main],g.value.green[u.main]=!1,clearInterval(f.red[u.main]),delete f.red[u.main],g.value.red[u.main]=!1,L.value[u.main]=null}};function M(u){const F=D.value.Task.indexOf(u);F>-1&&D.value.Task.splice(F,1)}function m(u){u.taskList.push({main:"",exceptions:[""],jump:[{}]})}function ee(u,F){const H=u.taskList.indexOf(F);H>-1&&u.taskList.splice(H,1)}function p(u){u.exceptions||(u.exceptions=[]),u.exceptions.push(N.value),N.value=""}function A(u,F){u.exceptions.splice(F,1)}function de(u){u.jump||(u.jump=[]),u.jump.push({})}function v(u,F){u.jump.splice(F,1)}const P=w(new Set);function j(u){return P.value.has(u)}function De(u){P.value.has(u)?P.value.delete(u):P.value.add(u)}const O=w(null),we=()=>{be({method:"post",url:"/api/data/analysis",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(F=>{O.value=F.data,console.log("111111",O.value),O.value.curTaskID;const H=O.value.taskStatus;H===0?y():H===1?V():(H===2||H===3)&&I();const ue=O.value.subTaskStatus.main_result;O.value.subTaskStatus.exception_result===1?U():ue===0?d():te()}).catch(F=>{}).finally(()=>{}),Te.value=setTimeout(we,500)};return Ne(()=>{we()}),(u,F)=>{const H=xe,ue=Ce;return h(),C("div",null,[e(t(ie),{data:t(D).Task,style:{width:"100%"},class:"jsondatatask"},{default:l(()=>[e(t(G),{label:"⚠️ 任务列表",width:"200"},{default:l(({row:T})=>[i("div",{class:oe(j(T)?"zhedie":"zhankai")},[i("div",{class:oe([{"highlight-green":s.value.green[T.id],"highlight-red":s.value.red[T.id]},"data-item"])},[e(t(q),{onClick:B=>De(T),type:"info"},{default:l(()=>[r($(j(T)?"折叠":"展开"),1)]),_:2},1032,["onClick"]),e(t(q),{type:"danger",onClick:B=>M(T)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"]),e(t(ne),{style:{"margin-top":"3%"},modelValue:T.note,"onUpdate:modelValue":B=>T.note=B,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"]),j(T)&&O.value&&O.value.curTaskID===T.id?(h(),C("div",El,[i("div",Ml,[Al,O.value.subTaskStatus.exception_name!==void 0?(h(),C("span",Bl,$(J(O.value.subTaskStatus.exception_name)),1)):(h(),C("span",Jl,"null"))]),i("div",Ll,[jl,O.value.subTaskStatus.exception_result!==void 0?(h(),C("span",Pl,$(O.value.subTaskStatus.exception_result===0?"无异常":"有异常"),1)):(h(),C("span",Hl,"null"))]),i("div",Fl,[ql,O.value.subTaskStatus.sentence.name!==void 0?(h(),C("span",zl,$(O.value.subTaskStatus.sentence.name),1)):(h(),C("span",Gl,"null"))]),i("div",Yl,[Kl,O.value.subTaskStatus.sentence.data.type!==void 0?(h(),C("span",Ql,$(O.value.subTaskStatus.sentence.data.type===0?"布尔值":O.value.subTaskStatus.sentence.data.type===1?"整数":O.value.subTaskStatus.sentence.data.type===2?"双精度":"未知类型"),1)):(h(),C("span",Wl,"null"))]),i("div",Xl,[Zl,O.value.subTaskStatus.sentence.data.value!==void 0?(h(),C("span",ea,$(O.value.subTaskStatus.sentence.data.value),1)):(h(),C("span",la,"null"))]),i("div",aa,[na,O.value.subTaskStatus.sentence.param.value!==void 0?(h(),C("span",ta,$(O.value.subTaskStatus.sentence.param.value),1)):(h(),C("span",ua,"null"))]),i("div",oa,[ia,O.value.curTaskError.errorCode!==void 0?(h(),C("span",da,$(O.value.curTaskError.errorCode===0?"无故障":O.value.curTaskError.errorCode===1?"超时故障":O.value.curTaskError.errorCode===2?"异常故障":O.value.curTaskError.errorCode===3?"内部故障":"未知错误"),1)):(h(),C("span",sa,"null"))]),i("div",va,[ra,O.value.curTaskError.errorMessage!==void 0?(h(),C("span",ca,$(O.value.curTaskError.errorMessage),1)):(h(),C("span",fa,"null"))])])):Z("",!0)],2)],2)]),_:1}),e(t(G),{label:"任务 ID",width:"100"},{default:l(({row:T})=>[i("div",{class:oe(j(T)?"zhedie":"zhankai")},[i("div",{class:oe([{"highlight-green":s.value.green[T.id],"highlight-red":s.value.red[T.id]},"data-item"])},[e(t(ne),{modelValue:T.id,"onUpdate:modelValue":B=>T.id=B,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])],2)],2)]),_:1}),e(t(G),{label:"任务步骤"},{header:l(()=>[i("div",ga,[ma,e(t(q),{type:"primary",onClick:E},{default:l(()=>[r("添加任务")]),_:1})])]),default:l(({row:T})=>[i("div",{class:oe([{"highlight-green":s.value.green[T.id],"highlight-red":s.value.red[T.id]},"data-item"])},[j(T)?(h(),C("div",pa,[i("div",null,[e(t(q),{type:"primary",onClick:B=>m(T)},{default:l(()=>[r("添加动作")]),_:2},1032,["onClick"])]),e(t(ie),{data:T.taskList,style:{width:"100%"}},{default:l(()=>[e(t(G),{label:"动作"},{default:l(({row:B})=>[i("div",{class:oe([{"highlight-green":g.value.green[B.main],"highlight-red":g.value.red[B.main]},"data-item"])},[i("span",_a,"第"+$(T.taskList.indexOf(B)+1)+"步",1),e(t(q),{type:"danger",onClick:W=>ee(T,B)},{default:l(()=>[r("删除动作")]),_:2},1032,["onClick"]),e(ue,{modelValue:B.main,"onUpdate:modelValue":W=>B.main=W,placeholder:"选择动作"},{default:l(()=>[(h(!0),C(Y,null,X(t(_e),W=>(h(),ve(H,{key:W,label:W.name,value:W.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2)]),_:2},1024),e(t(G),{label:"动作异常"},{default:l(({row:B})=>[i("div",{class:oe([{"highlight-green":g.value.green[B.main],"highlight-red":g.value.red[B.main]},"data-item"])},[i("ul",null,[(h(!0),C(Y,null,X(B.exceptions,(W,se)=>(h(),C("li",{key:`exception-${se}`},[i("div",ba,[e(ue,{modelValue:B.exceptions[se],"onUpdate:modelValue":z=>B.exceptions[se]=z,placeholder:"动作中检测异常"},{default:l(()=>[(h(!0),C(Y,null,X(t(_e),z=>(h(),ve(H,{key:z,label:z.name,value:z.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),r("   "),e(t(q),{type:"danger",onClick:z=>A(B,se)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])])]))),128)),ya,e(t(q),{type:"primary",onClick:W=>p(B)},{default:l(()=>[r("添加异常")]),_:2},1032,["onClick"])])],2)]),_:1}),e(t(G),{label:"执行结果和跳转"},{default:l(({row:B})=>[i("div",{class:oe([{"highlight-green":g.value.green[B.main],"highlight-red":g.value.red[B.main]},"data-item"])},[(h(!0),C(Y,null,X(B.jump,(W,se)=>(h(),C("div",{key:`jump-${se}`},[i("div",Va,[e(ue,{modelValue:W.condition,"onUpdate:modelValue":z=>W.condition=z,placeholder:"执行结果"},{default:l(()=>[(h(!0),C(Y,null,X(c.value,z=>(h(),ve(H,{label:z.label,value:z.value},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(ue,{modelValue:W.index,"onUpdate:modelValue":z=>W.index=z,placeholder:"跳转索引"},{default:l(()=>[(h(!0),C(Y,null,X(T.taskList,z=>(h(),ve(H,{label:"第 "+(T.taskList.indexOf(z)+1)+" 步",value:T.taskList.indexOf(z)+1},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),r("   "),e(t(q),{type:"danger",onClick:z=>v(B,se)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])])]))),128)),ha,e(t(q),{type:"primary",onClick:W=>de(B)},{default:l(()=>[r("添加跳转")]),_:2},1032,["onClick"])],2)]),_:2},1024)]),_:2},1032,["data"])])):Z("",!0)],2)]),_:1})]),_:1},8,["data"])])}}},Ia=re(ka,[["__scopeId","data-v-0a88163c"]]);const xa={__name:"index",setup(R){const c=w(new Set),J=()=>{Re.prompt("请输入设备名","添加设备",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[^\u4e00-\u9fa5]+$/,inputErrorMessage:"不能包含中文"}).then(({value:o})=>{D.value.device||(D.value.device={}),D.value.device[o]=[]}).catch(()=>{ae({message:"已取消添加设备",type:"info"})})},N=o=>{c.value.has(o)?c.value.delete(o):c.value.add(o)},E=o=>c.value.has(o),S=o=>{delete D.value.device[o]},s=o=>{o.push({key:"",value:""})},n=(o,V)=>{const I=o.indexOf(V);I!==-1&&o.splice(I,1)};return(o,V)=>(h(),ve(t(ie),{data:Object.entries(t(D).device),style:{width:"100%"}},{default:l(()=>[e(t(G),{label:"⚠️ 设备",width:"200"},{default:l(I=>[e(t(q),{onClick:y=>N(I.row[0]),type:"info"},{default:l(()=>[r($(E(I.row[0])?"展开":"折叠"),1)]),_:2},1032,["onClick"]),e(t(q),{onClick:y=>S(I.row[0]),type:"danger",style:{"margin-left":"10px"}},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1}),e(t(G),{label:"设备名",width:"200"},{default:l(I=>[i("span",null,$(I.row[0]),1)]),_:1}),e(t(G),{label:"对象",width:"500"},{default:l(I=>[E(I.row[0])?Z("",!0):(h(),ve(t(ie),{key:0,data:I.row[1],style:{width:"100%"}},{default:l(()=>[e(t(G),{prop:"key",label:"名称",width:"200"},{default:l(y=>[e(t(ne),{modelValue:y.row.key,"onUpdate:modelValue":f=>y.row.key=f,placeholder:"输入名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(G),{prop:"value",label:"值",width:"200"},{default:l(y=>[e(t(ne),{modelValue:y.row.value,"onUpdate:modelValue":f=>y.row.value=f,placeholder:"输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(G),{label:"",width:"100"},{header:l(()=>[E(I.row[0])?Z("",!0):(h(),ve(t(q),{key:0,onClick:y=>s(I.row[1]),type:"text",style:{"margin-top":"10px"}},{default:l(()=>[r("添加数据")]),_:2},1032,["onClick"]))]),default:l(y=>[e(t(q),{onClick:f=>n(I.row[1],y.row),type:"danger"},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"]))]),_:1}),e(t(G),{width:"200"},{header:l(()=>[e(t(q),{onClick:J,type:"primary",style:{"margin-top":"20px"}},{default:l(()=>[r("添加设备")]),_:1})]),_:1})]),_:1},8,["data"]))}},Ca=re(xa,[["__scopeId","data-v-a82b39d4"]]);const pe=R=>(ge("data-v-0c4c326a"),R=R(),me(),R),wa={class:"page-container main-view"},Sa={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},$a={class:"left"},Ua=pe(()=>i("hr",{class:"hengxian"},null,-1)),Da=pe(()=>i("hr",{class:"hengxian3"},null,-1)),Oa=pe(()=>i("hr",{class:"hengxian3"},null,-1)),Na=pe(()=>i("hr",{class:"hengxian3"},null,-1)),Ta=pe(()=>i("hr",{class:"hengxian3"},null,-1)),Ra={__name:"index",setup(R){const c=w(!1),J=Ve(()=>JSON.stringify(D.value,null,2)),N=()=>{c.value=!0},E=()=>{let I={data:{file:"equipment.json",value:D.value},group:"siasun",account:"test",password:"123456"};console.log(I),be({method:"post",url:"/api/ctrl/jsoneditor",data:JSON.stringify(I)}).then(y=>{ae.success("请求成功");var f={type:"syncParm",data:!0};console.log(JSON.stringify(f)),be({method:"post",url:"/api/ctrl/manualdata",data:JSON.stringify(f)}).then(g=>{ae.success("同步参数")}).catch(g=>{}).finally(()=>{})}).catch(y=>{ae.error("请求失败")}).finally(()=>{})},S=w(null),s=()=>{be({method:"post",url:"/api/data/jsoneditor",data:JSON.stringify({data:"equipment.json",group:"siasun",account:"test",password:"123456"})}).then(y=>{ae.success("请求成功"),S.value=y.data,D.value=y.data,V()}).catch(y=>{ae.error("请求失败")}).finally(()=>{})},n=()=>{const I=JSON.stringify(D.value),y=new Blob([I],{type:"application/json"}),f=window.URL.createObjectURL(y),g=document.createElement("a");g.href=f,g.download="equipment.json",document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(f),document.body.removeChild(g)},o=I=>{const y=I.target.files[0],f=new FileReader;f.onload=g=>{const L=JSON.parse(g.target.result);D.value=L,V()},f.readAsText(y),ae.success("导入成功")},V=()=>{D.value.IO!==void 0&&(D.value.IO.input!==void 0&&(K.value=D.value.IO.input),D.value.IO.output!==void 0&&(Q.value=D.value.IO.output)),D.value.servo.kinco!==void 0&&D.value.servo!==void 0&&(k.value=D.value.servo.kinco)};return(I,y)=>{const f=q,g=ye,L=G,x=ne,d=ie;return h(),C("div",null,[i("div",wa,[i("div",Sa,[e(he,{height:"100%",showUpBt:!0},{default:l(()=>[i("div",$a,[e(f,{type:"info",onClick:N},{default:l(()=>[r(" 查看 ")]),_:1}),e(g,{modelValue:c.value,"onUpdate:modelValue":y[0]||(y[0]=U=>c.value=U),title:"数据",visible:c.value,onClose:y[1]||(y[1]=U=>c.value=!1),"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(he,{height:"100%",showUpBt:!0},{default:l(()=>[i("pre",null,$(J.value),1)]),_:1})]),_:1},8,["modelValue","visible"]),r("   "),e(f,{type:"primary",onClick:s},{default:l(()=>[r(" 从AGV同步参数 ")]),_:1}),e(f,{type:"primary",onClick:E},{default:l(()=>[r("同步到AGV")]),_:1}),r("   "),i("input",{ref:"importInput",type:"file",accept:".json",style:{display:"none"},onChange:o},null,544),e(f,{onClick:y[2]||(y[2]=U=>I.$refs.importInput.click()),type:"success"},{default:l(()=>[r(" 本地导入 ")]),_:1}),e(f,{type:"success",onClick:n},{default:l(()=>[r("导出到本地")]),_:1})]),Ua,e(d,{data:t(Me),style:{width:"100%"},class:"EQUversion"},{default:l(()=>[e(L,{prop:"name",label:"⚠️ 版本"}),e(L,{prop:"value"},{default:l(U=>[e(x,{modelValue:t(D).version,"onUpdate:modelValue":y[3]||(y[3]=te=>t(D).version=te),placeholder:"请选择",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"]),Da,e(ol),e(Ul),Oa,e(Rl),Na,e(Ia),Ta,e(Ca)]),_:1})])])])}}},tn=re(Ra,[["__scopeId","data-v-0c4c326a"]]);export{tn as default};

import{o as k,c as C,bH as V,by as I,bl as e,a as t,aC as Ee,F as N,aV as $,b as d,f as x,m as l,bc as n,l as G,n as nt,g as se,aK as Fe,_ as Le,p as Ne,q as Je,aY as ot,at as st,bx as at,cj as te}from"./index-02639357.js";import{D as z,b as it,S as ut,P as rt,W as ct,G as dt,A as ge,V as A,M as H,L as Me,B as Se,a as Te,E as le,Q as ne,c as O,d as _t}from"./three.module-2fa5ea98.js";import{G as mt,O as ft}from"./GLTFLoader-8d8d2fbb.js";import{D as vt}from"./DRACOLoader-40a28629.js";import{i as E,s as S,p as T,c as Y,a as o,b as a,d as qe,e as he,N as pt,f as bt,g as gt,h as Ae,j as ht,k as xt,l as wt,m as yt,n as $t,o as kt,q as Ct,r as Vt,t as It,u as oe,v as Et,w as Oe,x as Re,y as Mt,z as St,A as Tt,B as Dt,C as Ft,D as Lt,E as Nt,F as Jt,G as qt,H as At,I as Ot,J as Rt,K as Pe,L as Pt,M as Bt,O as Xt,P as De,Q as jt,R as Gt,S as Yt,T as Ut,U as zt,V as Ht,W as Qt,X as Wt,Y as Q,Z as Zt,_ as Z,$ as K,a0 as Kt,a1 as ae,a2 as el}from"./bbb_Aqw-14022fad.js";import{E as R}from"./el-dialog-4d9a1aad.js";import{i as Be}from"./index-c13506ae.js";const tl=["disabled","title"],ll=["disabled","title"],nl=["disabled"],ol={__name:"contorl",setup(y){const c=()=>{Y.value=!Y.value,Y.value?controls.enabled=!1:controls.enabled=!0},r=()=>{o.value=0,a.value=[],a.value=qe.concat()},f=()=>{T.value=!T.value},b=()=>{if(S.value){const m=a.value[o.value].logJson.event.name;for(;a.value[o.value].logJson.event.name===m&&!(o.value===a.value.length-1||o.value===0);)o.value++;he.value=1,S.value=!1}};return(m,s)=>(k(),C(N,null,[V(t("div",null,[t("button",{disabled:e(S),onClick:f,class:Ee({playbuttonstyle:e(T),stopbuttonstyle:!e(T)}),title:e(T)?"播放":e(S)?"请处理事件":"暂停"},null,10,tl)],512),[[I,!e(E)]]),V(t("div",null,[t("button",{disabled:!e(S),onClick:b,class:"eventbuttonstyle",title:e(S)?"事件跳过":"无事件"},null,8,ll)],512),[[I,!e(E)]]),V(t("div",null,[t("button",{disabled:e(S),onClick:r,class:"replaybuttonstyle",title:"重播"},null,8,nl)],512),[[I,!e(E)]]),V(t("div",null,[t("button",{onClick:c,class:Ee({genbuttonstyle:e(Y),bugenbuttonstyle:!e(Y)}),title:"镜头跟随"},null,2)],512),[[I,!e(E)]])],64))}};const sl=t("br",null,null,-1),al=t("br",null,null,-1),il=t("br",null,null,-1),ul=t("br",null,null,-1),rl=t("br",null,null,-1),cl=t("br",null,null,-1),dl=t("br",null,null,-1),_l=t("br",null,null,-1),ml=t("br",null,null,-1),fl=t("br",null,null,-1),vl=t("br",null,null,-1),pl=t("br",null,null,-1),bl=t("br",null,null,-1),gl=t("br",null,null,-1),hl=t("br",null,null,-1),xl=t("br",null,null,-1),wl=t("br",null,null,-1),yl={__name:"Contral_Net",setup(y){const c=$(!1),r=()=>{c.value=!0};return(f,b)=>{const m=G,s=R;return k(),C(N,null,[V(d(m,{class:"EXButton",onClick:r},{default:x(()=>[l("控制台")]),_:1},512),[[I,!e(E)]]),d(s,{modelValue:c.value,"onUpdate:modelValue":b[0]||(b[0]=_=>c.value=_),title:"控制台","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[l(" 开始节点："+n(e(pt)),1),sl,l(" 目标节点："+n(e(bt)),1),al,il,l(" 当前进度量："+n(e(gt)),1),ul,l(" 控制台设置速度："+n(e(Ae)),1),rl,cl,l(" 货物状态："+n(e(ht)),1),dl,l(" 工作状态："+n(e(xt)),1),_l,ml,l(" 1级故障码:"+n(e(wt)),1),fl,l(" 2级故障码:"+n(e(yt)),1),vl,pl,l(" 电池状态："+n(e($t)),1),bl,l(" 任务状态："+n(e(kt)),1),gl,l(" 任务号："+n(e(Ct)),1),hl,l(" 动作key："+n(e(Vt)),1),xl,l(" heading:"+n(e(It)),1),wl]),_:1},8,["modelValue"])],64)}}};const $l=t("br",null,null,-1),kl=t("br",null,null,-1),Cl=t("br",null,null,-1),Vl=t("br",null,null,-1),Il=t("br",null,null,-1),El={__name:"Info_box",setup(y){let c="AGV状态";return(r,f)=>e(oe)?(k(),C("div",{key:0,class:"info-text",style:nt({left:e(Oe)+"px",top:e(Re)+"px"})},[l(n(e(c)),1),$l,l(" 时间："+n(e(a)[e(o)].logDateTime),1),kl,l(" 车体软件版本："+n(),1),Cl,l(" 车号："+n(),1),Vl,l(" 模式："+n(e(Et)),1),Il],4)):se("",!0)}};const Ml=t("br",null,null,-1),Sl=t("br",null,null,-1),Tl=t("br",null,null,-1),Dl=t("br",null,null,-1),Fl=t("br",null,null,-1),Ll=t("br",null,null,-1),Nl=t("br",null,null,-1),Jl=t("br",null,null,-1),ql=t("br",null,null,-1),Al=t("br",null,null,-1),Ol=t("br",null,null,-1),Rl=t("br",null,null,-1),Pl=t("br",null,null,-1),Bl=t("br",null,null,-1),Xl=t("br",null,null,-1),jl=t("br",null,null,-1),Gl={__name:"AGV_device",setup(y){const c=$(!1),r=()=>{c.value=!0};return(f,b)=>{const m=G,s=R;return k(),C(N,null,[V(d(m,{class:"EXButtonDEV",onClick:r},{default:x(()=>[l("车体设备")]),_:1},512),[[I,!e(E)]]),d(s,{modelValue:c.value,"onUpdate:modelValue":b[0]||(b[0]=_=>c.value=_),title:"车体设备","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[l(" 转盘纵向开关："+n(e(a)[e(o)].logJson.equipmentInfo.rack.turn_axis.bZero?"🔴":"🟢"),1),Ml,l(" 转盘横向开关："+n(e(a)[e(o)].logJson.equipmentInfo.rack.turn_axis.bLevel?"🔴":"🟢"),1),Sl,l(" 转盘位置:"+n(e(a)[e(o)].trunpan.toFixed(3)),1),Tl,Dl,l(" 举升高位开关："+n(e(a)[e(o)].logJson.equipmentInfo.rack.lifter_axis.bTop?"🔴":"🟢"),1),Fl,l(" 举升零位开关："+n(e(a)[e(o)].logJson.equipmentInfo.rack.lifter_axis.bBottom?"🔴":"🟢"),1),Ll,l(" 举升位置："+n(e(a)[e(o)].lifter.toFixed(3)),1),Nl,Jl,l(" 当前设备状态："+n(e(Mt)),1),ql,l(" 当前设备任务号："+n(e(St)),1),Al,l(" 当前设备任务状态："+n(e(Tt)),1),Ol,l(" 当前设备故障码:  "+n(e(Dt)),1),Rl,l(" 当前设备动作步骤: "+n(e(Ft)),1),Pl,l(" 当前动作轴id: "+n(),1),Bl,l(" 当前动作轴位置: "+n(),1),Xl,l(" 当前动作轴开关状态: "+n(),1),jl]),_:1},8,["modelValue"])],64)}}};const Yl=t("br",null,null,-1),Ul=t("br",null,null,-1),zl=t("br",null,null,-1),Hl=t("br",null,null,-1),Ql=t("br",null,null,-1),Wl=t("br",null,null,-1),Zl=t("br",null,null,-1),Kl=t("br",null,null,-1),en=t("br",null,null,-1),tn=t("br",null,null,-1),ln=t("br",null,null,-1),nn=t("br",null,null,-1),on=t("br",null,null,-1),sn=t("div",{class:"bingzhuang",id:"main1",style:{width:"300px",height:"300px"}},null,-1),an={__name:"AGV_Nav",setup(y){const c=$(!1),r=()=>{c.value=!0},f=()=>{const b=document.getElementById("main1"),m=Be(b),s=[{value:Math.round(Math.random()*1e3),name:"占用一"},{value:Math.round(Math.random()*1e3),name:"占用二"},{value:Math.round(Math.random()*1e3),name:"占用三"},{value:Math.round(Math.random()*1e3),name:"占用四"},{value:Math.round(Math.random()*1e3),name:"占用五"}],_={title:{text:"占用",textStyle:{color:"black"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,data:s.map(h=>h.name)},series:[{name:"测试数据",type:"pie",radius:"50%",center:["50%","50%"],data:s,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};setInterval(()=>{s.forEach(h=>{h.value=Math.round(Math.random()*1e3)}),m.setOption({series:[{data:s}]})},1e3),m.setOption(_)};return(b,m)=>{const s=G,_=R;return k(),C(N,null,[V(d(s,{class:"EXButtonNAV",onClick:r},{default:x(()=>[l("导航")]),_:1},512),[[I,!e(E)]]),d(_,{modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=h=>c.value=h),title:"导航","custom-class":"custom-dialog",onOpened:f,modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[l(" 导航软件版本："+n(e(Lt)),1),Yl,l(" 导航环境模型版本："+n(e(Nt)),1),Ul,zl,l(" 目标位置:"+n(e(Jt))+" ",1),Hl,l(" 当前位置："+n(e(qt)),1),Ql,l(" 理论位置："+n(e(At)),1),Wl,Zl,l(" 左右偏差："+n(e(Ot)),1),Kl,l(" 角度偏差："+n((e(Rt)*180/Math.PI).toFixed(3)),1),en,tn,l(" 发送速度："+n(),1),ln,l(" 发送舵角："+n(),1),nn,on,sn]),_:1},8,["modelValue"])],64)}}},Xe={__name:"Ele_chart",setup(y){const c=$(null),r=(()=>{let s=new Date,_=[],h=5;for(;h--;)_.unshift(s.toLocaleTimeString().replace(/^\D*/,"")),s=new Date(+s-500);return _})(),f=(()=>{let s=[],_=5;for(;_--;)s.push(Math.round(Math.random()*1e3));return s})(),b=(()=>{let s=[],_=5;for(;_--;)s.push(Math.round(Math.random()*1e3));return s})();let m={title:{text:"车速",textStyle:{color:"white"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#283b56"}}},legend:{},toolbox:{show:!0,feature:{dataView:{readOnly:!1},magicType:{type:["bar","line","stack"]},restore:{},saveAsImage:{}},bottom:10},xAxis:{type:"category",data:r,boundaryGap:!0},yAxis:{type:"value"},series:[{data:f,type:"line",name:"实际",color:"green",markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]}},{data:b,name:"理论",type:"line",color:"yellow",markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]}}]};return Fe(()=>{const s=Be(c.value);setInterval(()=>{let _=(Pe.value*1e3).toFixed(2),h=new Date().toLocaleTimeString().replace(/^\D*/,"");r.shift(),r.push(h),f.shift(),f.push(_),b.shift(),b.push(Ae.value),s.setOption({xAxis:[{data:r}],series:[{data:f},{data:b}]})},400),s.setOption(m)}),(s,_)=>(k(),C("div",{class:"chart",id:"main2",style:{width:450+"px",height:200+"px"},ref_key:"main2",ref:c},null,512))}};const g=y=>(Ne("data-v-ddf5eefb"),y=y(),Je(),y),un=g(()=>t("br",null,null,-1)),rn=g(()=>t("br",null,null,-1)),cn=g(()=>t("br",null,null,-1)),dn=g(()=>t("br",null,null,-1)),_n=g(()=>t("br",null,null,-1)),mn=g(()=>t("br",null,null,-1)),fn=g(()=>t("br",null,null,-1)),vn=g(()=>t("br",null,null,-1)),pn=g(()=>t("br",null,null,-1)),bn=g(()=>t("br",null,null,-1)),gn=g(()=>t("br",null,null,-1)),hn=g(()=>t("br",null,null,-1)),xn=g(()=>t("br",null,null,-1)),wn=g(()=>t("br",null,null,-1)),yn=g(()=>t("br",null,null,-1)),$n=g(()=>t("br",null,null,-1)),kn=g(()=>t("br",null,null,-1)),Cn=g(()=>t("br",null,null,-1)),Vn=g(()=>t("br",null,null,-1)),In=g(()=>t("br",null,null,-1)),En=g(()=>t("br",null,null,-1)),Mn=g(()=>t("br",null,null,-1)),Sn=g(()=>t("br",null,null,-1)),Tn=g(()=>t("br",null,null,-1)),Dn=g(()=>t("br",null,null,-1)),Fn=g(()=>t("br",null,null,-1)),Ln=g(()=>t("br",null,null,-1)),Nn={__name:"AGV_ELE",setup(y){const c=$(!1),r=()=>{c.value=!0},f=()=>{Q.value<Zt.value-1?Q.value++:Q.value=0,console.log(Q.value),De.value="驱动轴"+Q.value.toString(),Z(),K()};return(b,m)=>{const s=G,_=R;return k(),C(N,null,[V(d(s,{class:"EXButtonELE",onClick:r},{default:x(()=>[l("电器模块")]),_:1},512),[[I,!e(E)]]),d(_,{modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=h=>c.value=h),title:"电器模块","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[l(" 保险杠状态："+n(e(Pt)),1),un,l(" 急停触发："+n(e(Bt)),1),rn,l(" pls状态："+n(e(Xt)),1),cn,dn,l(" 二维码:"),_n,l(" x:"+n(e(a)[e(o)].logJson.electricalModule.sensor.camera.fx.toFixed(4)),1),mn,l(" y:"+n(e(a)[e(o)].logJson.electricalModule.sensor.camera.fy.toFixed(4)),1),fn,l(" 角度:"+n(e(a)[e(o)].logJson.electricalModule.sensor.camera.fthita.toFixed(4)),1),vn,pn,l(" 电量百分比："+n(e(a)[e(o)].logJson.electricalModule.sensor.battmetr.fCapPercent.toFixed(2)),1),bn,l(" 电池状态："+n(e(a)[e(o)].logJson.electricalModule.sensor.battmetr.sState),1),gn,hn,l(" 磁导航偏差1:"+n(e(a)[e(o)].logJson.electricalModule.sensor.magnetic.fDev[0]),1),xn,l(" 磁导航偏差2:"+n(e(a)[e(o)].logJson.electricalModule.sensor.magnetic.fDev[1]),1),wn,l(" 磁导航状态:"+n(e(a)[e(o)].logJson.electricalModule.sensor.magnetic.sGrade),1),yn,$n,l(" 惯导："+n(),1),kn,l(" 切换驱动单元："),d(s,{class:"buttonstyle",onClick:f},{default:x(()=>[l(n(e(De)),1)]),_:1}),Cn,l(" 轮伺服实际速度："+n(e(Pe)),1),Vn,l(" 轮伺服状态码："+n(e(jt)),1),In,l(" 轮伺服错误码："+n(e(Gt)),1),En,l(" 舵伺服实际位置："+n(e(Yt)),1),Mn,l(" 舵伺服状态码："+n(e(Ut)),1),Sn,l(" 舵伺服错误码："+n(e(zt)),1),Tn,l(" 舵限位开关："+n(e(Ht)),1),Dn,l(" 舵限位开关："+n(e(Qt)),1),Fn,l(" 舵零位开关："+n(e(Wt)),1),Ln,d(Xe)]),_:1},8,["modelValue"])],64)}}},Jn=Le(Nn,[["__scopeId","data-v-ddf5eefb"]]);const qn=t("br",null,null,-1),An=t("br",null,null,-1),On=t("br",null,null,-1),Rn=t("br",null,null,-1),Pn={__name:"event",setup(y){$(0);const c=$(!1),r=()=>{c.value=!0};return(f,b)=>{const m=G,s=R;return k(),C(N,null,[V(d(m,{class:"EVENTButton",onClick:r},{default:x(()=>[l("事件信息")]),_:1},512),[[I,!f.importflag]]),d(s,{modelValue:c.value,"onUpdate:modelValue":b[0]||(b[0]=_=>c.value=_),title:"事件信息","custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[l(" 发送时间："+n(e(a)[e(o)].logDateTime),1),qn,l(" 事件："+n(e(a)[e(o)].logJson.event.name),1),An,l(" 原因："+n(e(a)[e(o)].logJson.event.detail),1),On,l(" AGV建议:"+n(e(a)[e(o)].logJson.event.advise),1),Rn]),_:1},8,["modelValue"])],64)}}};const Bn=t("br",null,null,-1),Xn={key:0,class:"parsedItemsdata"},jn={key:0},Gn={__name:"statistics",setup(y){const c=$(!1);let r=$(0);const f=()=>{c.value=!0},b=$(!1),m=()=>{console.log("11111",a.value),b.value=!0},s=()=>{r.value>0&&r.value--},_=()=>{r.value<a.value[o.value].parsedItems.length-1&&r.value++};return(h,P)=>{const B=G,X=R;return k(),C(N,null,[V(d(B,{class:"EXButtonstatistics",onClick:f},{default:x(()=>[l("统计")]),_:1},512),[[I,!e(E)]]),d(X,{title:"统计",modelValue:c.value,"onUpdate:modelValue":P[0]||(P[0]=F=>c.value=F),"custom-class":"custom-dialog",style:{width:"80%",height:"70%"},modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[d(Kt)]),_:1},8,["modelValue"]),V(d(B,{class:"EXButtonreseve",onClick:m},{default:x(()=>[l("预留")]),_:1},512),[[I,!e(E)]]),d(X,{title:"预留",modelValue:b.value,"onUpdate:modelValue":P[1]||(P[1]=F=>b.value=F),"custom-class":"custom-dialog",modal:!1,draggable:"","close-on-click-modal":!1,"modal-class":"kk-dialog-class"},{default:x(()=>[d(B,{onClick:s},{default:x(()=>[l("＜")]),_:1}),d(B,{onClick:_},{default:x(()=>[l("＞")]),_:1}),Bn,e(a)[e(o)].parsedItems?(k(),C("div",Xn,[e(a)[e(o)].parsedItems[e(r)]!==void 0?(k(),C("div",jn,[t("h2",null,n(e(a)[e(o)].parsedItems[e(r)].itemName),1),(k(!0),C(N,null,ot(e(a)[e(o)].parsedItems[e(r)].itemObject,(F,v)=>(k(),C("div",{key:v},n(v)+": "+n(F),1))),128))])):se("",!0)])):se("",!0)]),_:1},8,["modelValue"])],64)}}},Yn=t("br",null,null,-1),Un=t("br",null,null,-1),zn=t("br",null,null,-1),Hn={__name:"screen_info",setup(y,{expose:c}){const r=$(!1),f=$(!1);return c({handleMouseClick:m=>{const s=ae.intersectObjects([m]);s.length>0&&(console.log("modelname:",s[0].object.name),s[0].object.name==="screen"||s[0].object.name==="screen1"||s[0].object.name==="screen2"||s[0].object.name==="screen3"||s[0].object.name==="screen4"?(f.value=!0,r.value=!0):(r.value=!1,f.value=!1))}}),(m,s)=>{const _=R;return k(),C(N,null,[d(_,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=h=>f.value=h),title:"屏幕2","custom-class":"custom-dialog2",onOpened:m.openDialog,modal:!1},{default:x(()=>[d(Xe)]),_:1},8,["modelValue","onOpened"]),d(_,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=h=>r.value=h),title:"屏幕","custom-class":"custom-dialog3",modal:!1},{default:x(()=>[l(" 屏幕型号:"+n(),1),Yn,l(" 通讯类型:"+n(),1),Un,l(" 手控设备信息:"+n(),1),zn]),_:1},8,["modelValue"])],64)}}},Qn=t("br",null,null,-1),Wn=t("br",null,null,-1),Zn=t("br",null,null,-1),Kn=t("br",null,null,-1),eo=t("br",null,null,-1),to=t("br",null,null,-1),lo=t("br",null,null,-1),no=t("br",null,null,-1),oo=t("br",null,null,-1),so=t("br",null,null,-1),ao=t("br",null,null,-1),io=t("br",null,null,-1),uo={__name:"wheel_info",setup(y,{expose:c}){const r=$(!1),f=$(!1);return c({handleMouseClickwheel:m=>{const s=ae.intersectObjects([m]);s.length>0&&(s[0].object.name==="rightwheel"||s[0].object.name==="rightwheel1"||s[0].object.name==="rightwheel2"?r.value=!0:r.value=!1,s[0].object.name==="leftwheel"||s[0].object.name==="leftwheel1"||s[0].object.name==="leftwheel2"?f.value=!0:f.value=!1)}}),(m,s)=>{const _=R;return k(),C(N,null,[d(_,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=h=>r.value=h),title:"右轮","custom-class":"custom-dialog3",modal:!1},{default:x(()=>[l(" 驱动内坐标X:"+n(),1),Qn,l(" 驱动内坐标Y:"+n(),1),Wn,l(" 电机减速比:"+n(),1),Zn,l(" 车轮直径:"+n(),1),Kn,l(" 码盘线束:"+n(),1),eo,l(" 最大转速:"+n(),1),to]),_:1},8,["modelValue"]),d(_,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=h=>f.value=h),title:"左轮","custom-class":"custom-dialog2",modal:!1},{default:x(()=>[l(" 驱动内坐标X:"+n(),1),lo,l(" 驱动内坐标Y:"+n(),1),no,l(" 电机减速比:"+n(),1),oo,l(" 车轮直径:"+n(),1),so,l(" 码盘线束:"+n(),1),ao,l(" 最大转速:"+n(),1),io]),_:1},8,["modelValue"])],64)}}};const ro=y=>(Ne("data-v-ad899185"),y=y(),Je(),y),co={class:"home"},_o={class:"choose"},mo=ro(()=>t("div",{class:"choose-title"},"控制：",-1)),fo={class:"file-upload"},vo={class:"logprocess"},po=["disabled","max"],bo=["disabled","title"],go=["disabled","title"],ho={key:0},W=500,xo={__name:"index",setup(y){$(0);const c=$(null),r=$(null),f=new mt,b=new vt;b.setDecoderPath("https://asdqvqw.github.io/whwtest.github.io/draco/"),f.setDRACOLoader(b);const m=$(0),s=new z(16777215,1);s.position.set(0,0,10);const _=new z(16777215,1);_.position.set(0,0,-10);const h=new z(16777215,1);h.position.set(10,0,0);const P=new z(16777215,1);P.position.set(-10,0,0);const B=new z(16777215,1);B.position.set(0,10,0);let X,F,v,xe=$(null),je=7;const ie=new it,D=new ut,j=new rt(75,window.innerWidth/window.innerHeight,.1,1e3);j.position.set(0,2,6);const Ge=i=>{const u=i.target.files[0],p=new FileReader;p.onload=M=>{const J=String(M.target.result);Ye(J)},p.readAsText(u)},Ye=i=>{te.success("开始导入数据...");const u=i.split("[INFO | ");for(let p=1;p<u.length;p++){const M=u[p],J=M.indexOf("]"),L=M.substring(0,J).trim(),U=M.substring(J+3).trim(),w=JSON.parse(U),q=w.navInfo.fRealX.toFixed(3),ke=w.navInfo.fRealY.toFixed(3),Ce=0,Ve=(w.navInfo.fRealThita*180/Math.PI).toFixed(3);let de="",_e="";w.equipmentInfo.rack!==void 0&&(de=w.equipmentInfo.rack.turn_axis.fAxisPosition/1e3,_e=w.equipmentInfo.rack.lifter_axis.fAxisPosition);let me="";w.uAgvType!==void 0&&(me=w.uAgvType);let fe=[];if(w.item!==void 0){const et=w.item;for(const pe of et){const tt=pe.name;let Ie={};for(const be in pe)if(be!=="name"){const lt=pe[be];Ie[be]=lt}fe.push({itemName:tt,itemObject:Ie})}}let ve="";w.statistics!==void 0&&(ve=w.statistics),a.value.push({logDateTime:L,logJson:w,realx:q,realy:ke,realthita:Ve,realz:Ce,agvType:me,parsedItems:fe,trunpan:de,lifter:_e,StatisticsData:ve}),qe.push({logDateTime:L,logJson:w,realx:q,realy:ke,realthita:Ve,realz:Ce,agvType:me,parsedItems:fe,trunpan:de,lifter:_e,StatisticsData:ve})}te.success("开始导入模型..."),el.parsedLogData_b=a.value,m.value=a.value.length-1,a.value[0].agvType===0?(f.load("./main/test.glb",p=>{v=p.scene,v.position.set(0,0,0),v.scale.set(1,.6,.7),v.rotation.set(0,H.degToRad(90),0),D.add(v),we(),ye(),$e()},p=>{console.log(p.loaded/p.total*100+"% loaded")},p=>{console.error("Error loading model:",p)}),te.success("导入完成")):te.error("没有匹配模型"),E.value=!1,Ue()},Ue=()=>{const i=new Me({color:255,linewidth:1}),u=a.value.map(q=>new A(q.realx,q.realz,-q.realy)),p=new Se().setFromPoints(u);let M=new Te(p,i);const J=new Me({color:16711680,linewidth:1}),L=a.value.map(q=>new A(q.logJson.tcInfo.iDevX/1e3,0,-q.logJson.tcInfo.iDevY/1e3)),U=new Se().setFromPoints(L);let w=new Te(U,J);o.value=0,D.add(M),D.add(w),re()},ze=()=>{if(v&&o.value>0){o.value--;const i=a.value[o.value];v.position.set(i.realx,0,-i.realy);const u=new le(0,H.degToRad(a.value[o.value-1].realthita),0,"XYZ"),p=new ne().setFromEuler(u);v.setRotationFromQuaternion(p),Z(),K()}},He=()=>{if(v&&T.value&&o.value>0){o.value--;const i=a.value[o.value];v.position.set(i.realx,0,-i.realy);const u=new le(0,H.degToRad(a.value[o.value-1].realthita),0,"XYZ"),p=new ne().setFromEuler(u);v.setRotationFromQuaternion(p),Z(),K()}},Qe=()=>{if(v&&T.value&&o.value<a.value.length-1){o.value++;const i=a.value[o.value];v.position.set(i.realx,0,-i.realy);const u=new le(0,H.degToRad(a.value[o.value+1].realthita),0,"XYZ"),p=new ne().setFromEuler(u);v.setRotationFromQuaternion(p),Z(),K()}},We=i=>{ie.x=i.clientX/window.innerWidth*2-1,ie.y=-(i.clientY/window.innerHeight)*2+1,ae.setFromCamera(ie,j),v!==void 0&&(ae.intersectObjects([v]).length>0?(Oe.value=i.clientX+10,Re.value=i.clientY+10,oe.value=!0):oe.value=!1)},Ze=()=>{oe.value=!1},ee=new ct({antialias:!0});ee.setSize(window.innerWidth,window.innerHeight);const Ke=()=>{if(v&&!T.value&&!S.value&&a.value[o.value]&&a.value[o.value+1]){o.value++;const i=a.value[o.value];v.position.set(i.realx,0,-i.realy);const u=new le(0,H.degToRad(a.value[o.value].realthita),0,"XYZ"),p=new ne().setFromEuler(u);v.setRotationFromQuaternion(p),Z(),K(),a.value[o.value].logJson.nAgvState===3&&a.value[o.value].logJson.event.name!==""&&(he.value=2,S.value=!0)}};let ue=0;const re=()=>{ue++,ue>=je&&(Ke(),ue=0),Y.value&&v&&(j.position.copy(v.position),j.position.y+=6,j.lookAt(v.position)),ee.render(D,j),X&&X.update(),requestAnimationFrame(re)},we=()=>{v.traverse(i=>{if(i.name==="upDown"&&(i.rotation.y=a.value[o.value].trunpan.toFixed(2),i.position.y=a.value[o.value].lifter+1e3),i.name==="leftwheel"&&(i.rotation.z+=a.value[o.value].logJson.electricalModule.kinematic.drive[0].wheel.fServoSpeed.toFixed(5)*.5),i.name==="rightwheel"&&(i.rotation.z+=a.value[o.value].logJson.electricalModule.kinematic.drive[1].wheel.fServoSpeed.toFixed(5)*.5),i.name==="turnnei")if(a.value[o.value].logJson.equipmentInfo.rack.turn_axis.bLevel){const u=new O({color:16711680});i.material=u}else{const u=new O({color:65280});i.material=u}if(i.name==="turnwai")if(a.value[o.value].logJson.equipmentInfo.rack.turn_axis.bZero){const u=new O({color:16711680});i.material=u}else{const u=new O({color:65280});i.material=u}if(i.name==="liftertop")if(a.value[o.value].logJson.equipmentInfo.rack.lifter_axis.bTop){const u=new O({color:16711680});i.material=u}else{const u=new O({color:65280});i.material=u}if(i.name==="lifterbuttom")if(a.value[o.value].logJson.equipmentInfo.rack.lifter_axis.bBottom){const u=new O({color:16711680});i.material=u}else{const u=new O({color:65280});i.material=u}}),requestAnimationFrame(we)},ye=()=>{v.traverse(i=>{if(i.name==="screen2"){const u=Math.random()*16777215;i.material.color.setHex(u)}}),setTimeout(ye,200)};let ce=1;const $e=()=>{const u={1:{on:65280,off:16777215},2:{on:16711680,off:16777215}}[he.value],p=u.on,M=u.off,J=(L,U)=>{L.traverse(w=>{w instanceof _t&&(w.material.color.clone(),w.material.color.set(U))})};v.traverse(L=>{L.name==="light"&&(ce===1?J(L,p):J(L,M))}),ce=1-ce,setTimeout($e,500)};return Fe(()=>{window.addEventListener("mousemove",We),window.addEventListener("mouseout",Ze),window.addEventListener("click",()=>{c.value.handleMouseClick(v)}),window.addEventListener("click",()=>{r.value.handleMouseClickwheel(v)}),xe.value.appendChild(ee.domElement),F=new dt(W,W),F.material.opacity=.3,F.material.transparent=!0,D.add(F);const i=new ge(new A(1,0,0),new A(0,0,0),W/2,16711680),u=new ge(new A(0,0,0),new A(0,0,0),W/2,65280),p=new ge(new A(0,0,-1),new A(0,0,0),W/2,255);D.add(i,u,p),X=new ft(j,ee.domElement),X.update(),D.add(s),D.add(_),D.add(h),D.add(P),D.add(B),re()}),(i,u)=>{const p=G;return k(),C("div",co,[t("div",{class:"canvas-container",ref_key:"canvasDom",ref:xe},null,512),t("div",_o,[mo,V(t("div",fo,[t("input",{ref:"importInput",type:"file",accept:".log",style:{display:"none"},onChange:Ge},null,544),d(p,{onClick:u[0]||(u[0]=M=>i.$refs.importInput.click()),class:"buttonstyle"},{default:x(()=>[l(" 导入 ")]),_:1})],512),[[I,e(E)]]),V(t("div",vo,[l(" 回放进度:"+n(e(S)?"请处理事件":e(a)[e(o)]===void 0?"":e(a)[e(o)].logDateTime)+" ",1),V(t("input",{disabled:e(S),type:"range",style:{width:"100%"},"onUpdate:modelValue":u[1]||(u[1]=M=>st(o)?o.value=M:null),min:"0",max:m.value,step:"1",onChange:ze},null,40,po),[[at,e(o)]])],512),[[I,!e(E)]]),d(ol),V(t("div",null,[t("button",{disabled:!e(T)||e(o)===e(a).length+1,onClick:He,class:"next2playbuttonstyle",title:e(T)?"上一步":"请暂停"},null,8,bo),t("button",{disabled:!e(T)||e(o)===e(a).length-1,onClick:Qe,class:"nextplaybuttonstyle",title:e(T)?"下一步":"请暂停"},null,8,go)],512),[[I,!e(E)]]),d(El)]),d(Gl),d(Jn),e(S)?(k(),C("div",ho,[d(Pn)])):se("",!0),d(Gn),d(an),d(Hn,{ref_key:"screenRef",ref:c},null,512),d(uo,{ref_key:"wheelRef",ref:r},null,512),d(yl)])}}},Eo=Le(xo,[["__scopeId","data-v-ad899185"]]);export{Eo as default};

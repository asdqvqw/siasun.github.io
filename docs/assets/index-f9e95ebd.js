import{aV as S,bB as $e,o as k,c as w,F as G,aY as X,b as e,f as l,a as s,bc as U,m as c,g as Z,E as te,_ as re,bl as t,cv as ne,l as H,p as me,q as pe,bC as Oe,Q as he,aK as Te,aC as oe,e as ve,cw as ye,cq as Re,cE as Ee}from"./index-b0ecd0e2.js";import{E as z,a as ie}from"./el-table-column-0fbfcdf8.js";/* empty css                    */import"./el-tag-1c9b9b70.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-46f78303.js";import"./el-scrollbar-cfb52138.js";import{E as Ve}from"./el-dialog-81c580fc.js";import{_ as ke}from"./DefinScrollbar-60b87f2b.js";import{I as K,j as N,a as Q,s as I,f as be,c as Ae,E as Me}from"./common-135771f7.js";/* empty css                */import{E as Ie,a as xe}from"./el-form-item-a975c8f3.js";import{E as Ce,a as we}from"./el-select-18bea2a8.js";/* empty css                 */import{E as Ue}from"./index-597be993.js";import{E as Be}from"./el-switch-f2f60d71.js";import"./8Array-a07d27a6.js";import"./CloneObject-35753c54.js";import"./index-c403d069.js";import"./isEqual-71d35f7f.js";import"./debounce-3b44010e.js";/* empty css                                                                       */import"./index-2984069a.js";const fe=S(!1),ge=S(!1),_=S({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1}),b=S({name:"",key:"",config:[1,1,1,1,1,1],editingIndex:-1});S(!1);S({name:"",value:[1,1,1,1,1,1],editingIndex:-1});const a=S({name:"",key:"",config:{portID:0,unitID:0,canID:0,axisID:0,ratio:0,encoder:0,unitDist:0,maxRPM:0,normalvel:0,slowvel:0,neartarget:0,ontarget:0,motorDir:0,encoderDir:0,originmode:0,maxHeight:0,radius:0,isturn:0,syncFineVel:0,syncDir:0,syncVelRatioUp:0,steadyHeight:0},editingIndex:-1});S({id:-1,note:"",taskList:[],editingIndex:-1});const Je={key:0},Le=s("br",null,null,-1),je=s("br",null,null,-1),Pe=s("br",null,null,-1),He={key:1},Fe=s("br",null,null,-1),qe=s("br",null,null,-1),ze=s("br",null,null,-1),Ge={key:2},Ye=s("br",null,null,-1),Ke=s("br",null,null,-1),Qe={key:3},We=s("br",null,null,-1),Xe=s("br",null,null,-1),Ze=s("br",null,null,-1),el={key:4},ll=s("br",null,null,-1),al={__name:"IO",setup(A){const f=S("1"),L=S(!0),T=S(!1),M=S(!1),j=S(!1),i=S(!1),n=S("1"),o=S("1"),p=S("1"),C=S("1"),y=S(""),V=S(""),r=()=>{if(f.value==="2"||f.value==="3"||f.value==="5")_.value.config=[parseInt(f.value),parseInt(n.value),parseInt(o.value),parseInt(p.value),parseInt(C.value)];else if(f.value==="1")_.value.config=[parseInt(f.value),0,parseInt(n.value),parseInt(o.value),parseInt(p.value)];else if(f.value==="4"){const B=parseInt(n.value,16);y.value=isNaN(B)?"":B.toString(),_.value.config=[parseInt(f.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",_.value.config)},$=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],d=()=>{if(_.value.config.value!==void 0){if(_.value.config.value[0]===2||_.value.config.value[0]===3||_.value.config.value[0]===5)f.value=_.value.config.value[0].toString(),n.value=_.value.config.value[1].toString(),o.value=_.value.config.value[2].toString(),p.value=_.value.config.value[3].toString(),C.value=_.value.config.value[4].toString(),D();else if(_.value.config.value[0]===1)f.value=_.value.config.value[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),p.value=_.value.config.value[4].toString(),D();else if(_.value.config.value[0]===4){f.value=_.value.config.value[0].toString();const B=parseInt(_.value.config.value[3],10);V.value=isNaN(B)?"":B.toString(16),n.value=V.value.toString(),o.value=_.value.config.value[4].toString(),D()}}else if(_.value.config!==void 0){if(_.value.config[0]===2||_.value.config[0]===3||_.value.config[0]===5)f.value=_.value.config[0].toString(),n.value=_.value.config[1].toString(),o.value=_.value.config[2].toString(),p.value=_.value.config[3].toString(),C.value=_.value.config[4].toString(),D();else if(_.value.config[0]===1)f.value=_.value.config[0].toString(),n.value=_.value.config.value[2].toString(),o.value=_.value.config.value[3].toString(),p.value=_.value.config.value[4].toString(),D();else if(_.value.config[0]===4){f.value=_.value.config[0].toString();const B=parseInt(_.value.config[3],10);V.value=isNaN(B)?"":B.toString(16),n.value=V.value.toString(),o.value=_.value.config.value[4].toString(),D()}}else f.value="1",n.value="1",o.value="1",p.value="1",C.value="1",D(),console.log("putJSONelse")},D=()=>{switch(console.log("handleChange",f.value),f.value){case"1":L.value=!0,T.value=!1,M.value=!1,j.value=!1,i.value=!1,r();return;case"2":L.value=!1,T.value=!0,M.value=!1,j.value=!1,i.value=!1,r();return;case"3":L.value=!1,T.value=!1,M.value=!0,j.value=!1,i.value=!1,r();return;case"4":L.value=!1,T.value=!1,M.value=!1,j.value=!0,i.value=!1,r();return;case"5":L.value=!1,T.value=!1,M.value=!1,j.value=!1,i.value=!0,r();return}};d();let ue=0;return $e(fe,()=>{const B=Date.now();B-ue>=700&&(d(),ue=B)}),(B,g)=>{const le=Ue,m=Ce,J=we,de=te;return k(),w("div",null,[(k(),w(G,null,X($,(v,F)=>e(le,{key:F,modelValue:f.value,"onUpdate:modelValue":g[0]||(g[0]=P=>f.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),T.value?(k(),w("div",Je,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Le,c(" CAN-POS模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[2]||(g[2]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),je,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[3]||(g[3]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Pe,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[4]||(g[4]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),M.value?(k(),w("div",He,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[5]||(g[5]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Fe,c(" CAN-OPEN模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[6]||(g[6]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),qe,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[7]||(g[7]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),ze,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[8]||(g[8]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),L.value?(k(),w("div",Ge,[c(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":g[9]||(g[9]=v=>n.value=v),type:"number",onChange:r},null,8,["modelValue"]),Ye,c(" 输出点对应位: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[10]||(g[10]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"BIT1",value:"0"}),e(m,{label:"BIT2",value:"1"}),e(m,{label:"BIT3",value:"2"}),e(m,{label:"BIT4",value:"3"}),e(m,{label:"BIT5",value:"4"}),e(m,{label:"BIT6",value:"5"}),e(m,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),Ke,c(" 信号极性: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[11]||(g[11]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),i.value?(k(),w("div",Qe,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[12]||(g[12]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),We,c(" CAN-IO模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[13]||(g[13]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Xe,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[14]||(g[14]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),Ze,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[15]||(g[15]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),j.value?(k(),w("div",el,[c(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":g[16]||(g[16]=v=>n.value=v),onChange:r},null,8,["modelValue"]),ll,c(" 信号极性: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[17]||(g[17]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const nl=A=>(me("data-v-2f6a8c35"),A=A(),pe(),A),tl=nl(()=>s("br",null,null,-1)),ul={slot:"footer",class:"dialog-footer"},ol={__name:"index",setup(A){const f=S(!1),L=()=>{_.value.name="",_.value.key="",_.value.config.value=[1,1,1,1,1,1],_.value.editingIndex=-1,console.log("addNewRow",_.value.config.value),f.value=!0,fe.value=!fe.value},T=i=>{_.value.name=K.value[i].name,_.value.key=K.value[i].key,_.value.config.value=K.value[i].config,_.value.editingIndex=i,console.log("reedit",_.value.editingIndex),f.value=!0,fe.value=!fe.value},M=()=>{if(_.value.name){if(_.value.editingIndex!==-1)K.value[_.value.editingIndex].name=_.value.name,K.value[_.value.editingIndex].key=_.value.key,_.value.config!=null&&(K.value[_.value.editingIndex].config=_.value.config),N.value.IO.input=K,console.log("handleAddRowb",_.value.config),console.log("handleAddRow",K.value[_.value.editingIndex].config);else{const{editingIndex:i,...n}=_.value,o={...n};K.value.push(JSON.parse(JSON.stringify(o))),N.value.IO.input=K,console.log("handleAddRowa",o)}f.value=!1}else ne.error("请填写完整数据")},j=i=>{K.value.splice(i,1)};return(i,n)=>{const o=H,p=z,C=ie,y=te,V=Ie,r=xe,$=Ve;return k(),w(G,null,[e(C,{data:t(K),style:{width:"100%"},class:"IOinputdata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 输入点IO"},{default:l(x=>[e(o,{type:"text",onClick:d=>T(x.$index)},{default:l(()=>[c(U(t(K)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[c("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:d=>T(x.$index)},{default:l(()=>[c(U(t(K)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"config",label:"输入点"},{default:l(x=>[s("h4",null,U(x.row.config),1)]),_:1}),e(p,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:d=>j(x.$index)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e($,{title:"添加数据",modelValue:f.value,"onUpdate:modelValue":n[3]||(n[3]=x=>f.value=x),visible:f.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[tl,e(r,{ref:"form",model:t(_),"label-width":"80px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(_).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(_).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{modelValue:t(_).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(_).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"IO"},{default:l(()=>[e(al)]),_:1})]),_:1},8,["model"]),s("div",ul,[e(o,{onClick:n[2]||(n[2]=x=>f.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[c("取 消")]),_:1}),e(o,{type:"primary",onClick:M},{default:l(()=>[c("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},il=re(ol,[["__scopeId","data-v-2f6a8c35"]]),dl={key:0},sl=s("br",null,null,-1),vl=s("br",null,null,-1),rl=s("br",null,null,-1),cl={key:1},fl=s("br",null,null,-1),gl=s("br",null,null,-1),ml=s("br",null,null,-1),pl={key:2},_l=s("br",null,null,-1),bl=s("br",null,null,-1),yl={key:3},Vl=s("br",null,null,-1),hl=s("br",null,null,-1),kl=s("br",null,null,-1),Il={key:4},xl=s("br",null,null,-1),Cl={__name:"IO",setup(A){const f=S("1"),L=S(!0),T=S(!1),M=S(!1),j=S(!1),i=S(!1),n=S("1"),o=S("1"),p=S("1"),C=S("1"),y=S(""),V=S(""),r=()=>{if(f.value==="2"||f.value==="3"||f.value==="5")b.value.config=[parseInt(f.value),parseInt(n.value),parseInt(o.value),parseInt(p.value),parseInt(C.value)];else if(f.value==="1")b.value.config=[parseInt(f.value),0,parseInt(n.value),parseInt(o.value),parseInt(p.value)];else if(f.value==="4"){const B=parseInt(n.value,16);y.value=isNaN(B)?"":B.toString(),b.value.config=[parseInt(f.value),0,0,parseInt(y.value),parseInt(o.value)]}console.log("generateJSON",b.value.config)},$=[{label:"本地IO",value:"1"},{label:"CAN-POS",value:"2"},{label:"CAN-OPEN",value:"3"},{label:"GPIO",value:"4"},{label:"CAN-IO",value:"5"}],x=[{label:"CAN1",value:"0"},{label:"CAN2",value:"1"},{label:"CAN3",value:"2"}],d=()=>{if(b.value.config.value!==void 0){if(b.value.config.value[0]===2||b.value.config.value[0]===3||b.value.config.value[0]===5)f.value=b.value.config.value[0].toString(),n.value=b.value.config.value[1].toString(),o.value=b.value.config.value[2].toString(),p.value=b.value.config.value[3].toString(),C.value=b.value.config.value[4].toString(),D();else if(b.value.config.value[0]===1)f.value=b.value.config.value[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),p.value=b.value.config.value[4].toString(),D();else if(b.value.config.value[0]===4){f.value=b.value.config.value[0].toString();const B=parseInt(b.value.config.value[3],10);V.value=isNaN(B)?"":B.toString(16),n.value=V.value.toString(),o.value=b.value.config.value[4].toString(),D()}}else if(b.value.config!==void 0){if(b.value.config[0]===2||b.value.config[0]===3||b.value.config[0]===5)f.value=b.value.config[0].toString(),n.value=b.value.config[1].toString(),o.value=b.value.config[2].toString(),p.value=b.value.config[3].toString(),C.value=b.value.config[4].toString(),D();else if(b.value.config[0]===1)f.value=b.value.config[0].toString(),n.value=b.value.config.value[2].toString(),o.value=b.value.config.value[3].toString(),p.value=b.value.config.value[4].toString(),D();else if(b.value.config[0]===4){f.value=b.value.config[0].toString();const B=parseInt(b.value.config[3],10);V.value=isNaN(B)?"":B.toString(16),n.value=V.value.toString(),o.value=b.value.config.value[4].toString(),D()}}else f.value="1",n.value="1",o.value="1",p.value="1",C.value="1",D(),console.log("putJSONelse")},D=()=>{switch(console.log("handleChange",f.value),f.value){case"1":L.value=!0,T.value=!1,M.value=!1,j.value=!1,i.value=!1,r();return;case"2":L.value=!1,T.value=!0,M.value=!1,j.value=!1,i.value=!1,r();return;case"3":L.value=!1,T.value=!1,M.value=!0,j.value=!1,i.value=!1,r();return;case"4":L.value=!1,T.value=!1,M.value=!1,j.value=!0,i.value=!1,r();return;case"5":L.value=!1,T.value=!1,M.value=!1,j.value=!1,i.value=!0,r();return}};d();let ue=0;return $e(ge,()=>{const B=Date.now();B-ue>=700&&(d(),ue=B)}),(B,g)=>{const le=Ue,m=Ce,J=we,de=te;return k(),w("div",null,[(k(),w(G,null,X($,(v,F)=>e(le,{key:F,modelValue:f.value,"onUpdate:modelValue":g[0]||(g[0]=P=>f.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),T.value?(k(),w("div",dl,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),sl,c(" CAN-POS模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[2]||(g[2]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),vl,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[3]||(g[3]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),rl,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[4]||(g[4]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),M.value?(k(),w("div",cl,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[5]||(g[5]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),fl,c(" CAN-OPEN模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[6]||(g[6]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),gl,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[7]||(g[7]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),ml,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[8]||(g[8]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),L.value?(k(),w("div",pl,[c(" 本地IO地址: "),e(de,{modelValue:n.value,"onUpdate:modelValue":g[9]||(g[9]=v=>n.value=v),type:"number",onChange:r},null,8,["modelValue"]),_l,c(" 输出点对应位: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[10]||(g[10]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"BIT1",value:"0"}),e(m,{label:"BIT2",value:"1"}),e(m,{label:"BIT3",value:"2"}),e(m,{label:"BIT4",value:"3"}),e(m,{label:"BIT5",value:"4"}),e(m,{label:"BIT6",value:"5"}),e(m,{label:"BIT7",value:"6"})]),_:1},8,["modelValue"]),bl,c(" 信号极性: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[11]||(g[11]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),i.value?(k(),w("div",yl,[c(" 远程模块连接到: "),(k(),w(G,null,X(x,(v,F)=>e(le,{key:F,modelValue:n.value,"onUpdate:modelValue":g[12]||(g[12]=P=>n.value=P),label:v.value,onChange:D},{default:l(()=>[s("pre",null,U(v.label),1)]),_:2},1032,["modelValue","label"])),64)),Vl,c(" CAN-IO模块编号: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[13]||(g[13]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),hl,c(" 模块内输出点编号: "),e(J,{modelValue:p.value,"onUpdate:modelValue":g[14]||(g[14]=v=>p.value=v),onChange:r},{default:l(()=>[e(m,{label:"0",value:"0"}),e(m,{label:"1",value:"1"}),e(m,{label:"2",value:"2"})]),_:1},8,["modelValue"]),kl,c(" 信号极性: "),e(J,{modelValue:C.value,"onUpdate:modelValue":g[15]||(g[15]=v=>C.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0),j.value?(k(),w("div",Il,[c(" 输入点对应位: "),e(de,{modelValue:n.value,"onUpdate:modelValue":g[16]||(g[16]=v=>n.value=v),onChange:r},null,8,["modelValue"]),xl,c(" 信号极性: "),e(J,{modelValue:o.value,"onUpdate:modelValue":g[17]||(g[17]=v=>o.value=v),onChange:r},{default:l(()=>[e(m,{label:"输出高电平有效",value:"0"}),e(m,{label:"输出低电平有效",value:"1"})]),_:1},8,["modelValue"])])):Z("",!0)])}}};const wl=A=>(me("data-v-0806589d"),A=A(),pe(),A),Sl=wl(()=>s("br",null,null,-1)),$l={slot:"footer",class:"dialog-footer"},Ul={__name:"index",setup(A){const f=S(!1),L=()=>{b.value.name="",b.value.key="",b.value.config.value=[1,1,1,1,1,1],b.value.editingIndex=-1,console.log("addnewoutRow",b.value.config.value),f.value=!0,ge.value=!ge.value},T=i=>{b.value.name=Q.value[i].name,b.value.key=Q.value[i].key,b.value.config.value=Q.value[i].config,b.value.editingIndex=i,console.log("reedit",b.value.config.value),f.value=!0,ge.value=!ge.value},M=()=>{if(b.value.name){if(b.value.editingIndex!==-1)Q.value[b.value.editingIndex].name=b.value.name,Q.value[b.value.editingIndex].key=b.value.key,b.value.config!=null&&(Q.value[b.value.editingIndex].config=b.value.config),N.value.IO.output=Q,console.log("handleAddRow",b.value.config),console.log("handleAddRow",Q.value[b.value.editingIndex].config);else{const{editingIndex:i,...n}=b.value,p={...{...n}};Q.value.push(JSON.parse(JSON.stringify(p))),N.value.IO.output=Q,console.log("handleAddRow",p)}f.value=!1}else ne.error("请填写完整数据")},j=i=>{Q.value.splice(i,1)};return(i,n)=>{const o=H,p=z,C=ie,y=te,V=Ie,r=xe,$=Ve;return k(),w(G,null,[e(C,{data:t(Q),style:{width:"100%"},class:"IOoutputdata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 输出点IO"},{default:l(x=>[e(o,{type:"text",onClick:d=>T(x.$index)},{default:l(()=>[c(U(t(Q)[x.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[c("添加新数据")]),_:1})]),default:l(x=>[e(o,{type:"text",onClick:d=>T(x.$index)},{default:l(()=>[c(U(t(Q)[x.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"config",label:"输出点"},{default:l(x=>[s("h4",null,U(x.row.config),1)]),_:1}),e(p,{label:"操作"},{default:l(x=>[e(o,{type:"danger",onClick:d=>j(x.$index)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e($,{title:"添加数据",modelValue:f.value,"onUpdate:modelValue":n[3]||(n[3]=x=>f.value=x),visible:f.value,width:"900px","close-on-click-modal":!1,class:"edit-data-dialog",style:{height:"55%"}},{default:l(()=>[Sl,e(r,{ref:"form",model:t(b),"label-width":"80px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{modelValue:t(b).key,"onUpdate:modelValue":n[0]||(n[0]=x=>t(b).key=x),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{modelValue:t(b).name,"onUpdate:modelValue":n[1]||(n[1]=x=>t(b).name=x),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"IO"},{default:l(()=>[e(Cl)]),_:1})]),_:1},8,["model"]),s("div",$l,[e(o,{onClick:n[2]||(n[2]=x=>f.value=!1),style:{"margin-left":"75%"}},{default:l(()=>[c("取 消")]),_:1}),e(o,{type:"primary",onClick:M},{default:l(()=>[c("确定")]),_:1})])]),_:1},8,["modelValue","visible"])],64)}}},Dl=re(Ul,[["__scopeId","data-v-0806589d"]]);const De=A=>(me("data-v-7cb2a2de"),A=A(),pe(),A),Nl=De(()=>s("br",null,null,-1)),Ol={style:{"margin-top":"2%","margin-left":"75%"}},Tl=De(()=>s("br",null,null,-1)),Rl={__name:"index",setup(A){const f=S(!1),L=()=>{a.value.name="",a.value.key="",a.value.config.portID=0,a.value.config.unitID=0,a.value.config.canID=0,a.value.config.axisID=0,a.value.config.ratio=0,a.value.config.encoder=0,a.value.config.unitDist=0,a.value.config.maxRPM=0,a.value.config.normalvel=0,a.value.config.slowvel=0,a.value.config.neartarget=0,a.value.config.ontarget=0,a.value.config.motorDir=0,a.value.config.encoderDir=0,a.value.config.originmode=0,a.value.config.maxHeight=0,a.value.config.isturn=0,a.value.config.syncFineVel=0,a.value.config.syncDir=0,a.value.config.syncVelRatioUp=0,a.value.config.steadyHeight=0,a.value.config.radius=0,a.value.editingIndex=-1,f.value=!0},T=i=>{a.value.name=I.value[i].name,a.value.key=I.value[i].key,a.value.config.portID=I.value[i].config.portID,a.value.config.unitID=I.value[i].config.unitID,a.value.config.canID=I.value[i].config.canID,a.value.config.axisID=I.value[i].config.axisID,a.value.config.ratio=I.value[i].config.ratio,a.value.config.encoder=I.value[i].config.encoder,a.value.config.unitDist=I.value[i].config.unitDist,a.value.config.maxRPM=I.value[i].config.maxRPM,a.value.config.normalvel=I.value[i].config.normalvel,a.value.config.slowvel=I.value[i].config.slowvel,a.value.config.neartarget=I.value[i].config.neartarget,a.value.config.ontarget=I.value[i].config.ontarget,a.value.config.motorDir=I.value[i].config.motorDir,a.value.config.encoderDir=I.value[i].config.encoderDir,a.value.config.originmode=I.value[i].config.originmode,a.value.config.maxHeight=I.value[i].config.maxHeight,a.value.config.isturn=I.value[i].config.isturn,a.value.config.syncFineVel=I.value[i].config.syncFineVel,a.value.config.syncDir=I.value[i].config.syncDir,a.value.config.syncVelRatioUp=I.value[i].config.syncVelRatioUp,a.value.config.steadyHeight=I.value[i].config.steadyHeight,a.value.config.radius=I.value[i].config.radius,a.value.editingIndex=i,f.value=!0},M=()=>{if(a.value.name){if(a.value.editingIndex!==-1)I.value[a.value.editingIndex].name=a.value.name,I.value[a.value.editingIndex].key=a.value.key,I.value[a.value.editingIndex].config.portID=a.value.config.portID,I.value[a.value.editingIndex].config.unitID=a.value.config.unitID,I.value[a.value.editingIndex].config.canID=a.value.config.canID,I.value[a.value.editingIndex].config.axisID=a.value.config.axisID,I.value[a.value.editingIndex].config.ratio=a.value.config.ratio,I.value[a.value.editingIndex].config.encoder=a.value.config.encoder,I.value[a.value.editingIndex].config.unitDist=a.value.config.unitDist,I.value[a.value.editingIndex].config.maxRPM=a.value.config.maxRPM,I.value[a.value.editingIndex].config.normalvel=a.value.config.normalvel,I.value[a.value.editingIndex].config.slowvel=a.value.config.slowvel,I.value[a.value.editingIndex].config.neartarget=a.value.config.neartarget,I.value[a.value.editingIndex].config.ontarget=a.value.config.ontarget,I.value[a.value.editingIndex].config.motorDir=a.value.config.motorDir,I.value[a.value.editingIndex].config.encoderDir=a.value.config.encoderDir,I.value[a.value.editingIndex].config.originmode=a.value.config.originmode,I.value[a.value.editingIndex].config.maxHeight=a.value.config.maxHeight,I.value[a.value.editingIndex].config.isturn=a.value.config.isturn,I.value[a.value.editingIndex].config.syncFineVel=a.value.config.syncFineVel,I.value[a.value.editingIndex].config.syncDir=a.value.config.syncDir,I.value[a.value.editingIndex].config.syncVelRatioUp=a.value.config.syncVelRatioUp,I.value[a.value.editingIndex].config.steadyHeight=a.value.config.steadyHeight,I.value[a.value.editingIndex].config.radius=a.value.config.radius,N.value.servo.kinco=I;else{const{editingIndex:i,...n}=a.value,p={...{...n}};I.value.push(JSON.parse(JSON.stringify(p))),N.value.servo.kinco=I,console.log("handleAddRow",p)}f.value=!1}else ne.error("请填写完整数据")},j=i=>{I.value.splice(i,1)};return(i,n)=>{const o=H,p=z,C=ie,y=te,V=Ie,r=Be,$=xe,x=Ve;return k(),w(G,null,[e(C,{data:t(I),style:{width:"100%"},class:"servodata"},{default:l(()=>[e(p,{prop:"key",label:"⚠️ 上装伺服"},{default:l(d=>[e(o,{type:"text",onClick:D=>T(d.$index)},{default:l(()=>[c(U(t(I)[d.$index].key),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{prop:"name"},{header:l(()=>[e(o,{type:"primary",onClick:L},{default:l(()=>[c("添加新数据")]),_:1})]),default:l(d=>[e(o,{type:"text",onClick:D=>T(d.$index)},{default:l(()=>[c(U(t(I)[d.$index].name),1)]),_:2},1032,["onClick"])]),_:1}),e(p,{label:"CAN口号"},{default:l(d=>[c(U(d.row.config.portID),1)]),_:1}),e(p,{label:"单元号"},{default:l(d=>[c(U(d.row.config.unitID),1)]),_:1}),e(p,{label:"模块内对应编号"},{default:l(d=>[c(U(d.row.config.canID),1)]),_:1}),e(p,{label:"原点模式"},{default:l(d=>[s("h4",null,U(d.row.config.originmode===1?"是":"否"),1)]),_:1}),e(p,{label:"是否有转盘"},{default:l(d=>[s("h4",null,U(d.row.config.isturn===1?"是":"否"),1)]),_:1}),e(p,{label:"操作"},{default:l(d=>[e(o,{type:"danger",onClick:D=>j(d.$index)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(x,{title:"添加数据",modelValue:f.value,"onUpdate:modelValue":n[25]||(n[25]=d=>f.value=d),visible:f.value,width:"900px","close-on-click-modal":!1,"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[Nl,e($,{ref:"form",model:t(a),"label-width":"180px"},{default:l(()=>[e(V,{label:"名称"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).key,"onUpdate:modelValue":n[0]||(n[0]=d=>t(a).key=d),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(V,{label:"key"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).name,"onUpdate:modelValue":n[1]||(n[1]=d=>t(a).name=d),placeholder:"英文KEY"},null,8,["modelValue"])]),_:1}),e(V,{label:"CAN-ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.portID,"onUpdate:modelValue":n[2]||(n[2]=d=>t(a).config.portID=d),modelModifiers:{number:!0},placeholder:"can口号"},null,8,["modelValue"])]),_:1}),e(V,{label:"CAN单元号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitID,"onUpdate:modelValue":n[3]||(n[3]=d=>t(a).config.unitID=d),modelModifiers:{number:!0},placeholder:"单元号"},null,8,["modelValue"])]),_:1}),e(V,{label:"模块内对应点编号"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.canID,"onUpdate:modelValue":n[4]||(n[4]=d=>t(a).config.canID=d),modelModifiers:{number:!0},placeholder:"模块内对应点编号"},null,8,["modelValue"])]),_:1}),e(V,{label:"轴ID"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.axisID,"onUpdate:modelValue":n[5]||(n[5]=d=>t(a).config.axisID=d),modelModifiers:{number:!0},placeholder:"轴ID"},null,8,["modelValue"])]),_:1}),e(V,{label:"减速比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ratio,"onUpdate:modelValue":n[6]||(n[6]=d=>t(a).config.ratio=d),modelModifiers:{number:!0},placeholder:"减速比"},null,8,["modelValue"])]),_:1}),e(V,{label:"编码器绝对值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoder,"onUpdate:modelValue":n[7]||(n[7]=d=>t(a).config.encoder=d),modelModifiers:{number:!0},placeholder:"编码器绝对值"},null,8,["modelValue"])]),_:1}),e(V,{label:"伺服行程转换比"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.unitDist,"onUpdate:modelValue":n[8]||(n[8]=d=>t(a).config.unitDist=d),modelModifiers:{number:!0},placeholder:"伺服行程转换比"},null,8,["modelValue"])]),_:1}),e(V,{label:"最大转速"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxRPM,"onUpdate:modelValue":n[9]||(n[9]=d=>t(a).config.maxRPM=d),modelModifiers:{number:!0},placeholder:"最大转速"},null,8,["modelValue"])]),_:1}),e(V,{label:"正常速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.normalvel,"onUpdate:modelValue":n[10]||(n[10]=d=>t(a).config.normalvel=d),modelModifiers:{number:!0},placeholder:"正常速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"减速速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.slowvel,"onUpdate:modelValue":n[11]||(n[11]=d=>t(a).config.slowvel=d),modelModifiers:{number:!0},placeholder:"减速速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"切换速度的临界距离"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.neartarget,"onUpdate:modelValue":n[12]||(n[12]=d=>t(a).config.neartarget=d),modelModifiers:{number:!0},placeholder:"切换速度的临界距离"},null,8,["modelValue"])]),_:1}),e(V,{label:"允许误差"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.ontarget,"onUpdate:modelValue":n[13]||(n[13]=d=>t(a).config.ontarget=d),modelModifiers:{number:!0},placeholder:"允许误差"},null,8,["modelValue"])]),_:1}),e(V,{label:"电机方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.motorDir,"onUpdate:modelValue":n[14]||(n[14]=d=>t(a).config.motorDir=d),modelModifiers:{number:!0},placeholder:"电机方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"码盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.encoderDir,"onUpdate:modelValue":n[15]||(n[15]=d=>t(a).config.encoderDir=d),modelModifiers:{number:!0},placeholder:"码盘方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"原点模式"},{default:l(()=>[e(r,{style:{width:"80%"},modelValue:t(a).config.originmode,"onUpdate:modelValue":n[16]||(n[16]=d=>t(a).config.originmode=d),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(V,{label:"最大行程"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.maxHeight,"onUpdate:modelValue":n[17]||(n[17]=d=>t(a).config.maxHeight=d),modelModifiers:{number:!0},placeholder:"最大行程"},null,8,["modelValue"])]),_:1}),e(V,{label:"凸轮半径"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.radius,"onUpdate:modelValue":n[18]||(n[18]=d=>t(a).config.radius=d),modelModifiers:{number:!0},placeholder:"凸轮半径"},null,8,["modelValue"])]),_:1}),e(V,{label:"是否是转盘"},{default:l(()=>[e(r,{style:{width:"80%"},modelValue:t(a).config.isturn,"onUpdate:modelValue":n[19]||(n[19]=d=>t(a).config.isturn=d),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(V,{label:"转盘速度"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncFineVel,"onUpdate:modelValue":n[20]||(n[20]=d=>t(a).config.syncFineVel=d),modelModifiers:{number:!0},placeholder:"转盘速度"},null,8,["modelValue"])]),_:1}),e(V,{label:"转盘方向"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncDir,"onUpdate:modelValue":n[21]||(n[21]=d=>t(a).config.syncDir=d),modelModifiers:{number:!0},placeholder:"转盘方向"},null,8,["modelValue"])]),_:1}),e(V,{label:"syncVelRatioUp"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.syncVelRatioUp,"onUpdate:modelValue":n[22]||(n[22]=d=>t(a).config.syncVelRatioUp=d),modelModifiers:{number:!0},placeholder:"syncVelRatioUp"},null,8,["modelValue"])]),_:1}),e(V,{label:"复位初始值"},{default:l(()=>[e(y,{style:{width:"80%"},modelValue:t(a).config.steadyHeight,"onUpdate:modelValue":n[23]||(n[23]=d=>t(a).config.steadyHeight=d),modelModifiers:{number:!0},placeholder:"复位初始值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",Ol,[e(o,{onClick:n[24]||(n[24]=d=>f.value=!1)},{default:l(()=>[c("取 消")]),_:1}),e(o,{type:"primary",onClick:M},{default:l(()=>[c("确定")]),_:1})]),Tl]),_:1})]),_:1},8,["modelValue","visible"])],64)}}},El=re(Rl,[["__scopeId","data-v-7cb2a2de"]]);const ae=A=>(me("data-v-d509a030"),A=A(),pe(),A),Al={key:0,class:"error-details"},Ml={class:"error-item"},Bl=ae(()=>s("strong",null,"异常名称:",-1)),Jl={key:0},Ll={key:1},jl={class:"error-item"},Pl=ae(()=>s("strong",null,"异常结果:",-1)),Hl={key:0},Fl={key:1},ql={class:"error-item"},zl=ae(()=>s("strong",null,"需要执行的接口名称:",-1)),Gl={key:0},Yl={key:1},Kl={class:"error-item"},Ql=ae(()=>s("strong",null,"类型:",-1)),Wl={key:0},Xl={key:1},Zl={class:"error-item"},ea=ae(()=>s("strong",null,"值:",-1)),la={key:0},aa={key:1},na={class:"error-item"},ta=ae(()=>s("strong",null,"输入的字符串参数:",-1)),ua={key:0},oa={key:1},ia={class:"error-item"},da=ae(()=>s("strong",null,"错误码:",-1)),sa={key:0},va={key:1},ra={class:"error-item"},ca=ae(()=>s("strong",null,"错误信息:",-1)),fa={key:0},ga={key:1},ma={style:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},pa=ae(()=>s("span",null,"任务步骤",-1)),_a={key:0},ba={style:{"font-size":"16px","font-style":"oblique","margin-right":"10px"}},ya={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},Va=ae(()=>s("br",null,null,-1)),ha={style:{width:"95%",display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5%"}},ka=ae(()=>s("br",null,null,-1)),Ia={__name:"task",setup(A){const f=S([{label:"重复执行",value:0},{label:"正常",value:1},{label:"异常",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}]);Oe(()=>{let u="";be.value=Ae.value.split(`
`).reduce((h,Y)=>{if(Y.trim().startsWith("function")){const ee=Y.split("(")[0].split(" ")[1];u||(u=ee),h.push({name:u,key:ee}),u=Y}else u=Y;return h},[])});const L=u=>{const h=be.value.find(Y=>Y.key===u);return h?h.name:u},T=S("");function M(){N.value.Task.push({note:"",id:0,taskList:[]})}const j=()=>{N.value.Task.forEach(u=>{const h=u.id;clearInterval(i.green[h]),delete i.green[h],n.value.green[h]=!1,clearInterval(i.red[h]),delete i.red[h],n.value.red[h]=!1,o.value[h]=null})};S(0);let i={green:{},red:{}};const n=S({green:{},red:{}}),o=S({}),p=he(()=>N.value.Task.find(u=>u.id===O.value.curTaskID)),C=()=>{if(p.value){const u=p.value;for(const h in o.value)Number(h)!==u.id&&(clearInterval(i.green[Number(h)]),delete i.green[Number(h)],n.value.green[Number(h)]=!1,clearInterval(i.red[Number(h)]),delete i.red[Number(h)],n.value.red[Number(h)]=!1,delete o.value[Number(h)]);if(o.value[u.id]==="green")return;clearInterval(i.red[u.id]),delete i.red[u.id],n.value.red[u.id]=!1,n.value.green[u.id]=!0,o.value[u.id]="green",i.green[u.id]||(i.green[u.id]=setInterval(()=>{n.value.green[u.id]=!n.value.green[u.id]},500))}},y=()=>{if(p.value){const u=p.value;for(const h in o.value)Number(h)!==u.id&&(clearInterval(i.green[Number(h)]),delete i.green[Number(h)],n.value.green[Number(h)]=!1,clearInterval(i.red[Number(h)]),delete i.red[Number(h)],n.value.red[Number(h)]=!1,delete o.value[Number(h)]);if(o.value[u.id]==="red")return;clearInterval(i.green[u.id]),delete i.green[u.id],n.value.green[u.id]=!1,n.value.red[u.id]=!0,o.value[u.id]="red",i.red[u.id]||(i.red[u.id]=setInterval(()=>{n.value.red[u.id]=!n.value.red[u.id]},500))}},V=()=>{if(p.value){const u=p.value;clearInterval(i.green[u.id]),delete i.green[u.id],n.value.green[u.id]=!1,clearInterval(i.red[u.id]),delete i.red[u.id],n.value.red[u.id]=!1,o.value[u.id]=null}};S("");let r={green:{},red:{}};const $=S({green:{},red:{}}),x=S({}),d=he(()=>N.value.Task.flatMap(u=>u.taskList).find(u=>u.main===O.value.subTaskStatus.main_name)),D=()=>{if(d.value){const u=d.value;for(const h in x.value)h!==u.main&&(console.log("main",h),console.log("itemmain",u.main),clearInterval(r.green[h]),delete r.green[h],$.value.green[h]=!1,clearInterval(r.red[h]),delete r.red[h],$.value.red[h]=!1,delete x.value[h]);if(x.value[u.main]==="green")return;clearInterval(r.red[u.main]),delete r.red[u.main],$.value.red[u.main]=!1,$.value.green[u.main]=!0,x.value[u.main]="green",r.green[u.main]||(r.green[u.main]=setInterval(()=>{$.value.green[u.main]=!$.value.green[u.main]},500))}},ue=()=>{if(d.value){const u=d.value;for(const h in x.value)h!==u.main&&(console.log("main",h),console.log("itemmain",u.main),clearInterval(r.green[h]),delete r.green[h],$.value.green[h]=!1,clearInterval(r.red[h]),delete r.red[h],$.value.red[h]=!1,delete x.value[h]);if(x.value[u.main]==="red")return;clearInterval(r.green[u.main]),delete r.green[u.main],$.value.green[u.main]=!1,$.value.red[u.main]=!0,x.value[u.main]="red",r.red[u.main]||(r.red[u.main]=setInterval(()=>{$.value.red[u.main]=!$.value.red[u.main]},500))}},B=()=>{if(d.value){const u=d.value;clearInterval(r.green[u.main]),delete r.green[u.main],$.value.green[u.main]=!1,clearInterval(r.red[u.main]),delete r.red[u.main],$.value.red[u.main]=!1,x.value[u.main]=null}};function g(u){const h=N.value.Task.indexOf(u);h>-1&&N.value.Task.splice(h,1)}function le(u){u.taskList.push({main:"",exceptions:[""],jump:[{}]})}function m(u,h){const Y=u.taskList.indexOf(h);Y>-1&&u.taskList.splice(Y,1)}function J(u){u.exceptions||(u.exceptions=[]),u.exceptions.push(T.value),T.value=""}function de(u,h){u.exceptions.splice(h,1)}function v(u){u.jump||(u.jump=[]),u.jump.push({})}function F(u,h){u.jump.splice(h,1)}const P=S(new Set);function ce(u){return P.value.has(u)}function Ne(u){P.value.has(u)?P.value.delete(u):P.value.add(u)}const O=S(null),Se=()=>{ye({method:"post",url:"/api/data/analysis",data:JSON.stringify({group:"siasun",account:"test",password:"123456"})}).then(h=>{O.value=h.data;const Y=O.value.curTaskID,ee=O.value.taskStatus;ee===0?V():ee===1?C():(ee===2||ee===3)&&y(),Y===0&&j();const R=O.value.subTaskStatus.main_result;O.value.subTaskStatus.exception_result===1?ue():R===0?D():B()}).catch(h=>{}).finally(()=>{}),Re.value=setTimeout(Se,500)};return Te(()=>{Se()}),(u,h)=>{const Y=Ce,ee=we;return k(),w("div",null,[e(t(ie),{data:t(N).Task,style:{width:"100%"},class:"jsondatatask"},{default:l(()=>[e(t(z),{label:"⚠️ 任务列表",width:"200"},{default:l(({row:R})=>[s("div",{class:oe(ce(R)?"zhedie":"zhankai")},[s("div",{class:oe([{"highlight-green":n.value.green[R.id],"highlight-red":n.value.red[R.id]},"data-item"])},[e(t(H),{onClick:E=>Ne(R),type:"info"},{default:l(()=>[c(U(ce(R)?"折叠":"展开"),1)]),_:2},1032,["onClick"]),e(t(H),{type:"danger",onClick:E=>g(R)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"]),e(t(te),{style:{"margin-top":"3%"},modelValue:R.note,"onUpdate:modelValue":E=>R.note=E,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"]),ce(R)&&O.value&&O.value.curTaskID===R.id?(k(),w("div",Al,[s("div",Ml,[Bl,O.value.subTaskStatus.exception_name!==void 0?(k(),w("span",Jl,U(L(O.value.subTaskStatus.exception_name)),1)):(k(),w("span",Ll,"null"))]),s("div",jl,[Pl,O.value.subTaskStatus.exception_result!==void 0?(k(),w("span",Hl,U(O.value.subTaskStatus.exception_result===0?"无异常":"有异常"),1)):(k(),w("span",Fl,"null"))]),s("div",ql,[zl,O.value.subTaskStatus.sentence.name!==void 0?(k(),w("span",Gl,U(O.value.subTaskStatus.sentence.name),1)):(k(),w("span",Yl,"null"))]),s("div",Kl,[Ql,O.value.subTaskStatus.sentence.data.type!==void 0?(k(),w("span",Wl,U(O.value.subTaskStatus.sentence.data.type===0?"布尔值":O.value.subTaskStatus.sentence.data.type===1?"整数":O.value.subTaskStatus.sentence.data.type===2?"双精度":"未知类型"),1)):(k(),w("span",Xl,"null"))]),s("div",Zl,[ea,O.value.subTaskStatus.sentence.data.value!==void 0?(k(),w("span",la,U(O.value.subTaskStatus.sentence.data.value),1)):(k(),w("span",aa,"null"))]),s("div",na,[ta,O.value.subTaskStatus.sentence.param.value!==void 0?(k(),w("span",ua,U(O.value.subTaskStatus.sentence.param.value),1)):(k(),w("span",oa,"null"))]),s("div",ia,[da,O.value.curTaskError.errorCode!==void 0?(k(),w("span",sa,U(O.value.curTaskError.errorCode===0?"无故障":O.value.curTaskError.errorCode===1?"超时故障":O.value.curTaskError.errorCode===2?"异常故障":O.value.curTaskError.errorCode===3?"内部故障":"未知错误"),1)):(k(),w("span",va,"null"))]),s("div",ra,[ca,O.value.curTaskError.errorMessage!==void 0?(k(),w("span",fa,U(O.value.curTaskError.errorMessage),1)):(k(),w("span",ga,"null"))])])):Z("",!0)],2)],2)]),_:1}),e(t(z),{label:"任务 ID",width:"100"},{default:l(({row:R})=>[s("div",{class:oe(ce(R)?"zhedie":"zhankai")},[s("div",{class:oe([{"highlight-green":n.value.green[R.id],"highlight-red":n.value.red[R.id]},"data-item"])},[e(t(te),{modelValue:R.id,"onUpdate:modelValue":E=>R.id=E,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])],2)],2)]),_:1}),e(t(z),{label:"任务步骤"},{header:l(()=>[s("div",ma,[pa,e(t(H),{type:"primary",onClick:M},{default:l(()=>[c("添加任务")]),_:1})])]),default:l(({row:R})=>[s("div",{class:oe([{"highlight-green":n.value.green[R.id],"highlight-red":n.value.red[R.id]},"data-item"])},[ce(R)?(k(),w("div",_a,[s("div",null,[e(t(H),{type:"primary",onClick:E=>le(R)},{default:l(()=>[c("添加动作")]),_:2},1032,["onClick"])]),e(t(ie),{data:R.taskList,style:{width:"100%"}},{default:l(()=>[e(t(z),{label:"动作"},{default:l(({row:E})=>[s("div",{class:oe([{"highlight-green":$.value.green[E.main],"highlight-red":$.value.red[E.main]},"data-item"])},[s("span",ba,"第"+U(R.taskList.indexOf(E)+1)+"步",1),e(t(H),{type:"danger",onClick:W=>m(R,E)},{default:l(()=>[c("删除动作")]),_:2},1032,["onClick"]),e(ee,{modelValue:E.main,"onUpdate:modelValue":W=>E.main=W,placeholder:"选择动作"},{default:l(()=>[(k(!0),w(G,null,X(t(be),W=>(k(),ve(Y,{key:W,label:W.name.replace(/^\/\/\s*/,""),value:W.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2)]),_:2},1024),e(t(z),{label:"动作异常"},{default:l(({row:E})=>[s("div",{class:oe([{"highlight-green":$.value.green[E.main],"highlight-red":$.value.red[E.main]},"data-item"])},[s("ul",null,[(k(!0),w(G,null,X(E.exceptions,(W,se)=>(k(),w("li",{key:`exception-${se}`},[s("div",ya,[e(ee,{modelValue:E.exceptions[se],"onUpdate:modelValue":q=>E.exceptions[se]=q,placeholder:"动作中检测异常"},{default:l(()=>[(k(!0),w(G,null,X(t(be),q=>(k(),ve(Y,{key:q,label:q.name.replace(/^\/\/\s*/,""),value:q.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),c("   "),e(t(H),{type:"danger",onClick:q=>de(E,se)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])])]))),128)),Va,e(t(H),{type:"primary",onClick:W=>J(E)},{default:l(()=>[c("添加异常")]),_:2},1032,["onClick"])])],2)]),_:1}),e(t(z),{label:"执行结果和跳转"},{default:l(({row:E})=>[s("div",{class:oe([{"highlight-green":$.value.green[E.main],"highlight-red":$.value.red[E.main]},"data-item"])},[(k(!0),w(G,null,X(E.jump,(W,se)=>(k(),w("div",{key:`jump-${se}`},[s("div",ha,[e(ee,{modelValue:W.condition,"onUpdate:modelValue":q=>W.condition=q,placeholder:"执行结果"},{default:l(()=>[(k(!0),w(G,null,X(f.value,q=>(k(),ve(Y,{label:q.label,value:q.value},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(ee,{modelValue:W.index,"onUpdate:modelValue":q=>W.index=q,placeholder:"跳转索引"},{default:l(()=>[(k(!0),w(G,null,X(R.taskList,q=>(k(),ve(Y,{label:"第 "+(R.taskList.indexOf(q)+1)+" 步",value:R.taskList.indexOf(q)+1},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]),c("   "),e(t(H),{type:"danger",onClick:q=>F(E,se)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])])]))),128)),ka,e(t(H),{type:"primary",onClick:W=>v(E)},{default:l(()=>[c("添加跳转")]),_:2},1032,["onClick"])],2)]),_:2},1024)]),_:2},1032,["data"])])):Z("",!0)],2)]),_:1})]),_:1},8,["data"])])}}},xa=re(Ia,[["__scopeId","data-v-d509a030"]]);const Ca={__name:"index",setup(A){const f=S(new Set),L=()=>{Ee.prompt("请输入设备名","添加设备",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[^\u4e00-\u9fa5]+$/,inputErrorMessage:"不能包含中文"}).then(({value:o})=>{N.value.device||(N.value.device={}),N.value.device[o]=[]}).catch(()=>{ne({message:"已取消添加设备",type:"info"})})},T=o=>{f.value.has(o)?f.value.delete(o):f.value.add(o)},M=o=>f.value.has(o),j=o=>{delete N.value.device[o]},i=o=>{o.push({key:"",value:""})},n=(o,p)=>{const C=o.indexOf(p);C!==-1&&o.splice(C,1)};return(o,p)=>(k(),ve(t(ie),{data:Object.entries(t(N).device),style:{width:"100%"}},{default:l(()=>[e(t(z),{label:"⚠️ 设备",width:"200"},{default:l(C=>[e(t(H),{onClick:y=>T(C.row[0]),type:"info"},{default:l(()=>[c(U(M(C.row[0])?"展开":"折叠"),1)]),_:2},1032,["onClick"]),e(t(H),{onClick:y=>j(C.row[0]),type:"danger",style:{"margin-left":"10px"}},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1}),e(t(z),{label:"设备名",width:"200"},{default:l(C=>[s("span",null,U(C.row[0]),1)]),_:1}),e(t(z),{label:"对象",width:"500"},{default:l(C=>[M(C.row[0])?Z("",!0):(k(),ve(t(ie),{key:0,data:C.row[1],style:{width:"100%"}},{default:l(()=>[e(t(z),{prop:"key",label:"名称",width:"200"},{default:l(y=>[e(t(te),{modelValue:y.row.key,"onUpdate:modelValue":V=>y.row.key=V,placeholder:"输入名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(z),{prop:"value",label:"值",width:"200"},{default:l(y=>[e(t(te),{modelValue:y.row.value,"onUpdate:modelValue":V=>y.row.value=V,placeholder:"输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(t(z),{label:"",width:"100"},{header:l(()=>[M(C.row[0])?Z("",!0):(k(),ve(t(H),{key:0,onClick:y=>i(C.row[1]),type:"text",style:{"margin-top":"10px"}},{default:l(()=>[c("添加数据")]),_:2},1032,["onClick"]))]),default:l(y=>[e(t(H),{onClick:V=>n(C.row[1],y.row),type:"danger"},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"]))]),_:1}),e(t(z),{width:"200"},{header:l(()=>[e(t(H),{onClick:L,type:"primary",style:{"margin-top":"20px"}},{default:l(()=>[c("添加设备")]),_:1})]),_:1})]),_:1},8,["data"]))}},wa=re(Ca,[["__scopeId","data-v-a82b39d4"]]);const _e=A=>(me("data-v-0c4c326a"),A=A(),pe(),A),Sa={class:"page-container main-view"},$a={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},Ua={class:"left"},Da=_e(()=>s("hr",{class:"hengxian"},null,-1)),Na=_e(()=>s("hr",{class:"hengxian3"},null,-1)),Oa=_e(()=>s("hr",{class:"hengxian3"},null,-1)),Ta=_e(()=>s("hr",{class:"hengxian3"},null,-1)),Ra=_e(()=>s("hr",{class:"hengxian3"},null,-1)),Ea={__name:"index",setup(A){const f=S(!1),L=he(()=>JSON.stringify(N.value,null,2)),T=()=>{f.value=!0},M=()=>{let C={data:{file:"equipment.json",value:N.value},group:"siasun",account:"test",password:"123456"};console.log(C),ye({method:"post",url:"/api/ctrl/jsoneditor",data:JSON.stringify(C)}).then(y=>{ne.success("请求成功");var V={type:"syncParm",data:!0};console.log(JSON.stringify(V)),ye({method:"post",url:"/api/ctrl/manualdata",data:JSON.stringify(V)}).then(r=>{ne.success("同步参数")}).catch(r=>{}).finally(()=>{})}).catch(y=>{ne.error("请求失败")}).finally(()=>{})},j=S(null),i=()=>{ye({method:"post",url:"/api/data/jsoneditor",data:JSON.stringify({data:"equipment.json",group:"siasun",account:"test",password:"123456"})}).then(y=>{ne.success("请求成功"),j.value=y.data,N.value=y.data,p()}).catch(y=>{ne.error("请求失败")}).finally(()=>{})},n=()=>{const C=JSON.stringify(N.value),y=new Blob([C],{type:"application/json"}),V=window.URL.createObjectURL(y),r=document.createElement("a");r.href=V,r.download="equipment.json",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(V),document.body.removeChild(r)},o=C=>{const y=C.target.files[0],V=new FileReader;V.onload=r=>{const $=JSON.parse(r.target.result);N.value=$,p()},V.readAsText(y),ne.success("导入成功")},p=()=>{N.value.IO!==void 0&&(N.value.IO.input!==void 0&&(K.value=N.value.IO.input),N.value.IO.output!==void 0&&(Q.value=N.value.IO.output)),N.value.servo.kinco!==void 0&&N.value.servo!==void 0&&(I.value=N.value.servo.kinco)};return(C,y)=>{const V=H,r=Ve,$=z,x=te,d=ie;return k(),w("div",null,[s("div",Sa,[s("div",$a,[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[s("div",Ua,[e(V,{type:"info",onClick:T},{default:l(()=>[c(" 查看 ")]),_:1}),e(r,{modelValue:f.value,"onUpdate:modelValue":y[0]||(y[0]=D=>f.value=D),title:"数据",visible:f.value,onClose:y[1]||(y[1]=D=>f.value=!1),"modal-class":"kk-dialog-class","custom-class":"custom-dialog"},{default:l(()=>[e(ke,{height:"100%",showUpBt:!0},{default:l(()=>[s("pre",null,U(L.value),1)]),_:1})]),_:1},8,["modelValue","visible"]),c("   "),e(V,{type:"primary",onClick:i},{default:l(()=>[c(" 从AGV同步参数 ")]),_:1}),e(V,{type:"primary",onClick:M},{default:l(()=>[c("同步到AGV")]),_:1}),c("   "),s("input",{ref:"importInput",type:"file",accept:".json",style:{display:"none"},onChange:o},null,544),e(V,{onClick:y[2]||(y[2]=D=>C.$refs.importInput.click()),type:"success"},{default:l(()=>[c(" 本地导入 ")]),_:1}),e(V,{type:"success",onClick:n},{default:l(()=>[c("导出到本地")]),_:1})]),Da,e(d,{data:t(Me),style:{width:"100%"},class:"EQUversion"},{default:l(()=>[e($,{prop:"name",label:"⚠️ 版本"}),e($,{prop:"value"},{default:l(D=>[e(x,{modelValue:t(N).version,"onUpdate:modelValue":y[3]||(y[3]=ue=>t(N).version=ue),placeholder:"请选择",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"]),Na,e(il),e(Dl),Oa,e(El),Ta,e(xa),Ra,e(wa)]),_:1})])])])}}},un=re(Ea,[["__scopeId","data-v-0c4c326a"]]);export{un as default};

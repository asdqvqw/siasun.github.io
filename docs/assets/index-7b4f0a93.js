import{aV as h,o as f,c as _,m as u,a as e,b as d,f as m,ck as b,cj as r,l as v,bJ as C,F as V,aY as D,g as I,bc as N}from"./index-02639357.js";import{E as T}from"./el-dialog-4d9a1aad.js";const B=e("h2",null,"✅更新网页:",-1),U=e("br",null,null,-1),$={__name:"web",setup(k){const p=h(null),n=()=>{},s=async()=>{const a=p.value.files[0];a&&b({method:"post",url:"/api/upload",data:a,headers:{"Content-Type":a.type,"X-File-Name":a.name}}).then(i=>{r.success("更新成功"),r.success("刷新网页后生效"),console.log("File uploaded successfully:",i.data)}).catch(i=>{r.error("Error uploading file:",i),console.error("Error uploading file:",i)}).finally(()=>{})};return(a,i)=>{const g=v;return f(),_("div",null,[B,U,u(" ❗注意压缩包中携带web_root文件夹: "),e("input",{style:{"margin-left":"30px"},type:"file",ref_key:"fileInput",ref:p,accept:".tar.gz",onChange:n},null,544),d(g,{type:"primary",onClick:s,style:{"margin-top":"30px",width:"80%","margin-left":"8%"}},{default:m(()=>[u("更新")]),_:1})])}}},A={class:"page-container main-view"},G={class:"table-box content-container page-content-box",style:{"background-image":"linear-gradient(to bottom right, #d0dcdc95, #d5eedf17)"}},M=e("br",null,null,-1),X=e("h2",null,"✅上传文件到AGV:",-1),j=e("br",null,null,-1),z=e("p",null,[e("h4",null,"将文件拖放到此处上传或点击选择文件"),e("br"),u(" ❗注意无法上传文件夹和文件名带中文的文件。"),e("br")],-1),J={key:0},L=e("br",null,null,-1),S=e("br",null,null,-1),Y=e("br",null,null,-1),q=e("br",null,null,-1),H={slot:"footer",class:"dialog-footer"},K=e("br",null,null,-1),O=e("br",null,null,-1),P=e("br",null,null,-1),W={__name:"index",setup(k){const p=h(null),n=h([]),s=h(!1),a=()=>{s.value=!0},i=t=>{t.preventDefault();const l=t.dataTransfer.items;if(l){for(const o of l)if(o.kind==="file")if(o.webkitGetAsEntry().isDirectory)console.error("Error: 无法上传文件夹。"),r.error("无法上传文件夹。");else{const c=o.getAsFile();if(/[\u4e00-\u9fa5]/.test(c.name)){console.error("Error: 无法上传包含中文字符的文件。"),r.error("无法上传包含中文字符的文件。");continue}n.value.push(c)}}},g=()=>{p.value.click()},x=t=>{const l=t.target.files;if(l.length>0)for(const o of l){if(/[\u4e00-\u9fa5]/.test(o.name)){console.error("Error: 无法上传包含中文字符的文件。"),r.error("无法上传包含中文字符的文件。");continue}n.value.push(o)}},F=async()=>{for(const t of n.value)await E(t);n.value=[],s.value=!1},E=async t=>{if(t)try{const l=await b({method:"post",url:"/api/upload",data:t,headers:{"Content-Type":t.type,"X-File-Name":t.name}});r.success("上传成功"),console.log("File uploaded successfully:",l.data)}catch(l){r.error("Error uploading file:",l),console.error("Error uploading file:",l)}};return(t,l)=>{const o=v,y=T;return f(),_("div",A,[e("div",G,[M,X,j,e("div",{onDragover:l[0]||(l[0]=C(()=>{},["prevent"])),onDrop:i,onClick:g,style:{border:"4px dashed #ccc",padding:"20px","text-align":"center",cursor:"pointer",width:"70%","margin-left":"10%"}},[e("input",{type:"file",ref_key:"fileInput",ref:p,style:{display:"none"},onChange:x,multiple:""},null,544),z,n.value.length>0?(f(),_("ul",J,[(f(!0),_(V,null,D(n.value,(c,w)=>(f(),_("li",{key:w},N(c.name),1))),128))])):I("",!0)],32),L,d(o,{type:"primary",onClick:a,style:{"margin-top":"10px",width:"80%","margin-left":"8%"}},{default:m(()=>[u("上传文件")]),_:1}),d(y,{title:"⛔",modelValue:s.value,"onUpdate:modelValue":l[2]||(l[2]=c=>s.value=c),visible:s.value,"close-on-click-modal":!1,style:{"text-align":"center",width:"20%"}},{default:m(()=>[S,u(" 是否提交？ "),Y,q,e("div",H,[d(o,{onClick:l[1]||(l[1]=c=>s.value=!1)},{default:m(()=>[u("取 消")]),_:1}),d(o,{onClick:F},{default:m(()=>[u("确定")]),_:1})])]),_:1},8,["modelValue","visible"]),K,O,P,e("div",null,[d($)])])])}}};export{W as default};
